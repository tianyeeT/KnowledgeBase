<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-general/ad-filtering/create-own-filters">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Как составлять свои фильтры | AdGuard Knowledge Base</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://adguardteam.github.io/KnowledgeBase/ru/general/ad-filtering/create-own-filters/"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Как составлять свои фильтры | AdGuard Knowledge Base"><meta data-rh="true" name="description" content="В этой статье мы рассказываем, как писать пользовательские правила фильтрации для использования в продуктах AdGuard. Чтобы проверить правила, скачайте приложение AdGuard"><meta data-rh="true" property="og:description" content="В этой статье мы рассказываем, как писать пользовательские правила фильтрации для использования в продуктах AdGuard. Чтобы проверить правила, скачайте приложение AdGuard"><link data-rh="true" rel="icon" href="/KnowledgeBase/ru/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://adguardteam.github.io/KnowledgeBase/ru/general/ad-filtering/create-own-filters/"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/general/ad-filtering/create-own-filters/" hreflang="en"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/ru/general/ad-filtering/create-own-filters/" hreflang="ru"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/de/general/ad-filtering/create-own-filters/" hreflang="de"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/cs/general/ad-filtering/create-own-filters/" hreflang="cs"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/fr/general/ad-filtering/create-own-filters/" hreflang="fr"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/es/general/ad-filtering/create-own-filters/" hreflang="es"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/it/general/ad-filtering/create-own-filters/" hreflang="it"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/ja/general/ad-filtering/create-own-filters/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/ko/general/ad-filtering/create-own-filters/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/zh-CN/general/ad-filtering/create-own-filters/" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/zh-TW/general/ad-filtering/create-own-filters/" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://adguardteam.github.io/KnowledgeBase/general/ad-filtering/create-own-filters/" hreflang="x-default"><link rel="search" type="application/opensearchdescription+xml" title="AdGuard Knowledge Base" href="/KnowledgeBase/ru/opensearch.xml"><link rel="stylesheet" href="/KnowledgeBase/ru/assets/css/styles.7d5cc7de.css">
<link rel="preload" href="/KnowledgeBase/ru/assets/js/runtime~main.34dd83d1.js" as="script">
<link rel="preload" href="/KnowledgeBase/ru/assets/js/main.8fe70d4f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Перейти к основному содержанию"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Перейти к основному содержанию</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить панель навигации" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/KnowledgeBase/ru/"><div class="navbar__logo"><img src="/KnowledgeBase/ru/img/logo.svg" alt="AdGuard" class="themedImage_ToTc themedImage--light_HNdA"><img src="/KnowledgeBase/ru/img/logo_dark.svg" alt="AdGuard" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/KnowledgeBase/ru/">Документы</a><a href="https://adguard.com/blog/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Блог</a><a href="https://adguard.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Официальный сайт</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Русский</a><ul class="dropdown__menu"><li><a href="/KnowledgeBase/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/KnowledgeBase/ru/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ru">Русский</a></li><li><a href="/KnowledgeBase/de/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/KnowledgeBase/cs/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="cs">Čeština</a></li><li><a href="/KnowledgeBase/fr/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/KnowledgeBase/es/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/KnowledgeBase/it/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="/KnowledgeBase/ja/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/KnowledgeBase/ko/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li><li><a href="/KnowledgeBase/zh-CN/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文（中国）</a></li><li><a href="/KnowledgeBase/zh-TW/general/ad-filtering/create-own-filters/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">中文（台灣）</a></li><li><a class="dropdown__link" href="/KnowledgeBase/ru/miscellaneous/contribute/translate/program/">Help Us Translate</a></li></ul></div><a href="https://github.com/AdguardTeam/KnowledgeBase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключиться между тёмной и светлой темами (сейчас светлая тема)" aria-label="Переключиться между тёмной и светлой темами (сейчас светлая тема)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Поиск"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Поиск</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Вернуться наверх" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/KnowledgeBase/ru/"><img src="/KnowledgeBase/ru/img/logo.svg" alt="AdGuard" class="themedImage_ToTc themedImage--light_HNdA"><img src="/KnowledgeBase/ru/img/logo_dark.svg" alt="AdGuard" class="themedImage_ToTc themedImage--dark_i4oU"><b></b></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/KnowledgeBase/ru/">Обзор</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/KnowledgeBase/ru/general/ad-filtering/how-ad-blocking-works/">Основное</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/how-ad-blocking-works/">Фильтрация рекламы</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/how-ad-blocking-works/">Как работает блокировка рекламы</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/adguard-filters/">Фильтры AdGuard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/search-ads/">Поисковая реклама и самореклама</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/tracking-filter-statistics/">Сбор статистики по рекламным фильтрам</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/create-own-filters/">Как составлять свои фильтры</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/ad-filtering/filter-policy/">Политика фильтров AdGuard</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/KnowledgeBase/ru/general/https-filtering/what-is-https-filtering/">HTTPS-фильтрация</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/browsing-security/">Защита от фишинга</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/stealth-mode/">Защита от трекинга</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/userscripts/">Пользовательские скрипты</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/KnowledgeBase/ru/general/account/register/">Аккаунт AdGuard</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/KnowledgeBase/ru/general/license/what-is/">Лицензия</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBase/ru/general/how-to-install/">Как установить AdGuard</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-for-windows/overview/">AdGuard для Windows</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-for-mac/overview/">AdGuard для Mac</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-for-android/overview/">AdGuard для Android</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-for-ios/overview/">AdGuard для iOS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-browser-extension/overview/">Браузерное расширение AdGuard</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-for-safari/overview/">AdGuard для Safari</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/adguard-content-blocker/overview/">AdGuard Content Blocker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/miscellaneous/contribute/beta-testing/">Разное</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/KnowledgeBase/ru/guides/collect-har-file/">Руководства</a></div></li></ul></nav><button type="button" title="Свернуть боковую панель" aria-label="Свернуть боковую панель" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Хлебные крошки"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Домашняя страница" class="breadcrumbs__link" href="/KnowledgeBase/ru/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Основное</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Фильтрация рекламы</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Как составлять свои фильтры</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">На этой странице</button></div><div class="theme-doc-markdown markdown"><header><h1>Как составлять свои фильтры</h1></header><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>В этой статье мы рассказываем, как писать пользовательские правила фильтрации для использования в продуктах AdGuard. Чтобы проверить правила, <a href="https://agrd.io/download-kb-adblock" target="_blank" rel="noopener noreferrer">скачайте приложение AdGuard</a></p></div></div><p>Фильтр — это набор правил фильтрации рекламного контента (баннеров, всплывающих окон и тому подобного). В AdGuard есть список базовых фильтров, созданных нашей командой. Они постоянно дорабатываются и дополняются, и, как мы надеемся, удовлетворяют требованиям большинства пользователей.</p><p>В то же время AdGuard позволяет создавать пользовательские фильтры, используя те же типы правил, что и в наших фильтрах.</p><p>Для описания синтаксиса правил мы используем <a href="https://tools.ietf.org/html/rfc5234" target="_blank" rel="noopener noreferrer">Augmented BNF for Syntax Specifications</a>, но не всегда строго следуем этой спецификации.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Синтаксис правил AdGuard изначально основан на синтаксисе правил Adblock Plus. Позже мы расширили его новыми типами правил для лучшей фильтрации рекламы. Часть информации в этой статье об общих для ABP и AdGuard типах правил взята <a href="https://adblockplus.org/en/filters" target="_blank" rel="noopener noreferrer">из руководства Adblock Plus по написанию фильтров</a>.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="комментарии">Комментарии<a class="hash-link" href="#комментарии" title="Прямая ссылка на заголовок">​</a></h2><p>Любая строка, начинающаяся с восклицательного знака, является комментарием. В списке правил она подсвечивается серым цветом. AdGuard будет игнорировать эту строку, так что можете спокойно писать там всё, что хотите. Комментарии обычно размещаются над правилами и описывают то, что они делают.</p><p>Например:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! Это комментарий. Под этой строкой находится правило фильтрации.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="примеры">Примеры<a class="hash-link" href="#примеры" title="Прямая ссылка на заголовок">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="блокировка-по-имени-домена">Блокировка по имени домена<a class="hash-link" href="#блокировка-по-имени-домена" title="Прямая ссылка на заголовок">​</a></h3><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/0_blocking_domain.svg" alt="Блокировка по имени домена" class="img_ev3q"></p><p><strong>Это правило блокирует:</strong></p><ul><li><code>http://example.org/ad1.gif</code></li><li><code>http://subdomain.example.org/ad1.gif</code></li><li><code>https://ads.example.org:8000/</code></li></ul><p><strong>Это правило не блокирует:</strong></p><ul><li><code>http://ads.example.org.us/ad1.gif</code></li><li><code>http://example.com/redirect/http://ads.example.org/</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="блокировка-конкретного-адреса">Блокировка конкретного адреса<a class="hash-link" href="#блокировка-конкретного-адреса" title="Прямая ссылка на заголовок">​</a></h3><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/1_exact_address.svg" alt="Блокировка конкретного адреса" class="img_ev3q"></p><p><strong>Это правило блокирует:</strong></p><ul><li><code>http://example.org/</code></li></ul><p><strong>Это правило не блокирует:</strong></p><ul><li><code>https://example.org/banner/img</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic-rule-modifiers">Модификаторы базовых правил<a class="hash-link" href="#basic-rule-modifiers" title="Прямая ссылка на заголовок">​</a></h3><p>Правила фильтрации поддерживают множество модификаторов, которые позволяют вам точно настраивать поведение правила. Вот пример правила с некоторыми простыми модификаторами.</p><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/2_basic_rule_options.svg" alt="Модификаторы базовых правил" class="img_ev3q"></p><p><strong>Это правило блокирует:</strong></p><ul><li><code>http://example.com/script.js</code>, если этот скрипт загружен с <code>example.com</code>.</li></ul><p><strong>Это правило не блокирует:</strong></p><ul><li><code>https://example.org/script.js</code> если этот скрипт загружен с <code>example.org</code>.</li><li><code>https://example.org/banner.png</code> потому что это не скрипт.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="разблокировка-адреса">Разблокировка адреса<a class="hash-link" href="#разблокировка-адреса" title="Прямая ссылка на заголовок">​</a></h3><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/3_basic_exception.svg" alt="Разблокировка адреса" class="img_ev3q"></p><p><strong>Это правило разблокирует:</strong></p><ul><li><code>http://example.org/banner.png</code>, даже если для этого адреса есть правило блокировки.</li></ul><p>Правила блокировки с модификатором <a href="#important-modifier"><code>$important</code></a> приоритетнее, чем обычные правила разблокировки.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="разблокировка-всего-сайта">Разблокировка всего сайта<a class="hash-link" href="#разблокировка-всего-сайта" title="Прямая ссылка на заголовок">​</a></h3><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/4_unblock_entire_website.svg" alt="Разблокировка всего сайта" class="img_ev3q"></p><p><strong>Это правило разблокирует</strong></p><ul><li>Оно отключает все косметические правила на <code>example.com</code>.</li><li>Оно блокирует все запросы, отправленные с этого сайта, даже если есть правила блокировки, соответствующие этим запросам.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="косметические-правила">Косметические правила<a class="hash-link" href="#косметические-правила" title="Прямая ссылка на заголовок">​</a></h3><p><img loading="lazy" src="https://cdn.adtidy.org/content/kb/ad_blocker/general/5_cosmetic_rules.svg" alt="Косметические правила" class="img_ev3q"></p><p>Косметические правила применяются с использованием CSS — специального языка программирования, который понимает каждый браузер. В основном, он добавляет новый стиль CSS на сайт, цель которого — скрыть определённые элементы. Вы можете узнать больше о CSS в целом <a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Selectors" target="_blank" rel="noopener noreferrer">здесь</a>.</p><p>AdGuard <a href="#extended-css-selectors">расширяет возможности CSS</a> и позволяет разработчикам фильтров решать гораздо более сложные задачи. Но чтобы использовать эти расширенные правила, вы должны хорошо понимать, что такое CSS.</p><p><strong>Популярные CSS-селекторы</strong></p><table><thead><tr><th>Имя</th><th>CSS-селектор</th><th>Описание</th></tr></thead><tbody><tr><td>Селектор ID</td><td><code>#banners</code></td><td>Выбирает все элементы, <code>id</code> которых равен <code>banners</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_id_selector.png" alt="Селектор ID" class="img_ev3q"></td></tr><tr><td>Селектор класса</td><td><code>.banners</code></td><td>Выбирает все элементы с атрибутом <code>class</code>, содержащие <code>banners</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_selector.png" alt="Селектор класса" class="img_ev3q"></td></tr><tr><td>Селектор атрибута</td><td><code>div[class=&quot;banners&quot;]</code></td><td>Соответствует всем <code>div</code> элементам с атрибутом <code>class </code>, <strong>равным</strong> <code>banners</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr.png" alt="Селектор атрибута" class="img_ev3q"></td></tr><tr><td>Селектор вхождения подстроки</td><td><code>div[class^=&quot;advert1&quot;]</code></td><td>Выбирает все <code>div</code>-элементы, атрибут <code>class</code> которых <strong>начинается</strong> с <code>advert1</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr_start.png" alt="Селектор вхождения подстроки" class="img_ev3q"></td></tr><tr><td>Селектор вхождения подстроки</td><td><code>div[class$=&quot;banners_ads&quot;]</code></td><td>Выбирает все <code>div</code>-элементы, атрибут <code>class</code> которых <strong>заканчивается</strong> на <code>banners_ads</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr_end.png" alt="Селектор вхождения подстроки" class="img_ev3q"></td></tr><tr><td>Селектор вхождения подстроки</td><td><code>a[href^=&quot;http://example.com/&quot;]</code></td><td>Выбирает все ссылки, загруженные с домена <code>http://example.com/</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_attr_start.png" alt="Селектор вхождения подстроки" class="img_ev3q"></td></tr><tr><td>Селектор атрибута</td><td><code>a[href=&quot;http://example.com/&quot;]</code></td><td>Выбирает все ссылки, которые <strong>точное соответствуют</strong> <code>http://example.com/</code>.<br><img loading="lazy" src="https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_attr_equal.png" alt="Селектор атрибута" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ограничения-и-запреты">Ограничения и запреты<a class="hash-link" href="#ограничения-и-запреты" title="Прямая ссылка на заголовок">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="trusted-filters">Доверенные фильтры<a class="hash-link" href="#trusted-filters" title="Прямая ссылка на заголовок">​</a></h3><p>Некоторые правила можно использовать только в доверенных фильтрах. В эту категорию входят:</p><ul><li>Списки фильтров, <a href="/KnowledgeBase/ru/general/ad-filtering/adguard-filters/">созданные командой AdGuard</a></li><li>Пользовательские списки фильтров, помеченные как <code>trusted</code> (доверенные)</li><li>Пользовательские правила</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="adguard-content-blocker">AdGuard Content Blocker<a class="hash-link" href="#adguard-content-blocker" title="Прямая ссылка на заголовок">​</a></h3><p>AdGuard Content Blocker — это расширение для браузеров Samsung и Яндекс, которое можно установить из Google Play. Его не следует путать с полнофункциональным AdGuard для Android, который можно загрузить только с <a href="https://adguard.com/adguard-android/overview.html" target="_blank" rel="noopener noreferrer">нашего сайта</a>. К сожалению, возможности AdGuard Content Blocker ограничены тем, что позволяют браузеры, а они поддерживают только старый синтаксис фильтров Adblock Plus:</p><ul><li>Базовые правила блокировки со следующими модификаторами: <code>$domain</code>, <code>$third-party</code> и <a href="#content-type-modifiers">модификаторы типа контента</a>.</li><li>Базовые правила исключения со следующими модификаторами: <code>$document</code>, <code>$elemhide</code>.</li><li>Базовые правила скрытия элементов <a href="#cosmetic-elemhide-rules"></a> без расширенной поддержки CSS.</li></ul><p>Из-за указанных выше ограничений AdGuard Content Blocker не будет упоминаться в примечаниях по совместимости.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="базовые-правила">Базовые правила<a class="hash-link" href="#базовые-правила" title="Прямая ссылка на заголовок">​</a></h2><p>Самые простые правила — это так называемые <em>Базовые правила</em>. Они используются для блокировки запросов к определённым URL-адресам. Либо, при наличии специального маркера @@ в начале правила, для разблокировки запроса. Основной принцип для этого типа правил достаточно прост: необходимо указать адрес и дополнительные параметры, которые ограничивают или расширяют область действия правила.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Подзапросы</div><div class="admonitionContent_S0QG"><p>Базовые правила, блокирующие запросы, применяются только к <strong>подзапросам</strong>. Это означает, что они не будут блокировать загрузку страницы, если это не будет явно указано с помощью модификатора <code>$document</code>.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Статус ответа</div><div class="admonitionContent_S0QG"><p>Браузер определяет заблокированный подзапрос как выполненный с ошибкой.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Длина правила</div><div class="admonitionContent_S0QG"><p>Правила короче 4 символов считаются некорректными и игнорируются.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic-rules-syntax">Синтаксис базовых правил<a class="hash-link" href="#basic-rules-syntax" title="Прямая ссылка на заголовок">​</a></h3><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      rule = [&quot;@@&quot;] pattern [ &quot;$&quot; modifiers ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifiers = [modifier0, modifier1[, ...[, modifierN]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>pattern</code></strong> — маска адреса. URL каждого запроса сопоставляется с этой маской. In the template, you can also use the special characters described <a href="#basic-rules-special-characters">below</a>. Note that AdGuard truncates URLs to a length of 4096 characters in order to speed up matching and avoid issues with ridiculously long URLs.</li><li><strong><code>@@</code></strong> — маркер, который используется для обозначения правил-исключений. С такого маркера должны начинаться правила, отключающие фильтрацию для запроса.</li><li><strong><code>modifiers</code></strong> — параметры, используемые для «уточнения»‎ базового правила. Некоторые параметры ограничивают область действия правила, а некоторые могут полностью изменить принцип его работы.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic-rules-special-characters">Специальные символы<a class="hash-link" href="#basic-rules-special-characters" title="Прямая ссылка на заголовок">​</a></h3><ul><li><strong><code>*</code></strong> — wildcard-символ. Используется, чтобы обозначить любой набор символов. Это может быть как пустая строка, так и строка любой длины.</li><li><strong><code>||</code></strong> — указание на применение правила к указанному домену и его поддоменам. Этот специальный символ позволяет не указывать конкретный протокол и поддомен в маске адреса. То есть <code>||</code> соответствует сразу <code>http://*.</code>, <code>https://*.</code>, <code>ws://*.</code> и <code>wss://*.</code>.</li><li><strong><code>^</code></strong> — указатель для разделительного символа. Разделителем может быть любой символ кроме буквы, цифры и следующих символов: <code>_</code> <code>-</code> <code>.</code> <code>%</code>. Например, в адресе <code>http:</code><strong><code>//</code></strong><code>example.com</code><strong><code>/?</code></strong><code>t=1</code><strong><code>&amp;</code></strong><code>t2=t3</code> жирным выделены разделительные символы. Конец адреса также принимается в качестве разделителя.</li><li><strong><code>|</code></strong> — указатель на начало или конец адреса. Значение зависит от расположения символов в маске. Например, правило <code>swf|</code> соответствует <code>http://example.com/annoyingflash.swf</code>, но не <code>http://example.com/swf/index.html</code>. <code>|http://example.org</code> соответствует <code>http://example.org</code>, но не <code>http://domain.com?url=http://example.org</code>.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p><code>|</code>, <code>||</code>, <code>^</code> can only be used with rules that have a URL pattern. For example, <code>||example.com##.advert</code> is incorrect and will be ignored by the blocker.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Визуальное представление</div><div class="admonitionContent_S0QG"><p>Рекомендуем также прочитать <a href="https://adblockplus.org/filter-cheatsheet#blocking" target="_blank" rel="noopener noreferrer">шпаргалку по фильтрам от Adblock Plus</a>, чтобы лучше понять, как строятся такие правила.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="regexp-support">Поддержка регулярных выражений<a class="hash-link" href="#regexp-support" title="Прямая ссылка на заголовок">​</a></h3><p>Если вы хотите добиться ещё большей гибкости при составлении правил, вы можете использовать <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener noreferrer">регулярные выражения</a> вместо упрощённой маски со специальными символами, которая используется по умолчанию.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Производительность</div><div class="admonitionContent_S0QG"><p>Такие правила работают медленнее обычных, поэтому рекомендуется избегать их или хотя бы ограничивать их область действия конкретными доменами.</p></div></div><p>Чтобы блокировщик определил, что вы хотите использовать регулярное выражение, необходимо, чтобы <code>pattern</code> имел особый вид:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pattern = &quot;/&quot; regexp &quot;/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Например, правило <code>/banner\d+/$third-party</code> применит регулярное выражение <code>banner\d+</code> ко всем сторонним запросам. Правила-исключения с использованием регулярных выражений выглядят вот так: <code>@@/banner\d+/</code>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>AdGuard для Safari и AdGuard для iOS не полностью поддерживают регулярные выражения в силу ограничений <a href="https://webkit.org/blog/3476/content-blockers-first-look/" target="_blank" rel="noopener noreferrer">Content Blocking API</a> (см. раздел The Regular expression format).</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wildcard-for-tld">Поддержка wildcard для доменов верхнего уровня (TLD)<a class="hash-link" href="#wildcard-for-tld" title="Прямая ссылка на заголовок">​</a></h3><p>Wildcard-символы поддерживаются для TLD-доменов в шаблонах <a href="#cosmetic-rules">косметических правил</a>, правил <a href="#html-filtering-rules">HTML-фильтрации</a> и <a href="#javascript-rules">JavaScript</a>.</p><p>Для косметических правил, например, <code>example.*##.banner</code>, несколько доменов будут сопоставлены благодаря части <code>.*</code>, т.е. <code>example.com</code>, <code>sub.example.net</code>, <code>example.co.uk</code> и т. д.</p><p>При составлении базовых правил вы можете использовать wildcard-символ для TLD только вместе с <a href="#domain-modifier">модификатором <code>$domain</code></a>. Например, <code>||*/banners/*$image,domain=example.*</code>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>В AdGuard для Windows, Mac и Android и в браузерном расширении AdGuard правила с подстановочным знаком <code>.*</code> соответствуют <a href="https://publicsuffix.org/list/" target="_blank" rel="noopener noreferrer">любому публичному суффиксу (или eTLD)</a>. Но для AdGuard для Safari и iOS <a href="https://github.com/AdguardTeam/SafariConverterLib/blob/v2.0.31/Sources/ContentBlockerConverter/Compiler/BlockerEntryFactory.swift#L44" target="_blank" rel="noopener noreferrer">поддерживаемый список доменов верхнего уровня</a> ограничен из-за ограничений Safari.</p></div></div><p>Правила с wildcard для доменов верхнего уровня не поддерживаются в AdGuard Content Blocker.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="примеры-базовых-правил">Примеры базовых правил<a class="hash-link" href="#примеры-базовых-правил" title="Прямая ссылка на заголовок">​</a></h3><ul><li><p><code>||example.com/ads/*</code> — простое правило, которое соответствует адресам типа <code>http://example.com/ads/banner.jpg</code> и даже <code>http://subdomain.example.com/ads/otherbanner.jpg</code>.</p></li><li><p><code>||example.org^$third-party</code> — правило, которое блокирует сторонние запросы к домену <code>example.org</code> и его поддоменам.</p></li><li><p><code>@@||example.com$document </code> — наиболее общее правило-исключение. Такое правило полностью отключает фильтрацию на домене <code>example.com</code> и всех его поддоменах. Существует ряд параметров, которые также можно использовать в правилах-исключениях. Более подробно о правилах-исключениях и параметрах, которые могут в таких правилах использоваться, написано <a href="#exception-modifiers">ниже</a>.</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="модификаторы-базовых-правил">Модификаторы базовых правил<a class="hash-link" href="#модификаторы-базовых-правил" title="Прямая ссылка на заголовок">​</a></h3><ul><li><a href="#basic-rules-basic-modifiers">Базовые модификаторы</a></li><li><a href="#content-type-modifiers">Модификаторы типа контента</a></li><li><a href="#exception-modifiers">Модификаторы правил-исключений</a></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Возможности, описанные в этом разделе, предназначены для опытных пользователей. Они расширяют возможности «Общих правил», но для их применения необходимо представлять, как работает браузер.</p></div></div><p>Вы можете изменить поведение «общего правила», используя дополнительные модификаторы. Список этих параметров располагается в конце правила за знаком доллара <code>$</code> и разделяется запятыми.</p><p>Пример:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||domain.com^$popup,third-party</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic-rules-basic-modifiers">Базовые модификаторы<a class="hash-link" href="#basic-rules-basic-modifiers" title="Прямая ссылка на заголовок">​</a></h3><p>Приведённые ниже модификаторы самые простые и часто применяемые. В основном, они просто ограничивают сферу применения правила.</p><table><thead><tr><th>Модификатор \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#app-modifier">$app</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#denyallow-modifier">$denyallow</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#domain-modifier">$domain</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅ <a href="#domain-modifier-limitations">*</a></td><td align="center">✅ <a href="#domain-modifier-limitations">*</a></td><td align="center">✅</td></tr><tr><td><a href="#header-modifier">$header</a></td><td align="center">✅</td><td align="center">⏳</td><td align="center">⏳</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#important-modifier">$important</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#match-case-modifier">$match-case</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">⏳</td><td align="center">⏳</td><td align="center">✅</td></tr><tr><td><a href="#method-modifier">$method</a></td><td align="center">⏳</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#popup-modifier">$popup</a></td><td align="center">✅ *</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅ *</td><td align="center">✅ *</td><td align="center">❌</td></tr><tr><td><a href="#third-party-modifier">$third-party</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#to-modifier">$to</a></td><td align="center">⏳</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>✅ * — поддерживается, но надёжность может быть разной или могут возникнуть ограничения; ознакомьтесь с описанием модификатора для получения подробной информации</li><li>⏳ — функция, которая реализована или планируется к реализации, но пока недоступна ни в одном продукте</li><li>❌ — не поддерживается</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="app-modifier"><strong><code>$app</code></strong><a class="hash-link" href="#app-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор ограничивает действие правила до конкретного приложения (или списка приложений). Это может быть не слишком важно для Windows и Mac, но это очень важно для мобильных устройств, где некоторые правила фильтрации должны быть связаны с конкретным приложением.</p><ul><li>Android — используйте имя пакета приложения, например, <code>org.example.app</code>.</li><li>Windows — используйте имя процесса, например, <code>chrome.exe</code>.</li><li>Mac — используйте bundle ID или имя процесса, например, <code>com.google.Chrome</code>.</li></ul><p>На Mac вы можете найти bundle ID или имя процесса интересующего вас приложения в деталях соответствующих запросов в Журнале фильтрации.</p><p><strong>Примеры</strong></p><ul><li><code>||baddomain.com^$app=org.example.app</code> — правило для блокировки запросов, которые соответствуют указанной маске и отправлены Android-приложением <code>org.example.app</code>.</li><li><code>||baddomain.com^$app=org.example.app1|org.example.app2</code> — аналогичное правило, но оно работает как для приложения <code>org.example.app1</code>, так и для <code>org.example.app2</code>.</li></ul><p>Если вы хотите, чтобы правило не применялось к определённым приложениям, начните название приложения с символа <code>~</code>.</p><ul><li><code>||baddomain.com^$app=~org.example.app</code> — правило для блокировки запросов, соответствующих указанной маске и отправленных из любого приложения, кроме <code>org.example.app</code>.</li><li><code>||baddomain.com^$app=~org.example.app1|~org.example.app2</code> — аналогично, но в исключениях два приложения: <code>org.example.app1</code> и <code>org.example.app2</code>.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>В модификаторе правила к приложениям нельзя добавлять подстановочный знак (<em>), например `$app=com.</em>.music`. Правила с таким модификатором считаются недействительными.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Только AdGuard для Windows, Mac и Android имеют технические возможности для поддержки правил с модификатором <code>$app</code>.</li><li>На Windows имя процесса нечувствительно к регистру, начиная с версий AdGuard для Windows c CoreLibs 1.12.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="denyallow-modifier"><strong><code>$denyallow</code></strong><a class="hash-link" href="#denyallow-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$denyallow</code> позволяет избежать создания дополнительных правил, когда требуется отключить то или иное правило для определённых доменов. Модификатор <code>$denyallow</code> соответствует только целевым доменам, но не доменам реферера.</p><p>Добавление этого модификатора в правило равносильно исключению доменов при помощи паттерна правила либо при помощи добавления дополнительных правил-исключений. Чтобы добавить несколько доменов в одно правило, используйте символ <code>|</code> в качестве разделителя.</p><p><strong>Примеры</strong></p><p>Это правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*$script,domain=a.com|b.com,denyallow=x.com|y.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>эквивалентно этому правилу:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/^(?!.*(x.com|y.com)).*$/$script,domain=a.com|b.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>или комбинации этих трёх:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*$script,domain=a.com|b.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||x.com$script,domain=a.com|b.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||y.com$script,domain=a.com|b.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Паттерн правила не может указывать на конкретные домены, например, не может начинаться с <code>||</code>.</li><li>Домены в значении модификатора не могут иметь отрицание (например, <code>$denyallow=~x.com</code>) или wildcard домена верхнего уровня <code>$denyallow=x.*</code>.</li></ul><p>Правила, нарушающие эти ограничения, считаются недействительными.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$denyallow</code> не поддерживаются в AdGuard для iOS, Safari и AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="domain-modifier"><strong><code>$domain</code></strong><a class="hash-link" href="#domain-modifier" title="Прямая ссылка на заголовок">​</a></h4><p><code>$domain</code> ограничивает область действия правила запросами, сделанными <strong>с</strong> указанных доменов и их поддоменов (как указано в HTTP-заголовке <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/Headers/Referer" target="_blank" rel="noopener noreferrer">Referer</a>).</p><p><strong>Синтаксис</strong></p><p>Модификатор представляет собой список из одного или нескольких выражений, разделённых символом <code>|</code>, каждое из которых сопоставляется с доменом определённым образом в зависимости от его типа (см. ниже).</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">domains = [&quot;~&quot;] entry_0 [&quot;|&quot; [&quot;~&quot;] entry_1 [&quot;|&quot; [&quot;~&quot;]entry_2 [&quot;|&quot; ... [&quot;|&quot; [&quot;~&quot;]entry_N]]]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry_i = ( regular_domain / any_tld_domain / regexp )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>Regular_domain</code></strong> — обычное доменное имя (<code>domain.com</code>). Соответствует указанному домену и его поддоменам. Сопоставляется лексикографически.</li><li><strong><code>any_tld_domain</code></strong> — доменное имя, оканчивающееся подстановочным знаком в качестве <a href="https://publicsuffix.org/learn/" target="_blank" rel="noopener noreferrer">публичного суффикса</a>, например, для <code>example.*</code> это <code>co.uk</code> в <code>example.co.uk</code>. Соответствует указанному домену и его поддоменам с любым публичным суффиксом. Сопоставляется лексикографически.</li><li><strong><code>regexp</code></strong> — регулярное выражение, начинается и заканчивается символом <code>/</code>. Паттерн работает так же, как и в основных URL-правилах, но символы <code>/</code>, <code>$</code> и <code>,</code> должны быть экранированы с помощью <code>\</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$domain</code> в виде <code>regular_domain</code> или <code>any_tld_domain</code> поддерживаются всеми продуктами AdGuard.</p></div></div><p><strong>Примеры</strong></p><p><strong>Просто <code>$domain</code>:</strong></p><ul><li><code>||baddomain.com^$domain=example.org</code> блокирует запросы, которые соответствуют указанной маске и отправлены с домена <code>example.org</code> или его поддоменов.</li><li><code>||baddomain.com^$domain=example.org|example.com</code> — такое же правило, но срабатывать оно будет как для домена <code>example.org</code>, так и для <code>example.com</code>.</li></ul><p>Если вы хотите, чтобы правило не применялось к определённым доменам, начните доменное имя со знака <code>~</code>.</p><p><strong><code>$domain</code> и инверсия <code>~</code>:</strong></p><ul><li><code>||baddomain.com^$domain=example.org</code> блокирует запросы, которые соответствуют указанной маске и отправлены с домена <code>example.org</code> или его поддоменов.</li><li><code>||baddomain.com^$domain=example.org|example.com</code> — такое же правило, но срабатывать оно будет как для домена <code>example.org</code>, так и для <code>example.com</code>.</li><li><code>||baddomain.com^$domain=~example.org</code> блокирует запросы, которые соответствуют указанной маске и отправлены с любого домена, кроме <code>example.org</code> и его поддоменов.</li><li><code>||baddomain.com^$domain=example.org|~foo.example.org</code> блокирует запросы, отправленные с домена <code>example.org</code> и всех его поддоменов, кроме <code>foo.example.org</code>.</li><li><code>||baddomain.com^$domain=/(^\|.+\.)example\.(com\|org)\$/</code> блокирует запросы, отправляемые с доменов <code>example.org</code> и <code>example.com</code> и всех их поддоменов.</li><li><code>||baddomain.com^$domain=~a.com|~b.*|~/(^\|.+\.)c\.(com\|org)\$/</code> блокирует запросы, отправленные с любых доменов, кроме <code>a.com</code>, <code>b</code> с любым публичным суффиксом (<code>b.com</code>, <code>b.co.uk</code>, и т.д.), <code>c.com</code>, <code>c.org</code> и их поддоменов.</li></ul><p><strong>Модификатор <code>$domain</code>, соответствующий целевому домену:</strong></p><p>В некоторых случаях модификатор <code>$domain</code> может соответствовать не только домену-рефереру, но и целевому домену. This happens when all the following conditions are met:</p><ol><li>The request has the <code>document</code> content type</li><li>Шаблон правила не соответствует ни одному конкретному домену</li><li>Шаблон правила не содержит регулярных выражений</li><li>Модификатор <code>$domain</code> содержит только исключённые домены, например, <code>$domain=~example.org|~example.com</code></li></ol><p>Для сопоставления целевого домена должен выполняться следующий предикат:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1 И ((2 И 3) ИЛИ 4)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>То есть, если модификатор <code>$domain</code> содержит только исключённые домены, то правилу не нужно выполнять второе и третье условия, чтобы соответствовать целевому домену <code>$domain</code>.</p><p>Если какие-либо из условий выше не выполнены, но правило содержит модификатор <a href="#cookie-modifier"><code>$cookie</code></a> или <a href="#csp-modifier"><code>$csp</code></a>, модификатор всё равно будет соответствовать целевому домену.</p><p>Если реферер соответствует правилу с <code>$domain</code>, которое явно исключает домен реферера, то правило не сработает, даже если целевой домен тоже ему соответствует. Это также касается правил с модификаторами <a href="#cookie-modifier"><code>$cookie</code></a> и <a href="#csp-modifier"><code>$csp</code></a>.</p><p><strong>Примеры</strong></p><ul><li><code>*$cookie,domain=example.org|example.com</code> заблокирует cookies для всех запросов от и к <code>example.org</code> и <code>example.com</code>.</li><li><code>*$document,domain=example.org|example.com</code> заблокирует все запросы от и к <code>example.org</code> и <code>example.com</code>.</li></ul><p>В следующих примерах предполагается, что запросы отправляются от <code>http://example.org/page</code> (реферер), а целевой URL — <code>http://targetdomain.com/page</code>.</p><ul><li><code>page$domain=example.org</code> сработает, так как соответствует рефереру.</li><li><code>page$domain=targetdomain.com</code> сработает, так как соответствует целевому домену и удовлетворяет всем требованиям, перечисленным выше.</li><li><code>||*page$domain=targetdomain.com</code> не сработает, так как шаблон <code>||*page</code> может указывать на конкретные домены, например, <code>example.page</code>.</li><li><code>||*page$domain=targetdomain.com,cookie</code> сработает, потому что правило содержит модификатор <code>$cookie</code>, несмотря на то, что шаблон <code>||*page</code> может соответствовать конкретным доменам.</li><li><code>/banner\d+/$domain=targetdomain.com</code> не сработает, поскольку правило содержит регулярное выражение.</li><li><code>page$domain=targetdomain.com|~example.org</code> не сработает, так как домен реферера явно исключён.</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="domain-modifier-limitations">Ограничения модификатора <code>$domain</code><a class="hash-link" href="#domain-modifier-limitations" title="Прямая ссылка на заголовок">​</a></h5><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Safari не поддерживает одновременно разрешённые и запрещённые домены, поэтому правила вида <code>||baddomain.com^$domain=example.org|~foo.example.org</code> не работают в AdGuard для iOS и AdGuard для Safari.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с регулярными выражениями в модификаторе <code>$domain</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 11 или выше</strong>.</p><p>В AdGuard для Windows, Mac и Android <strong>с CoreLibs 1.12 или более поздней версии</strong> вместо модификатора <code>$domain</code> можно также использовать <code>$from</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="header-modifier"><strong><code>$header</code></strong><a class="hash-link" href="#header-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$header</code> позволяет сопоставлять HTTP-ответ, имеющий определённый заголовок, с определённым значением (опционально).</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$header &quot;=&quot; h_name [&quot;:&quot; h_value]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h_value = string / regexp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где:</p><ul><li><strong><code>h_name</code></strong> (обязательно) — имя HTTP-заголовка. Сопоставляется без учёта регистра символов.</li><li><strong><code>h_value</code></strong> (опционально) — выражение для сопоставления значения HTTP-заголовка, может быть одним из:<ul><li><strong><code>string</code></strong> — последовательность символов. Лексикографически сопоставляется со значением заголовка;</li><li><strong><code>regexp</code></strong> — регулярное выражение, начинается и заканчивается символом <code>/</code>. Паттерн работает так же, как и в основных URL-правилах, но символы <code>/</code>, <code>$</code> и <code>,</code> должны быть экранированы с помощью <code>\</code>.</li></ul></li></ul><p>The modifier part, <code>&quot;:&quot; h_value</code>, may be omitted. В этом случае модификатор сопоставляет только имя заголовка.</p><p><strong>Примеры</strong></p><ul><li><code>||example.com^$header=set-cookie:foo</code> — блокирует запрос, ответ которого содержит заголовок <code>Set-Cookie</code> со значением <code>foo</code>.</li><li><code>||example.com^$header=set-cookie </code> блокирует запрос, ответ которого содержит заголовок <code>Set-Cookie</code> с любым значением.</li><li><code>@@||example.com^$header=set-cookie:/foo\, bar\$/</code> разблокирует запросы, ответы которых содержат заголовок <code>Set-Cookie</code> со значением <code>foo, bar$</code>.</li><li><code>@@||example.com^$header=set-cookie</code> разблокирует запрос, ответ которого содержит заголовок <code>Set-Cookie</code> с любым значением.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$header</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 11 или выше</a>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="important-modifier"><strong><code>$important</code></strong><a class="hash-link" href="#important-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>The <code>$important</code> modifier applied to a rule increases its priority over rules without the identical modifier. Даже относительно базовых правил-исключений.</p><p>Перейдите <a href="#rule-priorities">к приоритетам правил</a> для более подробной информации.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! блокирующее правило заблокирует все запросы, несмотря на правило-исключение</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$important</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! если правило-исключение тоже содержит модификатор `$important`, его приоритет будет выше, и запросы не будут заблокированы</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$important</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org^$important</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="match-case-modifier"><strong><code>$match-case</code></strong><a class="hash-link" href="#match-case-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор определяет правило, которое применяется только к адресам с совпадением регистра символов. По умолчанию регистр символов не учитывается.</p><p><strong>Примеры</strong></p><ul><li><code>*/BannerAd.gif$match-case </code>— такое правило будет блокировать <code>http://example.com/BannerAd.gif</code>, но не <code>http://example.com/bannerad.gif</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с <code>$match-case</code> поддерживаются в AdGuard для iOS и AdGuard для Safari <strong>с SafariConverterLib версии 2.0.43 или выше</strong>.</p><p>Все остальные продукты уже поддерживают этот модификатор.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="method-modifier"><strong><code>$method</code></strong><a class="hash-link" href="#method-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор ограничивает область действия правила запросами, использующими указанный набор методов HTTP. Допускается инверсия (~). Методы должны быть указаны строчными буквами, но сопоставляются они без учёта регистра. Чтобы добавить несколько методов в одно правило, используйте в качестве разделителя вертикальную черту <code>|</code>.</p><p><strong>Примеры</strong></p><ul><li><code>||evil.com^$method=get|head</code> блокирует только запросы GET и HEAD к <code>evil.com</code>.</li><li><code>||evil.com^$method=~post|~put</code> блокирует любые запросы к <code>evil.com</code>, кроме POST или PUT.</li><li><code>@@||evil.com$method=get</code> разблокирует только GET-запросы к <code>evil.com</code>.</li><li><code>@@||evil.com$method=~post</code> разблокирует любые запросы к <code>evil.com</code>, кроме POST.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Правила, где к одному методу применяется инверсия (~), а к другому нет, считаются недействительными. Так, например, правило <code>||evil.com^$method=get|~head</code> будет отклонено.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$method</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 12 или выше</a>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="popup-modifier"><strong><code>$popup</code></strong><a class="hash-link" href="#popup-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>AdGuard будет пытаться закрыть браузерную вкладку с любым адресом, подходящим под правило с этим модификатором. Обратите внимание, что закрыть можно не любую вкладку.</p><p><strong>Примеры</strong></p><ul><li><code>||domain.com^$popup</code> — при попытке перехода на сайт <code>http://domain.com</code> с любой страницы в браузере, новая вкладка, в которой должен открыться указанный сайт, будет закрыта.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Модификатор <code>$popup</code> лучше всего работает в браузерном расширении AdGuard.</li><li>В AdGuard для Safari и iOS <code>$popup</code>-правила просто заблокируют страницу.</li><li>В AdGuard для Windows, Mac и Android модификатор <code>$popup</code> в некоторых случаях может не обнаружить всплывающее окно, и оно не будет заблокировано. Модификатор <code>$popup</code> применяет тип контента <code>document</code> со специальным флагом, который передаётся блокирующей странице. Блокирующая страница сама может провести некоторые проверки и закрыть окно, если это действительно всплывающее окно. В противном случае страница должна быть загружена. Его можно комбинировать с другими модификаторами типа request, такими как <code>$third-party</code> и <code>$important</code>.</li><li>Правила с модификатором <code>$popup</code> не поддерживаются в AdGuard Content Blocker.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="third-party-modifier"><strong><code>$third-party</code></strong><a class="hash-link" href="#third-party-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Ограничение на сторонние или собственные запросы. Сторонним является запрос, отправленный с другого домена. Например, запрос к домену <code>example.org</code>, отправленный с домена <code>domain.com</code>, является сторонним.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Чтобы считаться таковым, сторонний запрос должен соответствовать одному из следующих условий:</p><ol><li>Его реферер — это не поддомен целевого домена, или наоборот. Например, запрос к <code>subdomain.example.org</code>, отправленный с домена <code>example.org</code>, не является сторонним</li><li>Значение его заголовка <code>Sec-Fetch-Site</code> — <code>cross-site</code></li></ol></div></div><p><strong>Примеры</strong></p><p><strong><code>$third-party</code>:</strong></p><ul><li><code>||domain.com^$third-party</code> — правило применяется на всех сайтах, кроме <code>domain.com</code> и его поддоменов. Пример стороннего запроса: <code>http://example.org/banner.jpg</code>.</li></ul><p>Если указан модификатор <code>$~third-party</code>, то правило применяется только к запросам, которые не являются сторонними. То есть эти запросы отправлены с того же домена.</p><p><strong><code>$~third-party</code>:</strong></p><ul><li><code>||domain.com$~third-party</code> — this rule is applied exclusively to <code>domain.com</code>. Example of a non third-party request: <code>http://domain.com/icon.ico</code>.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое название (псевдоним) вместо полного названия модификатора: <code>$3p</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="to-modifier"><strong><code>$to</code></strong><a class="hash-link" href="#to-modifier" title="Прямая ссылка на заголовок">​</a></h4><p><code>$to</code> ограничивает область действия правила запросами, сделанными <strong>на</strong> указанные домены и их поддомены. Чтобы добавить несколько доменов в одно правило, используйте символ <code>|</code> в качестве разделителя.</p><p><strong>Примеры</strong></p><ul><li><code>/ads$to=evil.com|evil.org</code> блокирует любые запросы к <code>evil.com</code> или <code>evil.org</code> и их поддоменам с путём, соответствующим <code>/ads</code>.</li><li><code>/ads$to=~not.evil.com|evil.com</code> блокирует любые запросы к <code>evil.com</code> и его поддоменам с путём, совпадающим с <code>/ads</code>, за исключением запросов к <code>not.evil.com</code> и его поддоменам.</li><li><code>/ads$to=~good.com|~good.org</code> блокирует любые запросы с путём, соответствующим <code>/ads</code>, за исключением запросов к <code>good.com</code> или <code>good.org</code> и их поддоменам.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p><a href="#denyallow-modifier"><code>$denyallow</code></a> нельзя использовать вместе с <code>$to</code>. Его можно выразить инвертированным <code>$to</code>: <code>$denyallow=a.com|b.com</code> эквивалентно <code>$to=~a.com|~b.com</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$to</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 1.12 или выше</a> и в Браузерном расширении AdGuard с TSUrlFilter версии 2.1.3 или выше.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="content-type-modifiers">Модификаторы типа контента<a class="hash-link" href="#content-type-modifiers" title="Прямая ссылка на заголовок">​</a></h3><p>Существует целый набор модификаторов, которые ограничивают область применения правила только определённым типом контента. Эти модификаторы можно комбинировать, чтобы, например, распространить правило одновременно и на картинки, и на скрипты.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Существует большая разница в том, как AdGuard определяет тип контента на разных платформах. В случае Браузерного расширения AdGuard, тип контента для каждого запроса предоставляется самим браузером. В случае AdGuard для Windows, Mac и Android для определения используется следующая методика: сначала мы пытаемся определить тип запроса по заголовку запроса <code>Sec-Fetch-Dest</code> или по расширению имени файла. Если запрос не заблокирован на этом этапе, то тип запроса уточняется с использованием заголовка <code>Content-Type</code> в начале ответа, полученного от сервера.</p></div></div><p><strong>Примеры модификаторов типа контента</strong></p><ul><li><code>||example.org^$image</code> — соответствует всем картинкам с домена <code>example.org</code>.</li><li><code>||example.org^$script,stylesheet</code> — соответствует всем скриптам и стилям с домена <code>example.org</code>.</li><li><code>||example.org^$~image,~script,~stylesheet</code> — соответствует всем запросам к домену <code>example.org</code>, кроме картинок, скриптов и стилей.</li></ul><table><thead><tr><th>Модификатор \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#document-modifier">$document</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#font-modifier">$font</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#image-modifier">$image</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#media-modifier">$media</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#object-modifier">$object</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#other-modifier">$other</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#ping-modifier">$ping</a></td><td align="center">✅ *</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">✅</td></tr><tr><td><a href="#script-modifier">$script</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#stylesheet-modifier">$stylesheet</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#subdocument-modifier">$subdocument</a></td><td align="center">✅ *</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#websocket-modifier">$websocket</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅ *</td><td align="center">✅ *</td><td align="center">✅</td></tr><tr><td><a href="#xmlhttprequest-modifier">$xmlhttprequest</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#webrtc-modifier" title="удалён">$webrtc 🚫</a></td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#object-subrequest-modifier" title="удалён">$object-subrequest 🚫</a></td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>✅ * — поддерживается, но надёжность может быть разной или могут возникнуть ограничения; ознакомьтесь с описанием модификатора для получения подробной информации</li><li>❌ — не поддерживается</li><li>🚫 — удалён и больше не поддерживается</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="document-modifier"><strong><code>$document</code></strong><a class="hash-link" href="#document-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам основного документа страницы, т.е. HTML-документа, который загружается во вкладке браузера. Оно не подходит для iframe, для них существует модификатор <a href="#subdocument-modifier"><code>$subdocument</code></a>.</p><p>По умолчанию AdGuard не блокирует запросы, которые загружаются во вкладке браузера (например, «обход основного фрейма»). Идея заключается в том, чтобы не препятствовать загрузке страниц, поскольку пользователь явно указал, что он хочет, чтобы эта страница была загружена. Однако, если использовать модификатор <code>$document</code>, то AdGuard не будет использовать эту логику и предотвратит загрузку страницы. Другими словами, заблокирует её.</p><p>Если этот модификатор используется в правиле-исключении (<code>@@</code>), то оно полностью отключает блокировку на соответствующих страницах. Это равносильно одновременному использованию модификаторов <code>$elemhide</code>, <code>$content</code>, <code>$urlblock</code>, <code>$jsinject</code> и <code>$extension</code>.</p><p><strong>Примеры</strong></p><ul><li><p><code>@@||example.com^$document </code> полностью отключает фильтрацию на всех страницах сайта <code>example.com</code> и всех его поддоменах.</p></li><li><p><code>||example.com^$document</code> блокирует запрос HTML-документа на <code>example.com</code> с помощью блокирующей страницы.</p></li><li><p><code>||example.com^$document,redirect=noopframe</code> перенаправляет запрос HTML-документа сайта <code>example.com</code> на пустой HTML-документ.</p></li><li><p><code>||example.com^$document,removeparam=test</code> удаляет параметр <code>test</code> из запроса HTML-документа к <code>example.com</code>.</p></li><li><p><code>||example.com^$document,replace=/test1/test2/</code> заменяет <code>test1</code> на <code>test2</code> в запросе HTML-документа к <code>example.com</code>.</p></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$doc</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="font-modifier"><strong><code>$font</code></strong><a class="hash-link" href="#font-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам к файлам шрифтов (например, файлам с расширением <code>.woff</code>).</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="image-modifier"><strong><code>$image</code></strong><a class="hash-link" href="#image-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам к изображениям.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="media-modifier"><strong><code>$media</code></strong><a class="hash-link" href="#media-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам к медиафайлам — музыке и видео, например файлам <code>.mp4</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="object-modifier"><strong><code>$object</code></strong><a class="hash-link" href="#object-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует ресурсам плагинов браузера, например, Java или Flash.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="other-modifier"><strong><code>$other</code></strong><a class="hash-link" href="#other-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило применяется к запросам, тип которых не был определён или не соответствует перечисленным выше типам.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ping-modifier"><strong><code>$ping</code></strong><a class="hash-link" href="#ping-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам, вызванным атрибутом <code>navigator.sendBeacon()</code> или <code>ping</code> в ссылках.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>AdGuard для Windows, Mac и Android часто не может точно определить <code>navigator.sendBeacon()</code>. Не рекомендуется использовать <code>$ping</code> в фильтрах, которые должны использоваться продуктами AdGuard на базе CoreLibs.</p><p>Правила с модификатором <code>$ping</code> не поддерживаются в AdGuard для Safari и iOS.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="script-modifier"><strong><code>$script</code></strong><a class="hash-link" href="#script-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствет запросам к файлам скриптов, например, javascript или vbscript.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stylesheet-modifier"><strong><code>$stylesheet</code></strong><a class="hash-link" href="#stylesheet-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам к файлам CSS-стилей.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$css</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="subdocument-modifier"><strong><code>$subdocument</code></strong><a class="hash-link" href="#subdocument-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило соответствует запросам к встроенным страницам — HTML-теги <code>frame</code> и <code>iframe</code>.</p><p><strong>Примеры</strong></p><ul><li><code>||example.com^$subdocument</code> блокирует запросы встроенных страниц (<code>frame</code> и <code>iframe</code>) к <code>example.com</code> и всем его поддоменам.</li><li><code>||example.com^$subdocument,domain=domain.com</code> блокирует запросы встроенных страниц (<code>frame</code> и <code>iframe</code>) к <code>example.com</code> и его поддоменам с <code>domain.com</code> и всех его поддоменов.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$frame</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>В AdGuard для Windows, Mac и Android вложенные документы обнаруживаются по заголовку <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Dest" target="_blank" rel="noopener noreferrer">Sec-Fetch-Dest</a>, если он есть. В противном случае некоторые основные страницы могут рассматриваться как поддокументы.</p><p>Правила с модификатором <code>$subdocument</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="websocket-modifier"><strong><code>$websocket</code></strong><a class="hash-link" href="#websocket-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило применяется только к соединениям WebSocket.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Модификатор <code>$websocket</code> поддерживается во всех продуктах AdGuard, кроме AdGuard Content Blocker. Что касается AdGuard для Safari и AdGuard для iOS, то они поддерживаются на устройствах с macOS Monterey (версия 12) и iOS 16 и выше.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="xmlhttprequest-modifier"><strong><code>$xmlhttprequest</code></strong><a class="hash-link" href="#xmlhttprequest-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правило применяется только к ajax-запросам (запросам, отправленным через объект JavaScript <code>XMLHttpRequest</code>).</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$xhr</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>AdGuard для Windows, Mac и Android часто не может точно определить этот тип модификатора и иногда определяет его как <a href="#other-modifier"><code>$other</code></a> или <a href="#script-modifier"><code>$script</code></a>. Они могут надёжно обнаружить этот тип контента только при фильтрации современных браузеров, поддерживающих <a href="https://developer.mozilla.org/en-US/docs/Glossary/Fetch_metadata_request_header" target="_blank" rel="noopener noreferrer">Fetch metadata request headers</a>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="object-subrequest-modifier"><strong><code>$object-subrequest</code> (удалён)</strong><a class="hash-link" href="#object-subrequest-modifier" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Уведомление об удалении</div><div class="admonitionContent_S0QG"><p>Модификатор <code>$object-subrequest</code> удалён и больше не поддерживается. Правила с ним не работают. Правило соответствует запросам плагинов браузера (обычно это Flash).</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="webrtc-modifier"><strong><code>$webrtc</code> (удалён)</strong><a class="hash-link" href="#webrtc-modifier" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Уведомление об удалении</div><div class="admonitionContent_S0QG"><p>Этот модификатор удалён и больше не поддерживается. Правила с ним не работают. Если вы хотите блокировать WebRTC, рассмотрите возможность использования <a href="#scriptlets">скриптлета</a> <code>nowebrtc</code>.</p></div></div><p>Правило применяется только к WebRTC-соединениям.</p><p><strong>Примеры</strong></p><ul><li><code>||example.com^$webrtc,domain=example.org</code> blocks webRTC connections to <code>example.com</code> from <code>example.org</code>.</li><li><code>@@*$webrtc,domain=example.org</code> — это правило отключает оболочку RTC для <code>example.org</code>.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exception-modifiers">Модификаторы правил исключений<a class="hash-link" href="#exception-modifiers" title="Прямая ссылка на заголовок">​</a></h3><p>Правила исключений отключают действие других базовых правил для адресов, которым они соответствуют. Они начинаются с маркера <code>@@</code>. Для таких правил работают все базовые модификаторы, перечисленные выше. Также добавляется несколько специальных модификаторов, которые будут описаны ниже.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Визуальное представление</div><div class="admonitionContent_S0QG"><p>Рекомендуем также прочитать <a href="https://adblockplus.org/filter-cheatsheet#blocking" target="_blank" rel="noopener noreferrer">шпаргалку по фильтрам от Adblock Plus</a>, чтобы лучше понять, как строятся правила исключений.</p></div></div><table><thead><tr><th>Модификатор \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#content-modifier">$content</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#elemhide-modifier">$elemhide</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#extension-modifier">$extension</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#jsinject-modifier">$jsinject</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#stealth-modifier">$stealth</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#urlblock-modifier">$urlblock</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅ *</td><td align="center">✅ *</td><td align="center">❌</td></tr><tr><td><a href="#genericblock-modifier">$genericblock</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅ *</td><td align="center">✅ *</td><td align="center">❌</td></tr><tr><td><a href="#generichide-modifier">$generichide</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#specifichide-modifier">$specifichide</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>✅ * — поддерживается, но надёжность может быть разной или могут возникнуть ограничения; ознакомьтесь с описанием модификатора для получения подробной информации</li><li>❌ — не поддерживается</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="content-modifier"><strong><code>$content</code></strong><a class="hash-link" href="#content-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает <a href="#html-filtering-rules">HTML-фильтрацию</a>, правила <a href="#hls-modifier"><code>$hls</code></a>, <a href="#replace-modifier"><code>$replace</code></a>и <a href="#jsonprune-modifier"><code>$jsonprune</code></a> на страницах, соответствующих правилу.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$content</code> отключает все правила модификации контента на страницах <code>example.com</code> и всех его поддоменах.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="elemhide-modifier"><strong><code>$elemhide</code></strong><a class="hash-link" href="#elemhide-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает любые <a href="#cosmetic-rules">косметические правила</a> на страницах, подходящих под правило.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$elemhide</code> отменяет все косметические правила для страниц на сайте <code>example.com</code> и на всех его поддоменах.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое название (псевдоним) вместо полного названия модификатора: <code>$ehide</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extension-modifier"><strong><code>$extension</code></strong><a class="hash-link" href="#extension-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает пользовательские скрипты — определённые или все для данного домена.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$extension[=&quot;userscript_name1&quot;[|&quot;userscript_name2&quot;[|&quot;userscript_name3&quot;[...]]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>userscript_name(i)</code> обозначает конкретное имя пользовательского скрипта, которое должно быть отключено модификатором. The modifier can contain any number of userscript names or none. В последнем случае модификатор отключает все пользовательские скрипты.</p><p>Имена пользовательских скриптов обычно содержат пробелы или другие специальные символы, поэтому необходимо заключать их в кавычки. Поддерживаются как одинарные (<code>&#x27;</code>), так и двойные (<code>&quot;</code>) ASCII-кавычки. Несколько имён пользовательских скриптов должны быть разделены вертикальной чертой (<code>|</code>). Однако если имя пользовательского скрипта представляет собой одно слово без специальных символов, то его можно использовать без кавычек.</p><p>Вы также можете исключить пользовательский скрипт из фильтрации, добавив перед ним символ <code>~</code>. В этом случае пользовательский скрипт не будет отключён модификатором.</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$extension=~&quot;userscript name&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Исключая пользовательский скрипт из фильтрации, обязательно выносите символ <code>~</code> за кавычки.</p></div></div><p>Если имя пользовательского скрипта содержит кавычки (<code>&quot;</code>), запятые (<code>,</code>) или вертикальную черту (<code>|</code>), они должны быть экранированы обратной косой чертой (<code>\</code>).</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$extension=&quot;userscript name\, with \&quot;quote\&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$extension=&quot;AdGuard Assistant&quot;</code> отключает пользовательский скрипт <code>AdGuard Assistant</code> на сайте <code>example.com</code>.</li><li><code>@@||example.com^$extension=MyUserscript</code> отключает пользовательский скрипт <code>MyUserscript</code> на сайте <code>example.com</code>.</li><li><code>@@||example.com^$extension=&#x27;AdGuard Assistant&#x27;|&#x27;Popup Blocker&#x27;</code> отключает оба пользовательских скрипта <code>AdGuard Assistant</code> и <code>Popup Blocker</code> на сайте <code>example.com</code>.</li><li><code>@@||example.com^$extension=~&quot;AdGuard Assistant&quot;</code> отключает все пользовательские скрипты на сайте <code>example.com</code>, кроме <code>AdGuard Assistant</code>.</li><li><code>@@||example.com^$extension=~&quot;AdGuard Assistant&quot;|~&quot;Popup Blocker&quot;</code> отключает все пользовательские скрипты на сайте <code>example.com</code>, кроме <code>AdGuard Assistant</code> и <code>Popup Blocker</code>.</li><li><code>@@||example.com^$extension</code> — пользовательские скрипты не будут работать на страницах сайта <code>example.com</code>.</li><li><code>@@||example.com^$extension=&quot;AdGuard \&quot;Assistant\&quot;&quot;</code> отключает пользовательский скрипт <code>AdGuard &quot;Assistant&quot;</code> на сайте <code>example.com</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Только AdGuard для Windows, Mac и Android имеют технические возможности для поддержки правил с модификатором <code>$extension</code>.</li><li>Модификатор <code>$extension</code> с названием пользовательского скрипта поддерживается в AdGuard для Windows, Mac и Android <strong>c CoreLibs версии 1.13 или выше</strong>.</li></ul><p>Правила с модификатором <code>$extension</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 1.13 или выше</a>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jsinject-modifier"><strong><code>$jsinject</code></strong><a class="hash-link" href="#jsinject-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Запрещает добавление javascript-кода на страницу. О скриптлетах и javascript-правилах речь пойдёт ниже.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$jsinject</code> отменяет все javascript-правила для страниц на сайте <code>example.com</code> и на всех его поддоменах.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stealth-modifier"><strong><code>$stealth</code></strong><a class="hash-link" href="#stealth-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает модуль «Антитрекинг»‎ для всех страниц и запросов, подходящих под это правило.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stealth [= opt1 [| opt2 [| opt3 [...]]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Здесь <code>opt(i)</code> обозначают опции «Антитрекинг»‎, отключаемые правилами. The modifier can contain any number of options (see below) or none. В последнем случае модификатор отключает модуль «Антитрекинг»‎ полностью.</p><p>Список доступных опций модификатора:</p><ul><li><code>searchqueries</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#searchqueries"><strong>Скрывать поисковые запросы</strong></a></li><li><code>donottrack</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#donottrack"><strong>Просить сайты не отслеживать вас</strong></a></li><li><code>3p-cookie</code> отключает <a href="/KnowledgeBase/ru/general/stealth-mode/#3p-cookie"><strong>Самоуничтожение сторонних куки</strong></a></li><li><code>1p-cookie</code> отключает <a href="/KnowledgeBase/ru/general/stealth-mode/#1p-cookie"><strong>Самоуничтожение куки сайта</strong></a></li><li><code>3p-cache</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#3p-cache"><strong>Блокировать заголовки ETag и If-None-Match</strong></a></li><li><code>3p-auth</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#3p-auth"><strong>Блокировать сторонний заголовок авторизации</strong></a></li><li><code>webrtc</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#webrtc"><strong>Блокировать WebRTC</strong></a></li><li><code>push</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#push"><strong>Блокировать Push API</strong></a></li><li><code>location</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#location"><strong>Блокировать Location API</strong></a></li><li><code>flash</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#flash"><strong>Блокировать Flash</strong></a></li><li><code>java</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#java"><strong>Блокировать Java</strong></a></li><li><code>referrer</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#miscellaneous"><strong>Скрывать Referer от третьих лиц</strong></a></li><li><code>useragent</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#useragent"><strong>Скрывать User-Agent</strong></a></li><li><code>ip</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#ip"><strong>Скрывать IP-адрес</strong></a></li><li><code>xclientdata</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#xclientdata"><strong>Удалять заголовок X-Client-Data</strong></a></li><li><code>dpi</code> отключает опцию <a href="/KnowledgeBase/ru/general/stealth-mode/#dpi"><strong>Защищать от DPI</strong></a></li></ul><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$stealth</code> полностью отключает модуль «Антитрекинг» для запросов к <code>example.com</code> и поддоменам, кроме блокировки куки и скрытия параметров отслеживания (см.ниже).</li><li><code>@@||domain.com^$script,stealth,domain=example.com</code> отключает модуль «Антитрекинг» только для script-запросов к <code>domain.com</code> (и поддоменам) на <code>example.com</code> и всех его поддоменах.</li><li><code>@@||example.com^$stealth=3p-cookie|dpi</code> отключает блокировку сторонних куки-файлов и меры защиты от DPI для запросов к <code>example.com</code>.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Блокировка куки и скрытие параметров отслеживания достигается использованием правил с модификаторами <a href="#cookie-modifier"><code>$cookie</code></a> и <a href="#removeparam-modifier"><code>$removeparam</code></a>. Правила-исключения только с модификатором <code>$stealth</code> не дадут желаемого результата. Если вы хотите полностью отключить все функции Антитрекинга для определённого домена, нужно включить в правило все три модификатора: <code>@@||example.org^$stealth,removeparam,cookie</code></p></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Modifier options must be lowercase, i.e. <code>$stealth=DPI</code> will be rejected.</li><li>Параметры модификатора не могут отрицаться, т.е. <code>$stealth=~3p-cookie</code> будет отклонён.</li></ul></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Антитрекинг доступен в AdGuard для Windows, Mac и Android и в Браузерном расширении AdGuard. Все остальные продукты будут игнорировать правила с модификатором <code>$stealth</code>.</li><li>Правила с модификатором <code>$stealth</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 1.10 или выше</a>.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="urlblock-modifier"><strong><code>$urlblock</code></strong><a class="hash-link" href="#urlblock-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает все правила <a href="#cookie-modifier"><code>$cookie</code></a> и блокировку всех запросов со страниц, соответствующих правилу.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$urlblock</code> — любые запросы, отправленные со страниц сайта <code>example.com</code> и всех его поддоменов, не будут блокироваться.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>В AdGuard для iOS и AdGuard для Safari правила <code>$urlblock</code> работают как <a href="#document-modifier">исключение $document</a> — они разблокируют всё.</p><p>Правила с модификатором <code>$urlblock</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exception-modifiers-generic-rules">Generic-правила<a class="hash-link" href="#exception-modifiers-generic-rules" title="Прямая ссылка на заголовок">​</a></h4><p>Перед тем, как перейти к описанию следующих модификаторов, необходимо ввести определение <em>generic-правил</em>. Правило относится к generic-правилам, если его действие не ограничено конкретными доменами. Также поддерживается wildcard-символ <code>*</code>.</p><p>Например, это generic-правила:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">###banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*###banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#@#.adsblock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*#@#.adsblock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~domain.com###banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||domain.com^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||domain.com^$domain=~example.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>А это уже не generic-правила:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">domain.com###banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||domain.com^$domain=example.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="genericblock-modifier"><strong><code>$genericblock</code></strong><a class="hash-link" href="#genericblock-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает все базовые правила generic на страницах, подходящих под правило-исключение.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$genericblock</code> отключает базовые правила generic на любых страницах <code>example.com</code> и всех поддоменах.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>В AdGuard для iOS и AdGuard для Safari правила <code>$genericblock</code> работают как <a href="#document-modifier">исключение $document</a> — они разблокируют всё.</p><p>Правила с модификатором <code>$genericblock</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="generichide-modifier"><strong><code>$generichide</code></strong><a class="hash-link" href="#generichide-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает все <a href="#cosmetic-rules">косметические правила</a> generic на страницах, соответствующих правилу-исключению.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.com^$generichide</code> отключает косметические правила generic на страницах сайта <code>example.com</code> и всех его поддоменах.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$ghide</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="specifichide-modifier"><strong><code>specifichide</code></strong><a class="hash-link" href="#specifichide-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Отключает все specific-правила скрытия элементов и CSS-правила, но не отключает general-правила. Имеет эффект, противоположный <a href="#generichide-modifier"><code>$generichide</code></a>.</p><p><strong>Примеры</strong></p><ul><li><code>@@||example.org^$specifichide</code> отключает <code>example.org##.banner</code>, но не <code>##.banner</code>.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Вы можете использовать более короткое имя (псевдоним) вместо полного имени модификатора: <code>$shide</code>.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Все косметические правила, а не только specific, можно отключить модификатором <a href="#elemhide-modifier"><code>$elemhide</code></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$specifichide</code> не поддерживаются в AdGuard для iOS, AdGuard для Safari и AdGuard Content Blocker.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="advanced-modifiers">Расширенные возможности<a class="hash-link" href="#advanced-modifiers" title="Прямая ссылка на заголовок">​</a></h3><p>Модификаторы, описанные в этом разделе, полностью меняют поведение базовых правил.</p><table><thead><tr><th>Модификатор \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#all-modifier">$all</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#badfilter-modifier">$badfilter</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#cookie-modifier">$cookie</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#csp-modifier">$csp</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#hls-modifier">$hls</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#inline-font-modifier">$inline-font</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#inline-script-modifier">$inline-script</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#jsonprune-modifier">$jsonprune</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#network-modifier">$network</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#permissions-modifier">$permissions</a></td><td align="center">✅</td><td align="center">⏳</td><td align="center">⏳</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#redirect-modifier">$redirect</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#redirect-rule-modifier">$redirect-rule</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#referrerpolicy-modifier">$referrerpolicy</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#removeheader-modifier">$removeheader</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#removeparam-modifier">$removeparam</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#replace-modifier">$replace</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#noop-modifier">noop</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#empty-modifier" title="устарел">$empty 👎</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#mp4-modifier" title="устарел">$mp4 👎</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>✅ * — поддерживается, но надёжность может быть разной или могут возникнуть ограничения; ознакомьтесь с описанием модификатора для получения подробной информации</li><li>❌ — не поддерживается</li><li>👎 — устарел; всё ещё поддерживается, но в будущем будет удалён</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="all-modifier"><strong><code>$all</code></strong><a class="hash-link" href="#all-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$all</code> состоит из <a href="#content-type-modifiers">всех модификаторов content-type</a> и <a href="#popup-modifier"><code>$popup</code></a>. Например, правило <code>||example.org^$all</code> конвертируется в правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$document,subdocument,font,image,media,object,other,ping,script,stylesheet,websocket,xmlhttprequest,popup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Этот модификатор нельзя использовать как исключение с маркером <code>@@</code>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$all</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="badfilter-modifier"><strong><code>$badfilter</code></strong><a class="hash-link" href="#badfilter-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правила, содержащие модификатор <code>$badfilter</code>, отключают другие базовые правила, на которые они ссылаются. Это означает, что текст отключённого правила должен соответствовать тексту <code>$badfilter</code>-правила (за исключением самого модификатора <code>$badfilter</code>).</p><p><strong>Примеры</strong></p><ul><li><code>||example.com$badfilter</code> отключает <code>||example.com</code></li><li><code>||example.com$image,badfilter</code> отключает <code>||example.com$image</code></li><li><code>@@||example.com$badfilter</code> отключает <code>@@||example.com</code></li><li><code>||example.com$domain=domain.com,badfilter</code> отключает <code>||example.com$domain=domain.com</code></li></ul><p>Правила с модификатором <code>$badfilter</code> могут отключать другие базовые правила для определённых доменов, если они соответствуют следующим условиям:</p><ol><li>В правиле есть модификатор <code>$domain</code></li><li>В модификаторе <code>$domain</code> нет отрицания домена <code>~</code></li></ol><p>В этом случае, правило с <code>$badfilter</code> отключит соответствующее базовое правило для доменов, указанных как в правиле с <code>$badfilter</code>, так и в базовом правиле. Обратите внимание, что <a href="#wildcard-for-tld">логика wildcard для доменов верхнего уровня (TLD)</a> здесь также применима.</p><p><strong>Примеры</strong></p><ul><li><code>/some$domain=example.com|example.org|example.io</code> отключено для <code>example.com</code> правилом <code>/some$domain=example.com,badfilter</code></li><li><code>/some$domain=example.com|example.org|example.io</code> отключено для <code>example.com</code> и <code>example.org</code> правилом <code>/some$domain=example.com|example.org,badfilter</code></li><li><code>/some$domain=example.com|example.org</code> и <code>/some$domain=example.io</code> полностью отключены правилом <code>/some$domain=example.com|example.org|example.io,badfilter</code></li><li><code>/some$domain=example.com|example.org|example.io</code> полностью отключено правилом <code>/some$domain=example.*,badfilter</code></li><li><code>/some$domain=example.*</code> отключено для <code>example.com</code> и <code>example.org</code> правилом <code>/some$domain=example.com|example.org,badfilter</code></li><li><code>/some$domain=example.com|example.org|example.io</code> НЕ отключено для <code>example.com</code> правилом <code>/some$domain=example.com|~example.org,badfilter</code>, поскольку значение модификатора <code>$domain</code> содержит отрицание домена</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$badfilter</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cookie-modifier"><strong><code>$cookie</code></strong><a class="hash-link" href="#cookie-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$cookie</code> полностью меняет поведение правила. Вместо того, чтобы блокировать запрос, этот модификатор позволяет AdGuard блокировать или изменять заголовки <code>Cookie</code> или <code>Set-Cookie</code>.</p><p><strong>Несколько правил, соответствующих одному запросу</strong></p><p>В случае, когда несколько правил <code>$cookie</code> соответствуют одному запросу, мы применим каждое из них по очереди.</p><p><strong>Синтаксис</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$cookie [= name[; maxAge = seconds [; sameSite = strategy ]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где:</p><ul><li><strong><code>name</code></strong> — опционально, строка или регулярное выражение для сопоставления с именем куки.</li><li><strong><code>seconds</code></strong> — количество секунд, на которое сместится истечение срока действия куки.</li><li><strong><code>strategy</code></strong> — строка для стратегии <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noopener noreferrer">Same-Site</a> для использования куки.</li></ul><p>Например,</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$cookie=NAME;maxAge=3600;sameSite=lax</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>каждый раз, когда AdGuard встречает куки с именем <code>NAME</code> в запросе к <code>example.org</code>, он будет делать следующее:</p><ul><li>Установит дату истечения срока хранения на текущее время плюс <code>3600</code> секунд</li><li>Позволяет куки использовать стратегию <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noopener noreferrer">Same-Site</a>.</li></ul><p><strong>Экранирование специальных символов</strong></p><p>Если для сопоставления используется регулярное выражение <code>name</code>, необходимо экранировать два символа: запятую <code>,</code> и знак доллара <code>$</code>. Используйте для этого обратный слеш <code>\</code>. Например, экранированная запятая будет выглядеть так: <code>\,</code>.</p><p><strong>Примеры</strong></p><ul><li><code>||example.org^$cookie</code> блокирует <strong>все</strong> куки, установленные <code>example.org</code>; это эквивалентно установке <code>maxAge=0</code></li><li><code>$cookie=__cfduid</code> блокирует куки CloudFlare везде</li><li><code>$cookie=/__utm[a-z]/</code> блокирует куки Google Analytics везде</li><li><code>||facebook.com^$third-party,cookie=c_user</code> не позволяет Facebook отслеживать вас, даже если вы вошли в систему</li></ul><p>Существует два способа деактивации правил <code>$cookie</code>: основной предполагает использование исключения с <code>@@</code> — <code>@@||example.org^$cookie</code>. Альтернативный метод использует исключение <code>$urlblock</code> (также входящее в псевдоним исключения <code>$document</code> — <code>$elemhide,jsinject,content,urlblock,extension</code>). Вот как это работает:</p><ul><li><code>@@||example.org^$cookie</code> разблокирует все куки-файлы, установленные <code>example.org</code></li><li><code>@@||example.org^$urlblock</code> разблокирует все файлы куки, установленные <code>example.org</code>, и отключает блокировку всех запросов, отправленных с <code>example.org</code></li><li><code>@@||example.org^$cookie=concept</code> разблокирует один куки-файл с именем <code>concept</code></li><li><code>@@||example.org^$cookie=/^_ga_/</code> разблокирует все куки, соответствующие регулярному выражению</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p><code>$cookie</code> rules support three types of modifiers: <code>$domain</code>, <code>$~domain</code>, <code>$important</code>, <code>$third-party</code>, and <code>$~third-party</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$cookie</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="csp-modifier"><strong><code>$csp</code></strong><a class="hash-link" href="#csp-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор полностью меняет поведение страницы. Когда он применяется, правило не блокирует запрос. Вместо этого будут изменены заголовки ответа.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Чтобы использовать правила этого типа, необходимо базовое понимание слоя безопасности <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="noopener noreferrer">Content Security Policy</a>.</p></div></div><p>Для запросов, подходящих под <code>$csp</code>-правило, мы усилим политику безопасности ответа, добавив дополнительную политику, равнозначную содержимому модификатора <code>$csp</code>. Правила <code>$csp</code> применяются независимо от правил любого другого типа. <strong>Only document-level exceptions</strong> can influence it (see the examples section), but no other basic rules.</p><p><strong>Несколько правил, соответствующих одному запросу</strong></p><p>В случае, когда несколько правил <code>$csp</code> соответствуют одному запросу, мы применим каждое из них.</p><p><strong>Синтаксис</strong></p><p>Синтаксис значений <code>$csp</code> похож на синтаксис заголовков Политики Безопасности Контента.</p><p>Значение <code>$csp</code> может быть пустым в случае правил-исключений. См. примеры ниже.</p><p><strong>Примеры</strong></p><ul><li><code>||example.org^$csp=frame-src &#x27;none&#x27;</code> запрещает все фреймы на example.org и его поддоменах.</li><li><code>@@||example.org/page/*$csp=frame-src &#x27;none&#x27;</code> отключает все правила с модификатором <code>$csp</code>, в точности соответствующим <code>frame-src &#x27;none&#x27;</code> на всех страницах, подходящих под паттерн правила. Например, правило выше.</li><li><code>@@||example.org/page/*$csp</code> отключает все <code>$csp</code>-правила на всех страницах, подходящих под паттерн правила.</li><li><code>||example.org^$csp=script-src &#x27;self&#x27; &#x27;unsafe-eval&#x27; http: https:</code> отключает инлайн-скрипты на всех страницах, подходящих под паттерн правила.</li><li><code>@@||example.org^$document</code> или <code>@@||example.org^$urlblock</code> отключает все <code>$csp</code>-правила на всех страницах, подходящих под паттерн правила.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Некоторые символы запрещены в значении <code>$csp</code>: <code>,</code>, <code>$</code>.</li><li><code>$csp</code>-правила поддерживают ограниченный список модификаторов: <code>$domain</code>, <code>$important</code>, <code>$subdocument</code>.</li><li>Правила с директивами <code>report-*</code> считаются некорректными.</li></ul></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$csp</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hls-modifier"><strong><code>$hls</code></strong><a class="hash-link" href="#hls-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правила <code>$hls</code> модифицируют ответ на соответствующий правилу запрос. Они предназначены для удаления сегментов из <a href="https://datatracker.ietf.org/doc/html/rfc8216" target="_blank" rel="noopener noreferrer">HLS-плейлистов (RFC 8216)</a>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Слово segment в документации означает Media Segment или playlist (как часть Master Playlist): с точки зрения правил <code>$hls</code>, Master Playlist и Media Playlist неразличимы.</p></div></div><p><strong>Синтаксис</strong></p><ul><li><code>||example.org^$hls=urlpattern</code> удаляет сегменты, URL которых соответствует паттерну <code>urlpattern</code>. Паттерн работает так же, как в базовых URL-правилах, однако символы <code>/</code>, <code>$</code> и <code>,</code> в составе <code>urlpattern</code> необходимо экранировать с помощью <code>\</code>.</li><li><code>||example.org^$hls=/regexp/options</code> удаляет сегменты, в которых URL-адрес или один из тегов (для определённых параметров, если они есть) соответствуют регулярному выражению <code>regexp</code>. Доступные значения <code>options</code>:<ul><li><code>t</code> — вместо URL-адреса сегмента проверять каждый тег сегмента на соответствие регулярному выражению. Сегмент с соответствующим тегом будет удалён;</li><li><code>i</code> — сделать регулярное выражение нечувствительным к регистру символов.</li></ul></li></ul><p>Символы <code>/</code>, <code>$</code> и <code>,</code> должны быть экранированы с помощью <code>\</code> внутри <code>regexp</code>.</p><p><strong>Исключения</strong></p><p>Базовые URL правила-исключения не отключают правила с модификатором <code>$hls</code>. Отключить их можно следующим образом:</p><ul><li><code>@@||example.org^$hls</code> отключает все правила <code>$hls</code> для ответов от URL-адресов, соответствующих <code>||example.org^ URL</code>.</li><li><code>@@||example.org^$hls=text</code> отключает все правила <code>$hls</code>, у которых значение модификатора <code>$hls</code> равно <code>text</code>, для ответов с URL-адресов, соответствующих <code>||example.org^ URL</code>.</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>подсказка</div><div class="admonitionContent_S0QG"><p><code>$hls</code> также можно отключить с помощью правил-исключений с модификаторами <code>$document</code>, <code>$content</code> и <code>$urlblock</code>.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Если несколько правил <code>$hls</code> соответствуют одному и тому же запросу, их эффект суммируется.</p></div></div><p><strong>Примеры</strong></p><ul><li><code>||example.org^$hls=\/videoplayback^?*&amp;source=dclk_video_ads</code> удаляет все сегменты с соответствующим URL.</li><li><code>||example.org^$hls=/\/videoplayback\/?\?.*\&amp;source=dclk_video_ads/i</code> делает почти то же самое, но с помощью регулярного выражения вместо URL-паттерна.</li><li><code>||example.org^$hls=/#UPLYNK-SEGMENT:.*\,ad/t</code> удаляет все сегменты с соответствующим тегом.</li></ul><p><strong>О формате HLS-плейлистов</strong></p><p>Из <a href="https://datatracker.ietf.org/doc/html/rfc8216" target="_blank" rel="noopener noreferrer">спецификации</a> следует:</p><ol><li>HLS-плейлист — это набор текстовых строк</li><li>Можно использовать пустую строку, комментарий (начинается с <code>#</code>), тег (тоже начинается с <code>#</code>, распознаётся по содержанию) или URL</li><li>Строка с URL называется сегментом</li><li>Тег может относиться к одному сегменту, т.е. к первой строке с URL, следующей после данного тега, ко всем последующим сегментам (пока не встретится тег с тем же названием) или ко всему плейлисту</li></ol><p>Замечания, касающиеся правил <code>$hls</code>:</p><ol><li>Когда сегмент удаляется, все теги, относящиеся только к нему, тоже удаляются</li><li>Теги, относящиеся к нескольким сегментам, удаляются, если все эти сегменты были удалены</li><li>Поскольку различные типы тегов невозможно распознать по синтаксису, мы распознаем все теги, указанные в RFC, плюс некоторые нестандартные теги, которые встречались нам в полевых условиях. Любые строки, начинающиеся с <code>#</code> и не распознанные как тег, пропускаются без модификации и не сопоставляются с правилами</li><li>Tags will not be matched if they apply to the entire playlist, and <code>$hls</code> rrules cannot be used to remove them, as these rule types are intended for segment removals. Если вы знаете, что делаете, вы можете использовать правила <code>$replace</code> для удаления или перезаписи только одного тега из плейлиста</li></ol><p><strong>Пример работы правил:</strong></p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Исходный ответ</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#EXTM3U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-TARGETDURATION:10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">preroll.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-SEGMENT:abc123,ad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-KEY:aabb1122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-DISCONTINUITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-SEGMENT:abc123,segment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-KEY:ccdd2233</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-DISCONTINUITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-ENDLIST</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Применённые правила</summary><div><div class="collapsibleContent_i85q"><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$hls=preroll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$hls=/#UPLYNK-SEGMENT:.*\,ad/t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Модифицированный ответ</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#EXTM3U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-TARGETDURATION:10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-SEGMENT:abc123,segment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#UPLYNK-KEY:ccdd2233</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-DISCONTINUITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF,10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-ENDLIST</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Правила <code>$hls</code> разрешены только <a href="#trusted-filters"><strong>в доверенных фильтрах</strong></a>.</li><li>Правила <code>$hls</code> совместимы с модификаторами <code>$domain</code>, <code>$third-party</code>, <code>$app</code>, <code>$important</code>, <code>$match-case</code> и <code>$xmlhttprequest</code>.</li><li>Правила <code>$hls</code> применимы только к HLS-плейлистам, т. е. к тексту в кодировке UTF-8, начинающемуся со строки <code>#EXTM3U</code>. Никакие другие ответы не будут модифицированы этими правилами.</li><li><code>$hls</code> rules do not apply if the size of the original response is more than 10 MB.</li></ul></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$hls</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.10 или выше</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="inline-script-modifier"><strong><code>$inline-script</code></strong><a class="hash-link" href="#inline-script-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$inline-script</code> предназначен для блокировки встроенного в страницу кода JavaScript с использованием политики безопасности контента (CSP). Он повышает безопасность, не позволяя загружать встроенную рекламу или потенциально вредоносные скрипты. Правило <code>||example.org^$inline-script</code> конвертируется в правило синтаксиса CSP:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$csp=script-src &#x27;self&#x27; &#x27;unsafe-eval&#x27; http: https: data: blob: mediastream: filesystem:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="inline-font-modifier"><strong><code>$inline-font</code></strong><a class="hash-link" href="#inline-font-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>$inline-font</code> предназначен для блокировки встроенных в страницу шрифтов с использованием политики безопасности контента (CSP). Он повышает безопасность, не позволяя загружать встроенные шрифты, которые могут использоваться для сбора данных и фингерпринтинга. Правило <code>||example.org^$inline-font</code> конвертируется в правило синтаксиса CSP:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$csp=font-src &#x27;self&#x27; &#x27;unsafe-eval&#x27; http: https: data: blob: mediastream: filesystem:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jsonprune-modifier"><strong><code>$jsonprune</code></strong><a class="hash-link" href="#jsonprune-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правила <code>$jsonprune</code> модифицируют ответ на соответствующий запрос, удаляя JSON-элементы, которые соответствуют модифицированному выражению <a href="https://goessner.net/articles/JsonPath/" target="_blank" rel="noopener noreferrer">JSONPath</a>. Эти правила не изменяют ответы, которые не являются действительными JSON-документами.</p><p>В AdGuard для Windows, Mac и Android <strong>с CoreLibs версии 1.11 или выше</strong> <code>$jsonprune</code> также поддерживается модификация JSONP-документов (padded JSON).</p><p><strong>Синтаксис</strong></p><ul><li><code>||example.org^$jsonprune=expression</code> удаляет из ответа элементы, соответствующие изменённому JSONPath-выражению <code>expression</code>.</li></ul><p>Из-за особенностей работы парсинга правил символы <code>$</code> и <code>,</code> внутри <code>expression</code> должны экранироваться символом <code>\</code>.</p><p>Модифицированный синтаксис JSONPath имеет следующие отличия от оригинального:</p><ol><li>Выражения на сценарном языке (script expressions) не поддерживаются</li><li>Поддерживаемые предикаты (filter expressions):<ul><li><code>?(has &lt;key&gt;)</code> — верно, если текущий объект содержит указанный ключ</li><li><code>?(key-eq &lt;key&gt; &lt;value&gt;)</code> — верно, если текущий объект содержит указанный ключ и его значение равно указанному</li><li><code>?(key-substr &lt;key&gt; &lt;value&gt;)</code> — верно, если указанное значение является подстрокой значения ключа текущего объекта</li></ul></li><li>Пробелы вне двойных или одинарных кавычек игнорируются</li><li>Можно использовать строки как с двойными, так и с одинарными кавычками</li><li>Выражения, оканчивающиеся на <code>..</code>, не поддерживаются</li><li>Разрешено указывать несколько срезов массива (array slices) в квадратных скобках</li></ol><p>Существуют различные онлайн-инструменты, которые делают работу с выражениями JSONPath удобнее:</p><p><a href="https://www.site24x7.com/tools/jsonpath-finder-validator.html" target="_blank" rel="noopener noreferrer">https://www.site24x7.com/tools/jsonpath-finder-validator.html</a> <a href="https://jsonpathfinder.com/" target="_blank" rel="noopener noreferrer">https://jsonpathfinder.com/</a> <a href="https://jsonpath.com/" target="_blank" rel="noopener noreferrer">https://jsonpath.com/</a></p><p>Обратите внимание, что различные имплементации JSONPath обладают уникальными особенностями и могут быть несовместимы друг с другом.</p><p><strong>Исключения</strong></p><p>Базовые URL правила-исключения не отключают правила с модификатором <code>$jsonprune</code>. Отключить их можно следующим образом:</p><ul><li><code>@@||example.org^$jsonprune</code> отключает все правила <code>$jsonprune</code> для ответов от URL-адресов, соответствующих <code>||example.org^</code>.</li><li><code>@@||example.org^$jsonprune=text</code> отключает все правила <code>$jsonprune</code>, у которых значение модификатора <code>jsonprune</code> равно <code>text</code>, для ответов с URL-адресов, соответствующих <code>||example.org^</code>.</li></ul><p><code>$jsonprune</code> также можно отключить с помощью правил-исключений с модификаторами <code>$document</code>, <code>$content</code> и <code>$urlblock</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Когда одному и тому же запросу соответствует несколько правил с модификатором <code>$jsonprune</code>, они сортируются в лексикографическом порядке: первое правило применяется к исходному ответу, а каждое из оставшихся правил применяется к результату применения предыдущего.</p></div></div><p><strong>Примеры</strong></p><ul><li><code>||example.org^$jsonprune=\$..[one\, &quot;two three&quot;]</code> удаляет все вхождения ключей one и two three в любом месте JSON-документа.</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>До</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;one&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;two&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;two three&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;four five&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>После</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;two&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;four five&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><ul><li><code>||example.org^$jsonprune=\$.a[?(has ad_origin)]</code> удаляет всех прямых потомков <code>a</code>, которые обладают свойством <code>ad_origin</code>.</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>До</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;ad_origin&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.org&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>После</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><ul><li><code>||example.org^$jsonprune=\$.*.*[?(key-eq &#x27;Some key&#x27; &#x27;Some value&#x27;)]</code> удаляет все элементы на уровне вложенности 3, обладающие свойством Some key, равным Some value.</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>До</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Some value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Other value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;f&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Some value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Other value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>После</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Other value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;f&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Some key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Other value&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p><strong>Вложенные выражения JSONPath</strong></p><p>В AdGuard для Windows, Mac и Android <strong>с CoreLibs версии 1.11 или выше</strong> выражения JSONPath могут быть использованы как ключи в выражениях фильтра.</p><ul><li><code>||example.org^$jsonprune=\$.elems[?(has &quot;\$.a.b.c&quot;)]</code> удаляет всех прямых потомков <code>elems</code>, которые обладают свойством, выбираемым JSONPath-выражением <code>$.a.b.c</code>.</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>До</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;elems&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;k&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;f&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;k1&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>После</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;elems&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;d&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;f&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;k1&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><ul><li><code>||example.org^$jsonprune=\$.elems[?(key-eq &quot;\$.a.b.c&quot; &quot;abc&quot;)]</code> удаляет всех прямых потомков <code>elems</code>, которые обладают свойством, выбираемым выражением JSONPath <code>$.a.b.c</code> со значением, равным <code>&quot;abc&quot;</code>.</li></ul><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>До</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;elems&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>После</summary><div><div class="collapsibleContent_i85q"><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;elems&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Правила с <code>$jsonprune</code> совместимы с модификаторами <code>$domain</code>, <code>$third-party</code>, <code>$app</code>, <code>$important</code>, <code>$match-case</code> и <code>$xmlhttprequest</code>.</li><li><code>$jsonprune</code> rules do not apply if the size of the original response is more than 10 MB.</li></ul></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$jsonprune</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.10 или выше</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="network-modifier"><strong><code>$network</code></strong><a class="hash-link" href="#network-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>По сути, это правила типа Firewall, позволяющие полностью блокировать или разблокировать доступ к указанному удалённому адресу.</p><ol><li>Правила <code>$network</code> соответствуют <strong>только IP-адресам</strong>! Вы не можете использовать их, чтобы блокировать или разблокировать доступ к домену.</li><li>Чтобы сопоставить адрес IPv6, вы должны использовать сжатый синтаксис, например, использовать <code>[2001:4860:4860::8888]$network</code> вместо <code>[2001:4860:4860:0:0:0:0:8888]$network</code>.</li><li>An allowlist <code>$network</code> rule makes AdGuard bypass data to the matching endpoint, hence there will be no further filtering at all.</li><li>Если часть IP начинается и заканчивается символом <code>/</code>, она рассматривается как регулярное выражение.</li></ol><p>Рекомендуем ознакомиться с <a href="#regexp-support">этой статьёй</a> для лучшего понимания регулярных выражений.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Модификатор <code>$network</code> можно использовать в правилах только вместе с модификаторами <code>$app</code> и <code>$important</code>, но не с какими-либо другими модификаторами.</p></div></div><p><strong>Примеры</strong></p><ul><li><code>174.129.166.49:3478^$network</code> блокирует доступ к <code>174.129.166.49:3478</code> (но не к <code>174.129.166.49:34788</code>).</li><li><code>[2001:4860:4860::8888]:443^$network</code> блокирует доступ к <code>[2001:4860:4860::8888]:443</code>.</li><li><code>174.129.166.49$network</code> блокирует доступ к <code>174.129.166.49:*</code>.</li><li><code>@@174.129.166.49$network</code> заставляет AdGuard направлять трафик в конечную точку. Никакие другие правила применяться не будут.</li><li><code>/.+:3[0-9]{4}/$network</code> блокирует доступ к диапазанону портов 30000–39999.</li><li><code>/8.8.8.(:?8|4)/$network</code> блокирует доступ к <code>8.8.8.8</code> и к <code>8.8.8.4</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Только AdGuard для Windows, Mac и Android имеют технические возможности для поддержки правил с модификатором <code>$network</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="permissions-modifier"><strong><code>$permissions</code></strong><a class="hash-link" href="#permissions-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор полностью меняет поведение правила. Когда он применяется, правило не блокирует запрос. Вместо этого будут изменены заголовки ответа.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Чтобы использовать правила этого типа, необходимо базовое понимание слоя безопасности <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/Permissions_Policy" target="_blank" rel="noopener noreferrer">Feature Policy</a>.</p></div></div><p>Для запросов, соответствующих правилу <code>$permissions</code>, AdGuard усиливает «политику функций» ответа, добавляя дополнительную политику, равную содержимому модификатора <code>$permissions</code>. Правила <code>$permissions</code> применяются независимо от правил любого другого типа. <strong>Only document-level exceptions</strong> can influence it (see the examples section), but no other basic rules.</p><p><strong>Несколько правил, соответствующих одному запросу.</strong></p><p>В случае, когда несколько правил с <code>$permissions</code> соответствуют одному запросу, AdGuard применит каждое из них.</p><p><strong>Синтаксис</strong></p><p>Синтаксис значения <code>$permissions</code> подобен заголовку <code>Permissions-Policy</code> <a href="https://developer.mozilla.org/ru/docs/Web/HTTP/Permissions_Policy" target="_blank" rel="noopener noreferrer">синтаксису</a> с одним исключением: запятая, разделяющая несколько функций <strong>, ДОЛЖНА</strong> экранироваться — см. примеры ниже. Список доступных директив доступен <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy#directives" target="_blank" rel="noopener noreferrer">здесь</a>.</p><p>Значение <code>$permissions</code> может быть пустым в случае правил-исключений — смотрите примеры ниже.</p><p><strong>Примеры</strong></p><ul><li><code>||example.org^$permissions=autoplay=()</code> запрещает автовоспроизведение медиафайлов, запрашиваемых через интерфейс <code>HTMLMediaElement</code> на сайте <code>example.org</code>.</li><li><code>@@||example.org/page/*$permissions=autoplay=()</code> отключает все правила с модификатором <code>$permissions</code>, в точности соответствующим <code>autoplay=()</code> на всех страницах, подходящих под паттерн правила. Например, правило выше.</li><li><code>@@||example.org/page/*$permissions</code> отключает все <code>$permissions</code>-правила на всех страницах, подходящих под паттерн правила.</li><li><code>$domain=example.org|example.com,permissions=storage-access=()\, camera=()</code> запрещает использование Storage Access API для запроса доступа к неразмеченным куки, а также использование устройств видеоввода на сайтах <code>example.org</code> и <code>example.com</code>.</li><li><code>@@||example.org^$document</code> или <code>@@||example.org^$urlblock</code> отключает все <code>$permission</code>-правила на всех страницах, подходящих под паттерн правила.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ol><li>В модификаторе <code>$permissions</code> запрещён символ <code>$</code></li><li><code>$permissions</code> is compatible with three types of modifiers: <code>$domain</code>, <code>$important</code>, and <code>$subdocument</code></li></ol></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$permissions</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.11 или выше</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redirect-modifier"><strong><code>$redirect</code></strong><a class="hash-link" href="#redirect-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>AdGuard способен перенаправлять веб-запросы на локальный «ресурс».</p><p><strong>Синтаксис</strong></p><p>AdGuard использует тот же синтаксис правил фильтрации, что и uBlock Origin. Также он совместим с модификатором ABP <code>$rewrite=abp-resource</code>.</p><p><code>$redirect</code> — это модификатор для <a href="#basic-rules">базовых правил фильтрации</a>, поэтому правила с этим модификатором поддерживают остальные базовые модификаторы, такие как <code>$domain</code>, <code>$third-party</code>, <code>$script</code> и т. д.</p><p>Значение модификатора <code>$redirect</code> должно быть именем ресурса, который будет использован для переадресации.</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="отключение-правил-redirect">Отключение правил <code>$redirect</code><a class="hash-link" href="#отключение-правил-redirect" title="Прямая ссылка на заголовок">​</a></h5><ul><li><code>||example.org/script.js$script,redirect=noopjs</code> — это правило перенаправляет все запросы к <code>example.org/script.js</code> на ресурс с именем <code>noopjs</code>.</li><li><code>||example.org/test.mp4$media,redirect=noopmp4-1s</code> — это правило перенаправляет все запросы к <code>example.org/script.js</code> на ресурс с именем <code>noopmp4-1s</code>.</li><li><code>@@||example.org^$redirect</code> отключит все правила <code>$redirect</code> для URL-адресов, соответствующих <code>||example.org^</code>.</li><li><code>@@||example.org^$redirect=nooptext</code> отключит все правила с <code>$redirect=nooptext</code> для любого запроса, который соответствует <code>||example.org^</code>.</li></ul><p>Больше информации о редиректах и их использовании доступно <a href="https://github.com/AdguardTeam/Scriptlets#redirect-resources" target="_blank" rel="noopener noreferrer">на GitHub</a>.</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redirect-rule-priorities">Приоритеты правил <code>$redirect</code><a class="hash-link" href="#redirect-rule-priorities" title="Прямая ссылка на заголовок">​</a></h5><p>У правил с <code>$redirect</code> более высокий приоритет, чем у обычных базовых правил блокировки. Это означает, что если существует базовое правило блокировки, то правило <code>$redirect</code> будет его отменять. У правил белого списка с пометкой <code>@@</code> более высокий приоритет, чем у правил <code>$redirect</code>. Если базовое правило с модификатором <code>$important</code> и правило <code>$redirect</code> соответствуют одному и тому же URL-адресу, последнее переопределяется, если оно также не помечено как <code>$important</code>.</p><p><strong><code>$important</code> &gt; <code>@@</code> &gt; <code>$redirect</code> &gt; <code>базовые правила</code>.</strong></p><p>Перейдите к <a href="#rule-priorities">приоритетам правил</a> для более подробной информации.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Правила с модификатором <code>$redirect</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</li><li><code>$redirect</code> в uBlock Origin поддерживает указание приоритета, например, <code>$redirect=noopjs:42</code>. AdGuard не поддерживает его и вместо этого просто отбрасывает приоритетный постфикс.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redirect-rule-modifier"><strong><code>$redirect-rule</code></strong><a class="hash-link" href="#redirect-rule-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>По сути это другое имя <a href="#redirect-modifier"><code>$redirect</code></a>, поскольку он имеет те же значения «перенаправления» и почти аналогичную логику. Разница в том, что <code>$redirect-rule</code> применяется только в том случае, если целевой запрос заблокирован другим базовым правилом.</p><p>Перейдите <a href="#rule-priorities">к приоритетам правил</a> для более подробной информации.</p><p>Отключение <code>$redirect-rule</code> работает точно так же, как для обычных правил <code>$redirect</code>. Даже более того, <code>@@||example.org^$redirect</code> будет отключать как правило <code>$redirect</code>, так и <code>$redirect-rule</code>.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org/script.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$redirect-rule=noopjs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В этом случае только запросы к <code>example.org/script.js</code> будут перенаправлены на <code>noopjs</code>. Все остальные запросы к <code>example.org</code> останутся без изменений.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$redirect</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="referrerpolicy-modifier"><strong><code>$referrerpolicy</code></strong><a class="hash-link" href="#referrerpolicy-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Эти правила позволяют переопределить политику реферера страницы <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" target="_blank" rel="noopener noreferrer"></a>. В ответах на соответствующие запросы все заголовки <code>Referrer-Policy</code> заменит один заголовок со значением, равным значению модификатора правила сопоставления. Если ответ содержит HTML-документ с тегом <code>&lt;meta name=&quot;referrer&quot;...</code>, то атрибут <code>content</code> этого тега также будет заменён на значение модификатора.</p><p>Правило исключения со значением модификатора отключает правило блокировки с тем же значением. Правило исключения без значения модификатора отключает все совпадающие правила referrer-policy.</p><p>Если запрос соответствует нескольким правилам <code>$referrerpolicy</code>, не отключённым исключениями, то применяется только одно из них (какое именно — не уточняется). Правила <code>$referrerpolicy</code> без указанных <a href="#content-type-modifiers">модификаторов типа контента</a> применяются к типам контента <code>$document</code> и <code>$subdocument</code>.</p><p><strong>Примеры</strong></p><ul><li><code>||example.com^$referrerpolicy=unsafe-url</code> переопределяет политику referrer для <code>example.com</code> с <code>unsafe-url</code>.</li><li><code>@@||example.com^$referrerpolicy=unsafe-url</code> отключает предыдущее правило.</li><li><code>@@||example.com/abcd.html^$referrerpolicy</code> отключает все правила <code>$referrerpolicy</code> на <code>example.com/abcd.html</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$referrerpolicy</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.12 или выше</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="removeheader-modifier"><strong><code>$removeheader</code></strong><a class="hash-link" href="#removeheader-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Правила с модификатором <code>$removeheader</code> предназначены для того, чтобы убирать заголовки HTTP-запросов и ответов. Изначальная мотивация для создания этого типа правил заключалась в том, чтобы иметь возможность избавиться от заголовка <code>Refresh</code>, который часто используется для перенаправления пользователей на нежелательную страницу. Однако применение данного модификатора не ограничивается этим случаем.</p><p>Как и в случае с <code>$csp</code>, <code>$redirect</code>, <code>$removeparam</code> и <code>$cookie</code>, этот модификатор существует независимо, правила с ним не зависят от обычных базовых правил, то есть регулярные выражения или блокирующие правила никак на них не повлияют. По умолчанию они работают только применительно к заголовкам ответов. Но вы также можете изменить его, чтобы удалить заголовки из HTTP-запросов.</p><p><strong>Синтаксис</strong></p><p><strong>Базовый синтаксис</strong></p><ul><li><code>||example.org^$removeheader=header-name</code> убирает заголовок <strong>ответа</strong> с названием <code>header-name</code></li><li><code>||example.org^$removeheader=request:header-name</code> убирает заголовок <strong>запроса</strong> с названием <code>header-name</code></li></ul><p><code>$removeheader</code> нечувствителен к регистру, но мы настоятельно рекомендуем всегда использовать нижний регистр.</p><p><strong>Отрицание <code>$removeheader</code></strong></p><p>Этот тип правил работает почти так же, как и с модификаторами <code>$csp</code> и <code>$redirect</code>.</p><p>Используйте <code>@@</code>, чтобы отменить <code>$removeheader</code>:</p><ul><li><code>@@||example.org^$removeheader</code> отменяет <strong>все</strong> правила <code>$removeheader</code> для URL-адресов, соответствующих <code>||example.org^</code>.</li><li><code>@@||example.org^$removeheader=header</code> отменяет все правила с <code>$removeheader=header</code> для любого запроса, соответствующего <code>||example.org^</code>.</li></ul><p>Правила с <code>$removeheader</code> также можно отключить, используя правила-исключения <code>$document</code> и <code>$urlblock</code>. Но базовые правила-исключения без модификаторов не смогут этого сделать. Например, <code>@@||example.com^</code> не отключит <code>$removeheader=p</code> для запросов к <code>example.com</code>, а <code>@@||example.com^$urlblock</code> отключит.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>В случае, когда несколько правил с <code>$removeheader</code> соответствуют одному запросу, мы будем применять их все по очереди.</p></div></div><p><strong>Примеры</strong></p><ul><li><p>|<code>|example.org^$removeheader=refresh</code> убирает заголовок <code>Refresh</code> из всех HTTP-ответов, возвращённых <code>example.org</code> и его поддоменами.</p></li><li><p><code>||example.org^$removeheader=request:x-client-data</code> убирает заголовок <code>X-Client-Data</code> из всех HTTP-запросов.</p></li><li><p>Данный блок правил убирает заголовки <code>Refresh</code> и <code>Location</code> из всех HTTP-ответов, возвращённых <code>example.org</code>, кроме запросов к <code>example.org/path/*</code>, для которого заголовки не будут убраны:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$removeheader=refresh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$removeheader=location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org/path/$removeheader</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Этот тип правил может быть использован <a href="#trusted-filters"><strong>только в доверенных фильтрах</strong></a>.</p><ol><li><p>Чтобы избежать потенциальных проблем с безопасностью, <code>$removeheader</code> не может убрать следующие заголовки:</p><ul><li><code>access-control-allow-origin</code></li><li><code>access-control-allow-credentials</code></li><li><code>access-control-allow-headers</code></li><li><code>access-control-allow-methods</code></li><li><code>access-control-expose-headers</code></li><li><code>access-control-max-age</code></li><li><code>access-control-request-headers</code></li><li><code>access-control-request-method</code></li><li><code>origin</code></li><li><code>timing-allow-origin</code></li><li><code>allow</code></li><li><code>cross-origin-embedder-policy</code></li><li><code>cross-origin-opener-policy</code></li><li><code>cross-origin-resource-policy</code></li><li><code>content-security-policy</code></li><li><code>content-security-policy-report-only</code></li><li><code>expect-ct</code></li><li><code>feature-policy</code></li><li><code>origin-isolation</code></li><li><code>strict-transport-security</code></li><li><code>upgrade-insecure-requests</code></li><li><code>x-content-type-options</code></li><li><code>x-download-options</code></li><li><code>x-frame-options</code></li><li><code>x-permitted-cross-domain-policies</code></li><li><code>x-powered-by</code></li><li><code>x-xss-protection</code></li><li><code>public-key-pins</code></li><li><code>public-key-pins-report-only</code></li><li><code>sec-websocket-key</code></li><li><code>sec-websocket-extensions</code></li><li><code>sec-websocket-accept</code></li><li><code>sec-websocket-protocol</code></li><li><code>sec-websocket-version</code></li><li><code>p3p</code></li><li><code>sec-fetch-mode</code></li><li><code>sec-fetch-dest</code></li><li><code>sec-fetch-site</code></li><li><code>sec-fetch-user</code></li><li><code>referrer-policy</code></li><li><code>content-type</code></li><li><code>content-length</code></li><li><code>accept</code></li><li><code>accept-encoding</code></li><li><code>host</code></li><li><code>connection</code></li><li><code>transfer-encoding</code></li><li><code>upgrade</code></li></ul></li><li><p>Правила с <code>$removeheader</code> совместимы с модификаторами <code>$domain</code>, <code>$third-party</code>, <code>$app</code>, <code>$important</code>, <code>$match-case</code>, а также <a href="#content-type-modifiers">модификаторами типа контента</a>, такими как <code>$script</code> и <code>$stylesheet</code>. Правила с другими модификаторами считаются некорректными и не будут применены.</p></li></ol></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$removeheader</code> поддерживаются в AdGuard для Windows, Mac и Android, а также в Браузерном расширении AdGuard для Chrome, Firefox и Edge.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="removeparam-modifier"><strong><code>$removeparam</code></strong><a class="hash-link" href="#removeparam-modifier" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Модификатор <code>$removeparam</code> — это полный аналог модификатора <code>$queryprune</code>. Поскольку модификатор <code>$queryprune</code> считается устаревшим, рекомендуем везде использовать только модификатор <code>$removeparam</code>.</p></div></div><p>Правила с модификатором <code>$removeparam</code> предназначены для того, чтобы убирать параметры запроса из URL-адресов. Такие правила применяются только к запросам типов <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code> и иногда к <code>POST</code>.</p><p>Правила с модификатором <code>$removeparam</code>, не содержащие <a href="#content-type-modifiers">модификаторов типа контента</a>, будут соответствовать только тем запросам, которые имеют тип контента <code>document</code>.</p><p><strong>Синтаксис</strong></p><p><strong>Базовый синтаксис</strong></p><ul><li><code>$removeparam=param</code> убирает параметр запроса с именем <code>param</code> из URL любого запроса. Например, запрос к <code>http://example.com/page?param=1&amp;&amp;another=2</code> будет преобразован в <code>http://example.com/page?another=2</code>.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$removeparam</code> поддерживаются в AdGuard для Windows, Mac и Android с <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">CoreLibs версии 1.7 или выше</a> и в Браузерном расширении AdGuard версии 3.6 или выше.</p></div></div><p><strong>Регулярные выражения</strong></p><p>Вы также можете использовать регулярные выражения, чтобы выбрать нужные параметры запроса или их значения:</p><ul><li><code>$removeparam=/regexp/[options]</code> убирает из URL-адреса любого запроса все параметры, соответствующие заданному регулярному выражению <code>regexp</code>. В отличие от базового синтаксиса, это означает <em>«‎убрать параметры запроса, нормализованные к строке <code>name=value</code>, которая соответствует <code>регулярному выражению</code>»</em>. <code>[options]</code> — это список опций регулярного выражения. На данный момент единственная поддерживаемая опция — это <code>i</code>, делающая соответствие нечувствительным к регистру.</li></ul><p><strong>Экранирование специальных символов</strong></p><p>Не забывайте экранировать специальные символы, такие как <code>,</code>, <code>/</code> и <code>$</code> в регулярных выражениях. Используйте для этого символ <code>\</code>. Например, экранированная запятая должна выглядеть так: <code>\,</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Правила с регулярными выражениями смотрят как на название, так и на значение параметра. Чтобы свести к минимуму ошибки, рекомендуем начинать регулярное выражение с <code>/^</code>, если только вы не хотите специально работать со значениями параметров.</p></div></div><p>Мы стараемся обнаруживать и игнорировать неэкранированные символы <code>$</code> автоматически. По умолчанию не считаем символ разделителем, если верны три условия:</p><ol><li>Есть сочетание <code>$/</code></li><li>Слева от символа есть ещё один слеш <code>/</code></li><li>Слева от этого слеша есть ещё один неэкранированный символ <code>$</code></li></ol><p><strong>Удалить параметры запроса</strong></p><p>Укажите «‎голый» <code>$removeparam</code>, чтобы удалить все параметры запроса:</p><ul><li><code>||example.org^$removeparam</code> удаляет все параметры запроса из URL-адресов, соответствующих правилу <code>||example.org^</code>.</li></ul><p><strong>Инверсия</strong></p><p>Используйте <code>~</code>, чтобы применить инверсию:</p><ul><li><code>$removeparam=~param</code> удаляет все параметры запроса, кроме <code>param</code>.</li><li><code>$removeparam=~/regexp/</code> удаляет все параметры запроса, которые не совпадают с заданным регулярным выражением <code>regexp</code>.</li></ul><p><strong>Исключение правил с <code>$removeparam</code></strong></p><p>Этот тип правил работает практически так же, как и в случае с модификаторами <a href="#csp-modifier"><code>$csp</code></a> и <a href="#redirect-modifier"><code>$redirect</code></a>.</p><p>Используйте <code>@@</code>, чтобы исключить правило с <code>$removeparam</code>:</p><ul><li><code>@@||example.org^$removeparam</code> не даёт применять правила с <code>$removeparam</code> для URL, соответствующих <code>example.org</code>.</li><li><code>@@||example.org^$removeparam=param</code> не даёт применять правила с <code>$removeparam=param</code> для запросов к <code>example.org</code>.</li><li><code>@@||example.org^$removeparam=/regexp/</code> не даёт применять правила с <code>$removeparam=/regexp/</code> для запросов к <code>example.org</code>.</li></ul><p><strong>Несколько правил, соответствующих одному запросу</strong></p><p>В случае, когда несколько правил с <code>$removeparam</code> соответствуют одному запросу, они все будут применены по очереди.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$removeparam=/^(utm_source|utm_medium|utm_term)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$removeparam=/^(utm_content|utm_campaign|utm_referrer)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.com^$removeparam</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>С помощью этих правил некоторые <a href="https://en.wikipedia.org/wiki/UTM_parameters" target="_blank" rel="noopener noreferrer">параметры UTM</a> будут удалены из любого запроса, за исключением запросов к <code>example.com</code>, которые не будут удалены вообще. Например, <code>http://google.com/page?utm_source=s&amp;utm_referrer= fb.com&amp;utm_content=img</code> будет преобразован в <code>http://google.com/page</code>, но на <code>http://example.com/page?utm_source=s&amp;utm_referrer=fb.com&amp;utm_content=img</code> правило блокировки не повлияет.</p><ul><li><p><code>$removeparam=utm_source</code> удаляет параметр <code>utm_source</code> из всех запросов.</p></li><li><p><code>$removeparam=/utm_.*/</code> удаляет все параметры <code>utm_*</code> из URL любого запроса. Например, запрос <code>http://example.com/page?utm_source=test</code> будет трансформирован в <code>http://example.com/page</code>.</p></li><li><p><code>$removeparam=/^utm_source=campaign$/</code> удаляет параметр <code>utm_source</code> со значением <code>campaign</code>. Не затрагивает другие параметры <code>utm_source</code>.</p></li></ul><p><strong>Исключение правила с <code>$removeparam</code> и замена его другим</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$removeparam=/^(gclid|yclid|fbclid)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.com^$removeparam=/^(gclid|yclid|fbclid)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.com^$removeparam=/^(yclid|fbclid)=/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Эти правила удаляют Click ID Google, Яндекса и Facebook. Есть одно исключение: Google Click ID (gclid) не будет удалён из запросов к example.com.</p><p><strong>Исключение правила с <code>$removeparam</code> для всех параметров</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$removeparam=/^(utm_source|utm_medium|utm_term)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$removeparam=/^(utm_content|utm_campaign|utm_referrer)=/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.com^$removeparam</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Эти правила удаляют указанные UTM-параметры из всех запросов, кроме запросов к <code>example.org</code>.</p><p>Правила с <code>$removeparam</code> также можно отключить с помощью правил исключений с <code>$document</code> и <code>$urlblock</code>. Но базовые правила исключений без модификаторов не могут этого сделать. Например, <code>@@||example.com^</code> не отключит <code>$removeparam=p</code> для запросов к <strong>example.com</strong>, а вот <code>@@||example.com^$urlblock</code> — отключит.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><ul><li>Правила с модификатором <code>$removeparam</code> могут быть использованы <a href="#trusted-filters"><strong>только в доверенных фильтрах</strong></a>.</li><li>Правила с <code>$removeparam</code> совместимы с <a href="#basic-rules-basic-modifiers">базовыми модификаторами</a>, <a href="#content-type-modifiers">модификаторами типа контента</a>, а также с модификаторами <code>$important</code> и <code>$app</code>. Правила с любыми другими модификаторами считаются некорректными и не будут применены.</li></ul></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Правила с модификатором <code>$removeparam</code> поддерживаются в AdGuard для Windows, Mac и Android и Браузерном расширении AdGuard для Chrome, Firefox и Edge.</li><li>Синтаксис регулярных выражений <code>$removeparam</code> поддерживается в Браузерном расширении AdGuard 4.0 и в AdGuard для Windows, Mac и Android, <strong>с CoreLibs версии 1.8 или выше</strong>.</li><li>Типы запросов <code>POST</code> поддерживаются только в AdGuard для Windows, Mac и Android <a href="https://adguard.com/en/blog/introducing-corelibs.html" target="_blank" rel="noopener noreferrer">с CoreLibs версии 1.10 или выше</a>.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="replace-modifier"><strong><code>$replace</code></strong><a class="hash-link" href="#replace-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Этот модификатор полностью меняет поведение страницы. Когда он применяется, правило не блокирует запрос. Вместо этого ответ модифицируется.</p><p>Вам потребуется знание регулярных выражений, чтобы использовать модификатор <code>$replace</code>.</p><p><strong>Функции</strong></p><ul><li>Правила с <code>$replace</code> применяются к любому текстовому ответу, но не применяются к binary (<code>media</code>, <code>image</code>, <code>object</code> и т. д.).</li><li><code>$replace</code> rules do not apply if the size of the original response is more than 10 MB.</li><li>Правила с <code>$replace</code> обладают более высоким приоритетом, чем другие базовые правила (<strong>включая</strong> правила исключений). Если запрос соответствует двум различным правилам, одно из которых имеет модификатор <code>$replace</code>, применится именно это правило.</li><li>Правила исключений уровня document с модификаторами <code>$content</code> или <code>$document</code> отменяют срабатывание правил <code>$replace</code>, даже если запрос им соответствует.</li><li>Прочие правила исключений уровня document (с модификаторами <code>$generichide</code>, <code>$elemhide</code> или <code>$jsinject</code>) применяются вместе с правилами <code>$replace</code>. Это означает, что вы можете изменять содержимое страницы при помощи правила <code>$replace</code> и одновременно отменять косметические правила.</li></ul><p>Значение <code>$replace</code> может быть пустым в случае правил исключений. Более подробную информацию вы найдёте в разделе с примерами.</p><p><strong>Несколько правил, соответствующих одному запросу</strong></p><p>В случае, когда несколько правил <code>$replace</code> соответствуют одному запросу, мы применим каждое из них. <strong>Правила будут применяться в алфавитном порядке.</strong></p><p><strong>Синтаксис</strong></p><p>В целом синтаксис <code>$replace</code> аналогичен замене регулярными выражениями <a href="http://perldoc.perl.org/perlrequick.html#Search-and-replace" target="_blank" rel="noopener noreferrer">в Perl</a>.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">replace = &quot;/&quot; regexp &quot;/&quot; replacement &quot;/&quot; modifiers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>regexp</code></strong> — регулярное выражение.</li><li><strong><code>replacement</code></strong> — строка, которая будет использована для замены строки в соответствии с <code>regexp</code>.</li><li><strong><code>modifiers </code></strong> — флаги регулярных выражений. Например, <code>i</code> — поиск без учёта регистра, или <code>s</code> — режим одной строки.</li></ul><p>В значении <code>$replace</code> необходимо экранировать два символа: запятую <code>,</code> и знак доллара <code>$</code>. Используйте для этого обратный слеш <code>\</code>. Например, экранированная запятая будет выглядеть так: <code>\,</code>.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$replace=/(&lt;VAST[\s\S]*?&gt;)[\s\S]*&lt;\/VAST&gt;/\$1&lt;\/VAST&gt;/i</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>У этого правила три части:</p><ul><li><code>regexp</code> (регулярное выражение) — <code>(&lt;VAST(.|\s)*?&gt;)(.|\s)*&lt;\/VAST&gt;</code></li><li><code>replacement</code> (замена) — <code>\$1&lt;\/VAST&gt;</code> где <code>$</code> экранируется</li><li><code>modifiers</code> (флаги регулярных выражений) — <code>i</code> для поиска без учёта регистра</li></ul><p>Здесь вы можете увидеть, как работает это правило: <a href="http://regexr.com/3cesk" target="_blank" rel="noopener noreferrer">http://regexr.com/3cesk</a></p><p><strong>Несколько правил с <code>$replace</code></strong></p><ol><li><code>||example.org^$replace=/X/Y/</code></li><li><code>||example.org^$replace=/Z/Y/</code></li><li><code>@@||example.org/page/*$replace=/Z/Y/</code></li></ol><ul><li>Правила 1 и 2 будут применены ко всем запросам, отправленным к <code>example.org</code>.</li><li>Правило 2 отключено для запросов, соответствующих <code>||example.org/page/</code>, <strong>но правило 1 при этом всё равно работает!</strong></li></ul><p><strong>Отключение правил с <code>$replace</code></strong></p><ul><li><code>@@||example.org^$replace</code> отключит все правила с <code>$replace</code>, где есть <code>||example.org^</code>.</li><li><code>@@||example.org^$document</code> или <code>@@||example.org^$content</code> отключит все правила с <code>$replace</code>, <strong>исходящие</strong> со страниц домена <code>example.org</code>, <strong>включая саму эту страницу</strong>.</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$replace</code> могут быть использованы <a href="#trusted-filters"><strong>только в доверенных фильтрах</strong></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$replace</code> поддерживаются в AdGuard для Windows, Mac и Android и Браузерном расширении AdGuard для Firefox. Другие расширения не могут модифицировать содержимое страниц на сетевом уровне, поэтому там эти правила не работают.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="noop-modifier"><strong><code>noop</code></strong><a class="hash-link" href="#noop-modifier" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>noop</code> не делает ничего и используется только для того, чтобы улучшить читаемость правил. Он состоит из последовательности символов нижнего подчёркивания (<code>_</code>) любой длины и может фигурировать в правиле столько раз, сколько требуется.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">||example.com$_,removeparam=/^ss\\$/,_,image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.com$replace=/bad/good/,___,~third-party</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>noop</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="empty-modifier"><strong><code>$empty</code> (устаревший)</strong><a class="hash-link" href="#empty-modifier" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>Этот модификатор считается устаревшим. Вместо него теперь используется <a href="#redirect-modifier">модификатор <code>$redirect</code></a>. Правила с <code>$empty</code> всё ещё поддерживаются и преобразуются в <code>$redirect=nooptext</code>, но в будущем перестанут поддерживаться.</p></div></div><p>Обычно заблокированный запрос выглядит для браузера как ошибка сервера. В случае применения модификатора <code>$empty</code> AdGuard эмулирует пустой ответ сервера со статусом <code>200 OK</code>.</p><p><strong>Примеры</strong></p><ul><li><code>||example.org^$empty</code> возвращает пустой ответ для всех запросов к домену <code>example.org</code> и всех его поддоменов.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$empty</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mp4-modifier"><strong><code>$mp4</code> (устаревший)</strong><a class="hash-link" href="#mp4-modifier" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>Этот модификатор считается устаревшим. Вместо него теперь используется <a href="#redirect-modifier">модификатор <code>$redirect</code></a>. Правила с <code>$mp4</code> всё ещё поддерживаются и преобразуются в <code>$redirect=noopmp4-1s,media</code>, но в будущем перестанут поддерживаться.</p></div></div><p>В качестве ответа на заблокированный запрос AdGuard возвращает короткую видео-заглушку.</p><p><strong>Примеры</strong></p><ul><li><code>||example.com/videos/$mp4</code> блокирует загрузку видео с адресов <code>||example.com/videos/*</code> и заменяет ответ на видео-заглушку.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$mp4</code> не поддерживаются в AdGuard Content Blocker, AdGuard для iOS и AdGuard для Safari.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rule-priorities">Приоритеты правил<a class="hash-link" href="#rule-priorities" title="Прямая ссылка на заголовок">​</a></h3><p>Каждое правило имеет свой приоритет, что необходимо, когда запросу соответствует несколько правил и фильтрующий механизм должен выбрать одно из них. Приоритет измеряется целым положительным числом.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Конфликты</div><div class="admonitionContent_S0QG"><p>Если два правила с одинаковым приоритетом соответствуют одному и тому же запросу, то от реализации механизма фильтрации зависит, какое из них будет выбрано.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Концепция приоритетов правил становится всё более важной в свете Manifest V3, поскольку существующие правила должны быть преобразованы в правила declarativeNetRequest.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-calculation">Priority calculation<a class="hash-link" href="#priority-calculation" title="Прямая ссылка на заголовок">​</a></h4><p>Для расчёта приоритета мы разделили модификаторы на разные группы. Эти группы ранжируются по степени приоритетности, от низшей к высшей. Модификатор, существенно сужающий область действия правила, увеличивает вес его общего приоритета. И наоборот, если правило применяется к более широкому кругу запросов, то его приоритет снижается.</p><p>Следует отметить, что существуют случаи, когда модификатор с одним параметром имеет более высокий приоритет, чем тот, у которого много параметров. Например, в случае <code>$domain=example.com|example.org</code>правило, включающее два домена, имеет несколько более широкую область действия, чем правило с одним указанным доменом, поэтому его приоритет ниже.</p><p>Базовый приоритет любого правила равен 1. Если вычисленный приоритет — число с плавающей точкой, то оно будет <strong>округлено в большую сторону</strong> до наименьшего целого числа, большего или равного вычисленному приоритету.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><ul><li>Понятие приоритета было введено в tsurlfilter 2.1.0 и CoreLibs 1.13. До этого в AdGuard не было специального алгоритма вычисления приоритетов, и обработка конфликтов могла отличаться в зависимости от продукта и версии AdGuard.</li><li>AdGuard для iOS, Safari и AdGuard Content Blocker зависят от реализации браузера и не могут следовать указанным здесь правилам.</li></ul></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Псевдонимы-модификаторы (<code>1p</code>, <code>3p</code> и т. д.) не входят в эти категории, однако, они используются в движке для вычисления приоритета правила.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-1">Базовые модификаторы, наличие каждого добавляет 1 к приоритету<a class="hash-link" href="#priority-category-1" title="Прямая ссылка на заголовок">​</a></h4><ul><li><a href="#app-modifier"><code>$app</code></a> с приложениями, исключаемыми с помощью <code>~</code></li><li><a href="#denyallow-modifier"><code>$denyallow</code></a></li><li><a href="#domain-modifier"><code>$domain</code></a> с доменами, исключаемыми с помощью <code>~</code></li><li><a href="#match-case-modifier"><code>$match-case</code></a></li><li><a href="#method-modifier"><code>$method</code></a> с методами, исключаемыми с помощью <code>~</code></li><li><a href="#third-party-modifier"><code>$third-party</code></a></li><li><a href="#to-modifier"><code>$to</code></a></li><li>ограниченные модификаторы <a href="#content-type-modifiers">сontent-type</a> с <code>~</code></li></ul><p>При работе с исключаемым доменом, приложением, методом или типом содержимого мы добавляем <strong>1 балл</strong> за существование самого модификатора, независимо от количества исключаемых доменов или типов содержимого. Это связано с тем, что область действия правила и так бесконечно широка. Проще говоря, запрещая несколько доменов, модификаторов content-type, методов или приложений, мы лишь немного сужаем область действия правила.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-2">Определённые модификаторы content-type, методы, заголовки, $popup, специальные исключения<a class="hash-link" href="#priority-category-2" title="Прямая ссылка на заголовок">​</a></h4><p>Все разрешённые типы контента:</p><ul><li><a href="#document-modifier"><code>$document</code></a></li><li><a href="#font-modifier"><code>$font</code></a></li><li><a href="#image-modifier"><code>$image</code></a></li><li><a href="#media-modifier"><code>$media</code></a></li><li><a href="#object-modifier"><code>$object</code></a></li><li><a href="#other-modifier"><code>$other</code></a></li><li><a href="#ping-modifier"><code>$ping</code></a></li><li><a href="#script-modifier"><code>$script</code></a></li><li><a href="#stylesheet-modifier"><code>$stylesheet</code></a></li><li><a href="#subdocument-modifier"><code>$subdocument</code></a></li><li><a href="#websocket-modifier"><code>$websocket</code></a></li><li><a href="#xmlhttprequest-modifier"><code>$xmlhttprequest</code></a></li></ul><p>Это также включает правила, которые неявно добавляют модификатор <code>$document</code>:</p><ul><li><a href="#popup-modifier"><code>$popup</code></a></li></ul><p>Или специальные исключения, которые неявно добавляют <code>$document,subdocument</code>:</p><ul><li><a href="#content-modifier"><code>$content</code></a></li><li><a href="#elemhide-modifier"><code>$elemhide</code></a></li><li><a href="#extension-modifier"><code>$extension</code></a></li><li><a href="#genericblock-modifier"><code>$genericblock</code></a></li><li><a href="#generichide-modifier"><code>$generichide</code></a></li><li><a href="#jsinject-modifier"><code>$jsinject</code></a></li><li><a href="#specifichide-modifier"><code>$specifichide</code></a></li><li><a href="#urlblock-modifier"><code>$urlblock</code></a></li></ul><p>Или методы, разрешённые модификатором <a href="#method-modifier"><code>$method</code></a>.</p><p>Или правила с <a href="#header-modifier"><code>$header</code></a>.</p><p>Наличие любых модификаторов content-type добавляет <code>(50 + 50 / N)</code>, где <code>N</code> — количество модификаторов, например: <code>||example.com^$image,script</code> добавит <code>50 + 50 / 2 = 50 + 25 = 75</code> к общему весу правила. К этой категории относится и <code>$popup</code>, так как в нём неявно добавляется модификатор <code>$document</code>. Аналогично, конкретные исключения добавляют <code>$document,subdocument</code>.</p><p>Если в правиле есть модификатор <code>$method</code> с разрешёнными методами, то он добавляет <code>(50 + 50 / N)</code>, где <code>N</code> — количество разрешённых методов, например: <code>||example.com^$method=GET|POST|PUT</code> добавит <code>50 + 50 / 3 = 50 + 16,6 = 67</code> к общему весу правила.</p><p>Если в правиле есть модификатор <code>$header</code>, то он добавляет <code>50</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-3"><code>$domain</code> или <code>$app</code> с разрешёнными доменами или приложениями<a class="hash-link" href="#priority-category-3" title="Прямая ссылка на заголовок">​</a></h4><p>Домены или приложения, указанные с помощью <code>$domain</code> и <code>$app</code> соответственно, добавят <code>100 + 100 / N</code>, где <code>N</code> — количество значений модификатора, например: <code>||example.com^$domain=example.com|example.org|example.net</code> добавит <code>100 + 100 / 3 = 135</code> или <code>||example.com^$app=org.example.app1|org.example.app2</code> добавит <code>100 + 100 / 2 = 100 + 51 = 151</code> или <code>||example.com^$domain=example.com,app=org.example.app1|org.example.app2</code> добавит <code>100 + 100/1</code> (часть $domain) и <code>100 + 100/2</code> (часть $app) — в сумме <code>350</code>.</p><p>Значения модификаторов regexps или tld будут интерпретироваться как обычные записи вида <code>example.com</code> и считаться по одному, например: <code>||example.com^$domain=example.*</code> будет добавлено <code>100 + 100 / 1 = 200</code> или <code>||example.com^$domain=example.*|adguard.*</code> будет добавлено <code>100 + 100 / 2 = 150</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-6">Правила <code>$redirect</code><a class="hash-link" href="#priority-category-6" title="Прямая ссылка на заголовок">​</a></h4><ul><li><a href="#redirect-modifier"><code>$redirect</code></a>,</li><li><a href="#redirect-rule-modifier"><code>$redirect-rule</code></a>.</li></ul><p>Каждое из них добавляет <code>10^3</code> к приоритету правила.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-4">Особые исключения<a class="hash-link" href="#priority-category-4" title="Прямая ссылка на заголовок">​</a></h4><ul><li><a href="#content-modifier"><code>$content</code></a></li><li><a href="#elemhide-modifier"><code>$elemhide</code></a></li><li><a href="#extension-modifier"><code>$extension</code></a></li><li><a href="#genericblock-modifier"><code>$genericblock</code></a></li><li><a href="#generichide-modifier"><code>$generichide</code></a></li><li><a href="#jsinject-modifier"><code>$jsinject</code></a></li><li><a href="#specifichide-modifier"><code>$specifichide</code></a></li><li><a href="#urlblock-modifier"><code>$urlblock</code></a></li></ul><p>Каждое из них добавляет <code>10^4</code> к приоритету.</p><p>Исключение с модификатором <a href="#document-modifier"><code>$document</code></a> в том числе: это псевдоним для <code>$elemhide, content,jsinject,urlblock,extension</code>. Оно добавит <code>10^4</code> для каждого модификатора из <a href="#priority-category-4">верхнего списка</a>, <code>10^4 * 5</code> в сумме.</p><p>Кроме того, каждое из этих исключений неявно добавляет два разрешённых модификатора типа контента: <code>$document,subdocument</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-5">Правила белого списка<a class="hash-link" href="#priority-category-5" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <code>@@</code> добавляет <code>10^5</code> к приоритету правила.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-7">Правила <code>$important</code><a class="hash-link" href="#priority-category-7" title="Прямая ссылка на заголовок">​</a></h4><p>Модификатор <a href="#important-modifier"><code>$important</code></a> добавляет <code>10^6</code> к приоритету правила.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="priority-category-extra">Правила, для которых нет веса приоритета<a class="hash-link" href="#priority-category-extra" title="Прямая ссылка на заголовок">​</a></h4><p><a href="#advanced-capabilities">Прочие модификаторы</a>, которые должны выполнять дополнительную пост- или предобработку запросов, ничего не добавляют к приоритету правил.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Модификатор <a href="#replace-modifier"><code>$replace</code></a> имеет приоритет над всеми блокирующими правилами категорий 1–3, а также над правилами исключений из категорий 3–5, <strong>, кроме</strong> <a href="#content-modifier"><code>$content</code></a>, поскольку исключение с модификатором <code>$content</code> отменяет все правила <code>$replace</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="примеры-1">Примеры<a class="hash-link" href="#примеры-1" title="Прямая ссылка на заголовок">​</a></h4><p><strong>Пример 1</strong></p><p><code>||example.com^</code></p><p>Вес правила без модификаторов: <code>1</code>.</p><p><strong>Пример 2</strong></p><p><code>||example.com^$match-case</code></p><p>Вес правила: базовый вес + вес модификатора из <a href="#priority-category-1">категории 1</a>: <code>1 + 1 = 2</code>.</p><p><strong>Пример 3</strong></p><p><code>||example.org^$removeparam=p</code></p><p>Вес правила: базовый вес + 0, так как $removeparam <a href="#priority-category-extra">не участвует</a> в расчёте приоритета: <code>1 + 0 = 1</code>.</p><p><strong>Пример 4</strong></p><p><code>||example.org^$document,redirect=nooptext</code></p><p>Вес правила: базовый вес + допустимый тип содержимого, <a href="#priority-category-3">категория 3</a> + $redirect из <a href="#priority-category-6">категория 6</a>: <code>1 + (100 + 100 / 1) + 1000 = 1201</code>.</p><p><strong>Пример 5</strong></p><p><code>@@||example.org^$removeparam=p,document</code></p><p>Вес правила: базовый вес + правило белого списка, <a href="#priority-category-5">категория 5</a> + 0, потому что $removeparam <a href="#priority-category-extra">не участвует</a> в расчёте приоритета + разрешённый тип контента, <a href="#priority-category-2">категория 2</a>: <code>1 + 10000 + 0 + (50 + 50 / 1) = 10101</code>.</p><p><strong>Пример 6</strong></p><p><code>@@||example.com/ad/*$domain=example.org|example.net,important</code></p><p>Вес правила: базовый вес + правило белого списка, <a href="#priority-category-5">категория 5</a> + важное правило, <a href="#priority-category-7">категория 7</a> + разрешённые домены, <a href="#priority-category-3">категория 3</a>: <code>1 + 10000 + 1000000 + (100 + 100 / 2) = 1010152</code>.</p><p><strong>Пример 7</strong></p><p><code>@@||example.org^$document</code> без дополнительных модификаторов — это псевдоним для <code>@@|||example.com^$elemhide,content,jsinject,urlblock,extension</code></p><p>Вес правила: базовый вес + специфические исключения, <a href="#priority-category-4">категория 4</a> + два разрешённых типа контента (document и subdocument), <a href="#priority-category-2">категория 2</a>: <code>1 + 10000 * 4 + (50 + 50 / 2) = 40076</code>.</p><p><strong>Пример 8</strong></p><p><code>*$script,domain=a.com,denyallow=x.com|y.com</code></p><p>Вес правила: базовый вес + разрешённый тип контента, <a href="#priority-category-2">категория 2</a> + разрешённый домен, <a href="#priority-category-3">категория 3</a> + отказ, <a href="#priority-category-1">категория 1</a>: <code>1 + (50 + 50/1) + (100 + 100 / 1) + 1 = 303</code>.</p><p><strong>Пример 9</strong></p><p><code>||example.com^$all</code> (псевдоним для <code>||example.com^$document,subdocument,image,script,media и т.д. + $popup</code>)</p><p>Вес правила: базовый вес + разрешённые типы контента, <a href="#priority-category-2">категория 2</a>: <code>1 + (50 + 50 / 12) = 55</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-rules">Другие правила<a class="hash-link" href="#non-basic-rules" title="Прямая ссылка на заголовок">​</a></h2><p>Базовых правил может быть недостаточно для блокировки рекламы. Иногда для этого требуется скрыть какой-нибудь элемент или изменить часть HTML-кода страницы, при этом ничего не сломав. Для этого предназначены правила, описанные в данном разделе.</p><table><thead><tr><th>Категории \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#cosmetic-elemhide-rules">Скрытие элементов</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td></tr><tr><td><a href="#cosmetic-css-rules">CSS-правила</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#extended-css-selectors">Расширенный CSS</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#html-filtering-rules">Фильтрация HTML</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#javascript-rules">JavaScript</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#scriptlets">Скриптлеты</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>❌ — не поддерживается</li></ul></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cosmetic-rules">Косметические правила<a class="hash-link" href="#cosmetic-rules" title="Прямая ссылка на заголовок">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>информация</div><div class="admonitionContent_S0QG"><p>Для работы с косметическими правилами необходимы знания HTML и CSS. Если вы хотите научиться самостоятельно составлять такие правила, ознакомьтесь <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_started/What_is_CSS" target="_blank" rel="noopener noreferrer">с документацией</a>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cosmetic-elemhide-rules">Правила скрытия элементов<a class="hash-link" href="#cosmetic-elemhide-rules" title="Прямая ссылка на заголовок">​</a></h3><p>Правила скрытия элементов предназначены, как это следует из их названия, для скрытия элементов веб-страниц. По сути это аналогично применению стиля <code>{ display: none; }</code> к выбранному элементу.</p><p>Правила скрытия элементов работают по-разному, и их приоритет меняется <a href="#cosmetic-rules-priority">в зависимости от платформы</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="синтаксис">Синтаксис<a class="hash-link" href="#синтаксис" title="Прямая ссылка на заголовок">​</a></h4><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   rule = [domains] &quot;##&quot; selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domains = [domain0, domain1[, ...[, domainN]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>selector</code></strong> — <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors" target="_blank" rel="noopener noreferrer">CSS-селектор</a>, задающий элементы, которые должны быть скрыты.</li><li><strong><code>domains</code></strong> — ограничение на домены, на страницах которых будет применено правило.</li></ul><p>Если вы хотите ограничить область действия одним или более доменами, просто перечислите их через запятую. Например: <code>example.org,example.com##selector</code>.</p><p>Это правило будет работать также на всех поддоменах <code>example.org</code> и <code>example.com</code>.</p><p>Если вы хотите, чтобы правило не применялось к определённым доменам, начните доменное имя со знака <code>~</code>. Например: <code>~example.org##selector</code>.</p><p>Вы можете использовать оба подхода в одном правиле. Например, правило <code>example.org,~subdomain.example.org##domain</code> будет работать для домена <code>example.org</code> и всех его поддоменов, <strong>кроме <code>subdomain.example.org</code></strong>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Правила скрытия не зависят друг от друга. Если в фильтре есть правило <code>example.org##selector</code> и вы добавляете правило <code>~example.org##selector</code>, то оба этих правила будут применены независимо друг от друга.</p></div></div><p><strong>Примеры</strong></p><ul><li><code>example.com##div.textad</code> — hides a <code>div</code> with the class <code>textad</code> at <code>example.com</code> and all subdomains.</li><li><code>example.com,example.org###adblock</code> скроет элемент с атрибутом <code>id</code> равным <code>adblock</code> на доменах <code>example.com</code>, <code>example.org</code> и всех их поддоменах.</li><li><code>~example.com##.textad</code> — hides an element with the class <code>textad</code> at all domains, except <code>example.com</code> and its subdomains.</li></ul><p><strong>Ограничения</strong></p><p>Safari не поддерживает одновременно разрешённые и запрещённые домены, поэтому правила вида <code>example.org,~foo.example.org##.textad</code> не работают в AdGuard для Safari.</p><p><strong>Исключения</strong></p><p>Исключения могут отключать некоторые правила на определённых доменах. Они очень похожи на обычные правила-исключения, только вместо <code>##</code> нужно использовать <code>#@#</code>.</p><p>Например, в фильтре есть правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">##.textad</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если вы хотите отключить его для домена <code>example.com</code>, вы можете создать правило исключения:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com#@#.textad</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В некоторых случаях может потребоваться отключение всех запрещающих правил. Например, на время тестирования. Для этого воспользуйтесь правилом исключения без указания домена. Это полностью отключит соответствующее правило CSS elemhide для ВСЕХ доменов:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#@#.textad</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Правило такого вида даст аналогичный результат:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*#@#.textad</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Применять такие исключения рекомендуется только в случае, когда изменить само правило скрытия невозможно. Во всех остальных случаях лучше изменить исходное правило, используя ограничение на домены.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cosmetic-css-rules">CSS-правила<a class="hash-link" href="#cosmetic-css-rules" title="Прямая ссылка на заголовок">​</a></h3><p>Иногда недостаточно просто скрыть какой-либо элемент, чтобы заблокировать рекламу. Например, блокировка рекламного элемента может просто сломать вёрстку сайта. Для таких случаев AdGuard позволяет использовать гораздо более гибкие правила, чем обычные правила скрытия. With these rules you can basically add any CSS styles to the page.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   rule = [domains] &quot;#$#&quot; selector &quot;{&quot; style &quot;}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domains = [domain0, domain1[, ...[, domainN]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>selector</code></strong> — <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors" target="_blank" rel="noopener noreferrer">CSS-селектор</a>, определяющий элементы, к которым мы хотим применить стиль.</li><li><strong><code>domains</code></strong> — ограничение на домены, на страницах которых будет применено правило. Строится по тем же правилам, что и в случае <a href="#cosmetic-elemhide-rules">правил скрытия элементов</a>.</li><li><strong><code>style</code></strong> — CSS-стиль, который мы хотим применить к выбранным элементам.</li></ul><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com#$#body { background-color: #333!important; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это правило применит стиль <code>background-color: #333!important;</code> к элементу <code>body</code> для домена <code>example.com</code> и всех его поддоменов.</p><p><strong>Исключения</strong></p><p>По аналогии с правилами скрытия существует специальный тип правил, отключающий действие выбранного правила CSS-стилей для определённых доменов. Синтаксис правил-исключений практически такой же, только маркер <code>#$#</code> заменяется на <code>#@$#</code>.</p><p>Например, в фильтре есть правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#$#.textad { visibility: hidden; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если вы хотите отключить его для домена <code>example.com</code>, вы можете создать правило исключения:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com#@$#.textad { visibility: hidden; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Применять такие исключения рекомендуется только в случае, когда невозможно изменить само CSS-правило. Во всех остальных случаях лучше изменить исходное правило, используя ограничение на домены.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Запрещено использование стилей, которые могут приводить к загрузке каких-либо ресурсов. Это означает, что нельзя использовать атрибуты типа <code>&lt;url&gt;</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>CSS-правила не поддерживаются в AdGuard Content Blocker.</p><p>CSS-правила работают по-разному, и их приоритет меняется <a href="#cosmetic-rules-priority">в зависимости от платформы</a>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-selectors">Расширенные CSS-селекторы<a class="hash-link" href="#extended-css-selectors" title="Прямая ссылка на заголовок">​</a></h3><ul><li><a href="#extended-css-limitations">Ограничения</a></li><li><a href="#extended-css-has">Псевдокласс <code>:has()</code></a></li><li><a href="#extended-css-contains">Псевдокласс <code>:contains()</code></a></li><li><a href="#extended-css-matches-css">Псевдокласс <code>:matches-css()</code></a></li><li><a href="#extended-css-matches-attr">Псевдокласс <code>:matches-attr()</code></a></li><li><a href="#extended-css-property">Псевдокласс <code>:matches-property()</code></a></li><li><a href="#extended-css-xpath">Псевдокласс <code>:xpath()</code></a></li><li><a href="#extended-css-nth-ancestor">Псевдокласс <code>:nth-ancestor()</code></a></li><li><a href="#extended-css-upward">Псевдокласс <code>:upward()</code></a></li><li><a href="#remove-pseudos">Псевдокласс <code>:remove()</code> и псевдосвойство <code>remove</code></a></li><li><a href="#extended-css-is">Псевдокласс <code>:is()</code></a></li><li><a href="#extended-css-not">Псевдокласс <code>:not()</code></a></li><li><a href="#extended-css-if-not">Псевдокласс <code>:if-not()</code> (удалён)</a></li></ul><p>Возможностей CSS 3.0 не всегда хватает для блокировки рекламы. Чтобы решить эту проблему, AdGuard расширяет возможности CSS, добавляя поддержку новых псевдоэлементов. Мы разработали отдельную <a href="https://github.com/AdguardTeam/ExtendedCss" target="_blank" rel="noopener noreferrer">библиотеку с открытым исходным кодом</a> для выбора нестандартных элементов и применения CSS-стилей с расширенными свойствами.</p><p>Идея расширенных возможностей заключается в возможности сопоставлять элементы DOM с селекторами на основе их собственного представления (стиль, текстовое содержимое и т. д.) или отношений с другими элементами. Также есть возможность применять стили с нестандартными свойствами CSS.</p><p><strong>Область применения</strong></p><p>Расширенные селекторы можно применять в любом косметическом правиле, будь то <a href="#cosmetic-elemhide-rules">правила скрытия</a> или <a href="#cosmetic-css-rules">CSS-правила</a>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с расширенными CSS-селекторами не поддерживаются в AdGuard Content Blocker.</p></div></div><p><strong>Синтаксис</strong></p><p>Независимо от того, какие CSS-псевдоклассы вы используете в правилах, вы можете использовать специальные маркеры для принудительного применения этих правил с помощью ExtendedCss. Рекомендуется использовать эти маркеры для всех косметических расширенных CSS-правил, чтобы их было легче отличить.</p><p>Синтаксис расширенных CSS-правил:</p><ul><li><code>#?#</code> — для скрытия элементов, <code>#@?#</code> — для исключений</li><li><code>#$?#</code> — для CSS-стилей, <code>#@$?#</code> — для исключений</li></ul><p><strong>Настоятельно рекомендуем</strong> использовать этим маркеры каждый раз, когда вы используете расширенный CSS-селектор.</p><p><strong>Примеры</strong></p><ul><li><code>example.org#?#div:has(&gt; a[target=&quot;_blank&quot;][rel=&quot;nofollow&quot;])</code> — это правило блокирует все элементы <code>div</code>, которые содержат дочерний элемент со ссылкой с атрибутами <code>[target=&quot;_blank&quot;][rel=&quot;nofollow&quot;]</code>. При этом правило будет работать только для домена <code>example.org</code> и всех его поддоменов.</li><li><code>example.com#$?#h3:contains(cookies) { display: none!important; }</code> — это правило устанавливает стиль <code>display: none!important</code> для всех элементов <code>h3</code>, которые содержат слово <code>cookies</code>. При этом правило будет работать только для домена <code>example.com</code> и всех его поддоменов.</li><li><code>example.net#?#.banner:matches-css(width: 360px)</code> — это правило блокирует все элементы <code>.banner</code>, которые содержат стиль <code>width: 360px</code>. При этом правило будет работать только для домена <code>example.net</code> и всех его поддоменов.</li><li><code>example.net#@?#.banner:matches-css(width: 360px)</code> — это правило отменяет действие предыдущего правила.</li></ul><p>You can apply standard CSS selectors using the ExtendedCss library by using the rule marker <code>#?#</code>, e.g. <code>#?#div.banner</code>.</p><p>Больше <a href="#selectors-debugging-mode">об отладке расширенных селекторов</a></p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Некоторые псевдоклассы не требуют селектора перед ними. Still adding the <a href="https://www.w3.org/TR/selectors-4/#the-universal-selector" target="_blank" rel="noopener noreferrer">universal selector</a> <code>*</code> makes an extended selector easier to read, even though it has no effect on the matching behavior. Поэтому селектор <code>#block :has(&gt; .inner)</code> работает точно так же, как <code>#block *:has(&gt; .inner)</code> , но второй более очевиден.</p><p>Названия псевдоклассов не чувствительны к регистру, например, <code>:HAS()</code> работает как <code>:has()</code>. До сих пор часто используются названия в нижнем регистре.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-limitations">Ограничения ExtendedCss<a class="hash-link" href="#extended-css-limitations" title="Прямая ссылка на заголовок">​</a></h4><ol><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Comments" target="_blank" rel="noopener noreferrer">CSS-комментарии</a> и <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/At-rule" target="_blank" rel="noopener noreferrer">at-rules</a> не поддерживаются.</p></li><li><p>У конкретного псевдокласса могут быть свои ограничения: <a href="#extended-css-has-limitations"><code>:has()</code></a>, <a href="#extended-css-xpath-limitations"><code>:xpath()</code></a>, <a href="#extended-css-nth-ancestor-limitations"><code>:nth-ancestor()</code></a>, <a href="#extended-css-upward-limitations"><code>:upward()</code></a>, <a href="#extended-css-is-limitations"><code>:is()</code></a>, <a href="#extended-css-not-limitations"><code>:not()</code></a>, and <a href="#extended-css-remove-limitations"><code>:remove()</code></a>.</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-has">Псевдокласс <code>:has()</code><a class="hash-link" href="#extended-css-has" title="Прямая ссылка на заголовок">​</a></h4><p>Проект спецификации CSS 4.0 описывает псевдокласс <a href="https://www.w3.org/TR/selectors-4/#relational" target="_blank" rel="noopener noreferrer"><code>:has()</code></a>. К сожалению, популярные браузеры <a href="https://caniuse.com/css-has" target="_blank" rel="noopener noreferrer">пока не поддерживают этот псевдокласс</a>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Rules with the <code>:has()</code> pseudo-class must use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:has" target="_blank" rel="noopener noreferrer">native implementation of <code>:has()</code></a> if they use <code>##</code> marker and if it is possible, i.e. with no other extended selectors inside. Чтобы принудительно применить правила ExtendedCss с <code>:has()</code>, используйте маркер <code>#?#</code>/<code>#$?#</code> явно.</p></div></div><p><strong>Совместимость с другими псевдоклассами</strong></p><p>Синонимы <code>:-abp-has()</code> поддерживаются ExtendedCss для лучшей совместимости.</p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Уведомление об удалении</div><div class="admonitionContent_S0QG"><p><code>:if()</code> больше не поддерживается как синоним для <code>:has()</code>.</p></div></div><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:has(selector)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>selector</code> — необходимый, стандартный или расширенный CSS-селектор</li></ul><p>Псевдокласс <code>:has()</code> выбирает <code>target</code>-элементы, которые подходят под <code>selector</code>. Также <code>селектор</code> может начинаться с комбинатора.</p><p>Список селекторов можно задать и в <code>selector</code>. В этом случае <strong>все</strong> селекторы в списке будут сопоставляться. В будущем это будет исправлено для <a href="https://www.w3.org/TR/selectors-4/#typedef-forgiving-relative-selector-list" target="_blank" rel="noopener noreferrer"><code>&lt;forgiving-relative-selector-list&gt;</code></a> как аргумента.</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-has-limitations">Ограничения <code>:has()</code><a class="hash-link" href="#extended-css-has-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Использование псевдокласса <code>:has()</code> <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=669058#c54" target="_blank" rel="noopener noreferrer">ограничено для некоторых случаев (2, 3)</a>:</p><ul><li>запретить <code>:has()</code> внутри псевдоселекторов, принимающих только составные селекторы;</li><li>запретить <code>:has()</code> после обычных псевдоэлементов.</li></ul><p>Нативный псевдокласс <code>:has()</code> не допускает аргумент <code>:has()</code>, <code>:is()</code>, <code>:where()</code> внутри <code>:has()</code>, чтобы избежать увеличения сложности аннулирования <code>:has()</code> (<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=669058#c54" target="_blank" rel="noopener noreferrer">случай 1</a>). Но ранее ExtendedCss не имел такого ограничения, а списки фильтров уже содержат такие правила, поэтому мы не стали добавлять это ограничение в ExtendedCss и разрешили использовать <code>:has()</code> внутри <code>:has()</code>, как это было возможно ранее. Чтобы использовать его, просто принудительно используйте ExtendedCss, установив маркер <code>#?#</code>/<code>#$?#</code>.</p><p>Native implementation does not allow any usage of <code>:scope</code> inside the <code>:has()</code> argument (<a href="https://github.com/w3c/csswg-drafts/issues/7211" target="_blank" rel="noopener noreferrer">[1]</a>, <a href="https://github.com/w3c/csswg-drafts/issues/6399" target="_blank" rel="noopener noreferrer">[2]</a>). Тем не менее в списках фильтров есть правила <code>div:has(:scope a)</code>, которые мы продолжаем поддерживать, просто преобразуя их в <code>div:has(&gt; a)</code>, как это делалось ранее.</p><p><strong>Примеры</strong></p><p><code>div:has(.banner)</code> выбирает все <code>div</code>-элементы, которые <strong>включают</strong> элемент с классом <code>banner</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">inner element</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:has(&gt; .banner)</code> выбирает все <code>div</code>-элементы, которые <strong>включают</strong> элемент класса <code>banner</code> в качестве <em>прямого дочернего</em> элемента <code>div</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child element</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:has(+ .banner)</code> выбирает все <code>div</code>-элементы, <strong>предшествующие</strong> элементу класса <code>banner</code>, который <em>непосредственно следует</em> за <code>div</code> и оба являются детьми одного родителя:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">adjacent sibling</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:has(~ .banner)</code> выбирает все <code>div</code>-элементы, <strong>предшествующие</strong> элементу класса <code>banner</code>, который <em>следует</em> за <code>div</code>, но <em>не обязательно сразу</em>, и оба являются детьми одного родителя:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">general sibling</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:has(span, .banner)</code> выбирает все элементы <code>div</code>, которые <strong>включают в себя</strong> как элемент <code>span</code>, так и элемент класса <code>banner</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child span</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child .banner</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Старый синтаксис</div><div class="admonitionContent_S0QG"><p><a href="https://github.com/AdguardTeam/ExtendedCss#old-syntax-has" target="_blank" rel="noopener noreferrer">Синтаксис обратной совместимости для <code>:has()</code></a> поддерживается, но <strong>не рекомендуется</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-contains">Псевдокласс <code>:contains()</code><a class="hash-link" href="#extended-css-contains" title="Прямая ссылка на заголовок">​</a></h4><p>Принцип действия псевдокласса <code>:contains()</code> очень прост: он позволяет выбрать элементы, которые содержат заданный текст или содержимое которых соответствует указанному регулярному выражению. Поддерживаются флаги регулярных выражений.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Псевдокласс <code>:contains()</code> использует для сопоставления свойство элемента <code>textContent</code>, а не <code>innerHTML</code>.</p></div></div><p><strong>Совместимость с другими псевдоклассами</strong></p><p>Синонимы <code>:-abp-contains()</code> и <code>:has-text()</code> поддерживаются для лучшей совместимости.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:contains(match)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>match</code> — требуется, строка или регулярное выражение для соответствия элементу <code>textContent</code>. Также поддерживаются флаги регулярных выражений.</li></ul><p><strong>Примеры</strong></p><p>Для таких DOM:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">match</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Selected as IT contains &quot;banner&quot;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Not selected </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>the element <code>div#match</code> can be selected by any of these extended selectors:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! plain text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:contains(banner)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! регулярное выражение</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:contains(/as .* banner/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! регулярное выражение с флагами</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:contains(/it .* banner/gi)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Выбран только <code>div</code> с <code>id=match</code>, так как следующий элемент не содержит текст, а <code>banner</code> — это часть кода, а не текст.</p></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Старый синтаксис</div><div class="admonitionContent_S0QG"><p><a href="https://github.com/AdguardTeam/ExtendedCss#old-syntax-contains" target="_blank" rel="noopener noreferrer">Синтаксис обратной совместимости для <code>:contains()</code></a> поддерживается, но <strong>не рекомендуется</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-matches-css">Псевдокласс <code>:matches-css()</code><a class="hash-link" href="#extended-css-matches-css" title="Прямая ссылка на заголовок">​</a></h4><p>Псевдокласс <code>:matches-css()</code> позволяет сопоставить элемент по свойствам его текущего стиля. Работа псевдокласса основана на использовании метода <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle" target="_blank" rel="noopener noreferrer"><code>Window.getComputedStyle()</code></a>.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:matches-css([pseudo-element, ] property: pattern)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>pseudo-element</code> — необязательный, допустимый стандартный псевдоэлемент, например, <code>before</code>, <code>after</code>, <code>first-line</code> и т. д.</li><li><code>property</code> — требуется, название CSS-свойства, которое будет проверено у элемента</li><li><code>pattern</code> — требуется, шаблон значений, который использует то же простое сопоставление с подстановочными знаками, что и в основных правилах фильтрации URL-адресов, ИЛИ регулярное выражение. Для этого типа соответствия AdGuard не обращает внимание на регистр. В случае с регулярными выражениями шаблон будет выглядеть так: <code>/regexp/</code>.</li></ul><p><strong>Экранирование и снятие специальных символов</strong></p><p>Для <strong>нерегулярных выражений</strong> паттерны <code>(</code>,<code>)</code>,<code>[</code>,<code>]</code> должны быть <strong>без экранирования</strong>, например, <code>:matches-css(background-image:url(data:*))</code>.</p><p>Для <strong>регулярных выражений</strong> паттерны <code>\</code> должны быть <strong>экранированы</strong>, например, <code>:matches-css(background-image: /^url\\(&quot;data:image\\/gif;base64.+/)</code>.</p><p><strong>Примеры</strong></p><p>Для таких DOM:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">style</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/css</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token style language-css"></span><br></span><span class="token-line" style="color:#393A34"><span class="token style language-css">    </span><span class="token style language-css selector id" style="color:#00009f">#matched</span><span class="token style language-css selector pseudo-element" style="color:#00009f">::before</span><span class="token style language-css"> </span><span class="token style language-css punctuation" style="color:#393A34">{</span><span class="token style language-css"></span><br></span><span class="token-line" style="color:#393A34"><span class="token style language-css">        </span><span class="token style language-css property" style="color:#36acaa">content</span><span class="token style language-css punctuation" style="color:#393A34">:</span><span class="token style language-css"> </span><span class="token style language-css string" style="color:#e3116c">&quot;Block me&quot;</span><span class="token style language-css"></span><br></span><span class="token-line" style="color:#393A34"><span class="token style language-css">    </span><span class="token style language-css punctuation" style="color:#393A34">}</span><span class="token style language-css"></span><br></span><span class="token-line" style="color:#393A34"><span class="token style language-css"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">style</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">matched</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">not-matched</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div</code>-элементы с псевдоэлементом <code>::before</code> и с указанным свойством <code>content</code> могут быть выбраны любым из этих расширенных селекторов:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! паттерн строки</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-css(before, content: block me)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! паттерн строки с подстановочным знаком</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-css(before, content: block*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! паттерн регулярного выражения</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-css(before, content: /block me/)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Паттерны регулярных выражений <strong>не поддерживают</strong> флаги.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Устаревшие псевдоклассы <code>:matches-css-before()</code> и <code>:matches-css-after()</code> больше не рекомендуются, но по-прежнему поддерживаются для лучшей совместимости.</p></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Старый синтаксис</div><div class="admonitionContent_S0QG"><p><a href="https://github.com/AdguardTeam/ExtendedCss#old-syntax-matches-css" target="_blank" rel="noopener noreferrer">Синтаксис обратной совместимости для <code>:matches-css()</code></a> поддерживается, но <strong>не рекомендуется</strong>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-matches-attr">Псевдокласс <code>:matches-attr()</code><a class="hash-link" href="#extended-css-matches-attr" title="Прямая ссылка на заголовок">​</a></h4><p>The <code>:matches-attr()</code> pseudo-class allows selecting an element by its attributes, especially if they are randomized.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:matches-attr(&quot;name&quot;[=&quot;value&quot;])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>name</code> — требуется, простая строка, <em>или</em> строка с подстановочным знаком, <em>или</em> регулярное выражение для сопоставления имени атрибута</li><li><code>value</code> — необязательный, простая строка, <em>или</em> строка с подстановочным знаком, <em>или</em> регулярное выражение для сопоставления значения атрибута</li></ul><p><strong>Экранирование специальных символов</strong></p><p>For <strong>regexp</strong> patterns <code>&quot;</code> and <code>\</code> should be <strong>escaped</strong>, e.g. <code>div:matches-attr(class=/[\\w]{5}/)</code>.</p><p><strong>Примеры</strong></p><p><code>div:matches-attr(&quot;ad-link&quot;)</code> выбирает элемент <code>div#target1</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">ad-link</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1random23-banner_240x400</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:matches-attr(&quot;data-*&quot;=&quot;adBanner&quot;)</code> выбирает элемент <code>div#target2</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-1random23</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">adBanner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>div:matches-attr(*unit*=/^click$/)</code> выбирает элемент <code>div#target3</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">random123-unit094</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">click</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>*:matches-attr(&quot;/.{5,}delay$/&quot;=&quot;/^[0-9]*$/&quot;)</code> выбирает элемент <code>#target4</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">inner-random23</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target4</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">nt4f5be90delay</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1000</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">inner-random23</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Паттерны регулярных выражений <strong>не поддерживают</strong> флаги.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-property">Псевдокласс <code>:matches-property()</code><a class="hash-link" href="#extended-css-property" title="Прямая ссылка на заголовок">​</a></h4><p>The <code>:matches-property()</code> pseudo-class allows selecting an element by matching its properties.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:matches-property(&quot;name&quot;[=&quot;value&quot;])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>name</code> — требуется, простая строка, <em>или</em> строка с подстановочным знаком, <em>или</em> регулярное выражение для сопоставления имени свойства элемента</li><li><code>value</code> — необязательный, простая строка, <em>или</em> строка с подстановочным знаком, <em>или</em> регулярное выражение для сопоставления значения свойства элемента</li></ul><p><strong>Экранирование специальных символов</strong></p><p>For <strong>regexp</strong> patterns <code>&quot;</code> and <code>\</code> must be escaped, e.g. <code>div:matches-property(prop=/[\\w]{4}/)</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Паттерны регулярных выражений поддерживаются в <code>name</code> для любого свойства в цепочке, например, <code>prop./^unit[\\d]{4}$/.type</code>.</p></div></div><p><strong>Примеры</strong></p><p>Элемент с такими свойствами:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">divProperties </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">check</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">track</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">unit_2random1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">memoizedProps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">key</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">tag</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">_owner</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">effectTag</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">src</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ad.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>может быть выбран любым из этих расширенных селекторов:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-property(check.track)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-property(&quot;check./^unit_.{4,8}$/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-property(&quot;check.unit_*&quot;=true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-property(memoizedProps.key=&quot;null&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:matches-property(memoizedProps._owner.src=/ad/)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Для разработчиков фильтров</div><div class="admonitionContent_S0QG"><p>Чтобы проверить свойства конкретного элемента, сделайте следующее:</p><ol><li>Проверьте элемент страницы или выберите его в Инструментах разработчика браузера во вкладке <code>Элементы</code></li><li>Запустите <code>console.dir($0)</code> во вкладке <code>Консоль</code></li></ol></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Паттерны регулярных выражений <strong>не поддерживают</strong> флаги.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-xpath">Псевдокласс <code>:xpath()</code><a class="hash-link" href="#extended-css-xpath" title="Прямая ссылка на заголовок">​</a></h4><p>The <code>:xpath()</code> pseudo-class allows selecting an element by evaluating an XPath expression.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:xpath(expression)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — необязательный, стандартный или расширенный CSS-селектор</li><li><code>expression</code> — требуется, допустимое XPath выражение</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-xpath-limitations">Ограничения <code>:xpath()</code><a class="hash-link" href="#extended-css-xpath-limitations" title="Прямая ссылка на заголовок">​</a></h5><p><code>target</code> можно опустить, поэтому использовать его необязательно. Для любого другого псевдокласса это будет означать «применить ко <em>всем</em> узлам DOM», но в случае <code>:xpath()</code> это просто означает «применить к <em>целым</em> документам», и такое применение значительно замедляет выбор элементов. Вот почему такие правила, как <code>#?#:xpath(expression)</code>, ограничены поиском внутри тега <code>body</code>. Например, правило <code>#?#:xpath(//div[@data-st-area=\&#x27;Advert\&#x27;])</code> парсится как <code>#?#body:xpath(//div[@data-st- area=\&#x27;Advert\&#x27;])</code>.</p><p>Расширенные селекторы с <code>target</code>, определённым как <em>любой</em> селектор, — <code>*:xpath(expression)</code> — всё ещё можно использовать, но не рекомендуется. Поэтому следует уточнить <code>target</code>.</p><p>Корректно работает только в конце селектора, за исключением псевдокласса <a href="#remove-pseudos">:remove()</a>.</p><p><strong>Примеры</strong></p><p><code>:xpath(//*[@class=&quot;banner&quot;])</code> выбирает элемент <code>div#target1</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>:xpath(//*[@class=&quot;inner&quot;]/..)</code> выбирает элемент <code>div#target2</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">inner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-nth-ancestor">Псевдокласс <code>:nth-ancestor()</code><a class="hash-link" href="#extended-css-nth-ancestor" title="Прямая ссылка на заголовок">​</a></h4><p>Псевдокласс <code>:nth-ancestor()</code> позволяет искать <em>n-ного</em> предка по отношению к ранее выбранному элементу.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subject:nth-ancestor(n)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>subject</code> — обязателен. Стандартный или расширенный CSS-селектор</li><li><code>n</code> — обязателен. Число &gt;= 1 и &lt; 256, расстояние до нужного родителя от элемента, выбранного <code>subject</code></li></ul><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subject:nth-ancestor(n)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>subject</code> — required, standard or extended CSS selector</li><li><code>n</code> — обязателен. Число &gt;= 1 и &lt; 256, расстояние до нужного родителя от элемента, выбранного <code>subject</code></li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-nth-ancestor-limitations">Ограничения <code>:nth-ancestor()</code><a class="hash-link" href="#extended-css-nth-ancestor-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Псевдокласс <code>:nth-ancestor()</code> не поддерживается внутри аргумента псевдокласса <a href="#extended-css-not"><code>:not()</code></a>.</p><p><strong>Примеры</strong></p><p>Для таких DOM:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">child</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">inner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>.child:nth-ancestor(1)</code> выбирает элемент <code>div#target1</code>, <code>div[class=&quot;inner&quot;]:nth-ancestor(3)</code> выбирает элемент <code>div#target2</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-upward">Псевдокласс <code>:upward()</code><a class="hash-link" href="#extended-css-upward" title="Прямая ссылка на заголовок">​</a></h4><p>Псевдокласс <code>:upward()</code> позволяет искать предка по отношению к ранее выбранному элементу.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subject:upward(ancestor)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>subject</code> — стандартный или расширенный CSS-селектор, необходим</li><li><code>ancestor</code> — требуется, спецификация для предка элемента, выбранного <code>subject</code>, может быть задана как:<ul><li><em>число</em> &gt;= 1 и &lt; 256 для указания расстояния до нужного предка, то же, что и <a href="#extended-css-nth-ancestor"><code>:nth-ancestor()</code></a></li><li><em>стандартный CSS-селектор</em> для поиска ближайшего предка</li></ul></li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-upward-limitations">Ограничения <code>:upward()</code><a class="hash-link" href="#extended-css-upward-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Псевдокласс <code>:upward()</code> не поддерживается внутри аргумента псевдокласса <a href="#extended-css-not"><code>:not()</code></a>.</p><p><strong>Примеры</strong></p><p>Для таких DOM:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">true</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">child</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">inner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>.inner:upward(div[data])</code> выбирает элемент <code>div#target1</code>, <code>.inner:upward(div[id])</code> выбирает элемент <code>div#target2</code>, <code>.child:upward(1)</code> выбирает элемент <code>div#target1</code>, <code>.inner:upward(3)</code> выбирает элемент <code>div#target2</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="remove-pseudos">Псевдокласс <code>:remove()</code> и псевдосвойство <code>remove</code><a class="hash-link" href="#remove-pseudos" title="Прямая ссылка на заголовок">​</a></h4><p>Иногда необходимо удалить определённый элемент, а не просто скрыть его или применить какие-либо правила стиля. Для этого можно использовать псевдокласс <code>:remove()</code>, а также псевдосвойство <code>remove</code>.</p><p><strong>Псевдокласс <code>:remove()</code> может быть только в конце селектора.</strong></p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! pseudo-class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector:remove()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! псевдосвойство</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector { remove: true; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>subject</code> — обязателен. Стандартный или расширенный CSS-селектор</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-remove-limitations">Ограничения <code>:remove()</code> и <code>remove</code><a class="hash-link" href="#extended-css-remove-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Псевдокласс <code>:remove()</code> может корректно работать только в конце селектора.</p><p>For applying the <code>:remove()</code> pseudo-class to any element, the <a href="https://www.w3.org/TR/selectors-4/#the-universal-selector" target="_blank" rel="noopener noreferrer">universal selector</a> <code>*</code> should be used. В противном случае такой расширенный селектор может считаться некорректным, например, <code>.banner &gt; :remove()</code> недействителен для удаления любого дочернего элемента <code>элемента класса banner</code>, поэтому он должен выглядеть как <code>.banner &gt; *:remove()</code>.</p><p>Если используется псевдокласс <code>:remove()</code> или псевдосвойство <code>remove</code>, все свойства стиля игнорируются, кроме псевдосвойства <a href="#selectors-debug-mode"><code>debug</code></a>.</p><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">div.banner:remove()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:has(&gt; div[ad-attr]):remove()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div:contains(advertisement) { remove: true; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div[class]:has(&gt; a &gt; img) { remove: true; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Rules with the <code>remove</code> pseudo-property must use <code>#$?#</code> marker: <code>$</code> for CSS-style rule syntax, <code>?</code> for ExtendedCss syntax.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-is">Псевдокласс <code>:is()</code><a class="hash-link" href="#extended-css-is" title="Прямая ссылка на заголовок">​</a></h4><p>Псевдокласс <code>:is()</code> позволяет сопоставить любой элемент, который может быть выбран любым из переданных ему селекторов. Некорректные селекторы пропускаются, и псевдокласс работает с допустимыми селекторами без каких-либо ошибок. Наша реализация <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:is" target="_blank" rel="noopener noreferrer">нативного <code>:is()</code> псевдокласса</a>.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:is(selectors)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>selectors</code> — <a href="https://drafts.csswg.org/selectors-4/#typedef-forgiving-selector-list" target="_blank" rel="noopener noreferrer"><em>щадящий список</em></a> стандартных и расширенных селекторов. For extended selectors, only compound selectors are supported, not complex.</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-is-limitations">Ограничения <code>:is()</code><a class="hash-link" href="#extended-css-is-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Rules with the <code>:is()</code> pseudo-class must use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:is" target="_blank" rel="noopener noreferrer">native implementation of <code>:is()</code></a> if rules use <code>##</code> marker and it is possible, i.e. with no other extended selectors inside. Чтобы принудительно применить правила ExtendedCss с <code>:is()</code>, используйте маркер <code>#?#</code>/<code>#$?#</code> явно.</p><p>Если <code>selectors</code> аргумент псевдокласса <code>:is()</code> — расширенный селектор, то из-за того, как псевдокласс <code>:is()</code> реализован в ExtendedCss 2.0, его невозможно применить к верхнему узлу DOM, который является <code>html</code>, т.е. <code>#?#html:is(&lt;extended-selectors&gt;)</code> не работает. So if <code>target</code> is not defined or defined as the <a href="https://www.w3.org/TR/selectors-4/#the-universal-selector" target="_blank" rel="noopener noreferrer">universal selector</a> <code>*</code>, the extended pseudo-class applying is limited to <strong><code>html</code>&#x27;s children</strong>, e.g. rules <code>#?#:is(...)</code> and <code>#?#*:is(...)</code> are parsed as <code>#?#html *:is(...)</code>. Обратите внимание, что для стандартного аргумента селектора такого ограничения нет, т.е. <code>#?#html:is(.locked)</code> работает нормально.</p><p><a href="https://www.w3.org/TR/selectors-4/#complex" target="_blank" rel="noopener noreferrer">Сложные селекторы</a> с расширенными псевдоклассами не поддерживаются в качестве аргумента <code>selectors</code> для псевдокласса <code>:is()</code> — разрешены только <a href="https://www.w3.org/TR/selectors-4/#compound" target="_blank" rel="noopener noreferrer">составные</a>. Ознакомьтесь с примерами, чтобы разобраться в деталях.</p><p><strong>Примеры</strong></p><p><code>#container *:is(.inner, .footer)</code> выбирает только элемент <code>div#target1</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">true</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">inner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Из-за ограничений <code>:is(*:not([class]) &gt; .banner)&#x27;</code> не работает, но <code>:is(*:not([class]):has(&gt; .banner))</code> можно использовать вместо него для выбора элемента <code>div#target2</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">span</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">text</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target2</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">banner</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">inner paragraph</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-not">Псевдокласс <code>:not()</code><a class="hash-link" href="#extended-css-not" title="Прямая ссылка на заголовок">​</a></h4><p>Псевдокласс <code>:not()</code> позволяет выбрать элементы, которые <em>не соответствуют</em> селекторам, переданным в качестве аргумента. Неправильные селекторы аргументов не допускаются, и будет выдана ошибка. Наша реализация псевдокласса <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:not" target="_blank" rel="noopener noreferrer"><code>:not()</code></a>.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[target]:not(selectors)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>target</code> — optional, standard or extended CSS selector, can be skipped for checking <em>any</em> element</li><li><code>selectors</code> — список стандартных или расширенных селекторов</li></ul><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-not-limitations">Ограничения <code>:not()</code><a class="hash-link" href="#extended-css-not-limitations" title="Прямая ссылка на заголовок">​</a></h5><p>Rules with the <code>:not()</code> pseudo-class must use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:not" target="_blank" rel="noopener noreferrer">native implementation of <code>:not()</code></a> if rules use <code>##</code> marker and it is possible, i.e. with no other extended selectors inside. Чтобы принудительно применить правила ExtendedCss с <code>:not()</code>, используйте маркер <code>#?#</code>/<code>#$?#</code> явно.</p><p>Если <code>selectors</code> аргумент псевдокласса <code>:not()</code> — расширенный селектор, то из-за того, как псевдокласс <code>:not()</code> реализован в ExtendedCss 2.0, его невозможно применить к верхнему узлу DOM, который является <code>html</code>, т.е. <code>#?#html:not(&lt;extended-selectors&gt;)</code> не работает. So if <code>target</code> is not defined or defined as the <a href="https://www.w3.org/TR/selectors-4/#the-universal-selector" target="_blank" rel="noopener noreferrer">universal selector</a> <code>*</code>, the extended pseudo-class applying is limited to <strong><code>html</code>&#x27;s children</strong>, e.g. rules <code>#?#:not(...)</code> and <code>#?#*:not(...)</code> are parsed as <code>#?#html *:not(...)</code>. Обратите внимание, что для стандартного аргумента селектора такого ограничения нет, т.е. <code>#?#html:not(.locked)</code> работает нормально.</p><p>Псевдокласс <code>:not()</code> рассматривается как стандартный псевдокласс CSS внутри аргумента псевдокласса <a href="#extended-css-upward"><code>:upward()</code></a>, поскольку <code>:upward()</code> поддерживает только стандартные селекторы.</p><p>«Восходящие» псевдоклассы <a href="#extended-css-nth-ancestor"><code>:nth-ancestor()</code></a> и <a href="#extended-css-upward"><code>:upward()</code></a> не поддерживаются внутри аргумента <code>selectors</code> для псевдокласса <code>:not()</code>.</p><p><strong>Примеры</strong></p><p><code>#container &gt; *:not(h2, .text)</code> выбирает только элемент <code>div#target1</code>:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- HTML code --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Header</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">target1</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">text</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extended-css-if-not">Псевдокласс <code>:if-not()</code> (удалён)<a class="hash-link" href="#extended-css-if-not" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Уведомление об удалении</div><div class="admonitionContent_S0QG"><p>Псевдокласс <code>:if-not()</code> удалён и больше не поддерживается. Правила с ним не работают.</p></div></div><p>Этот псевдокласс изначально был сокращением для <code>:not(:has())</code>. Он поддерживался ExtendedCss для лучшей совместимости с подписками на некоторые фильтры.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cosmetic-rules-priority">Приоритет косметических правил<a class="hash-link" href="#cosmetic-rules-priority" title="Прямая ссылка на заголовок">​</a></h3><p>То, как применяются правила <strong>скрытия элементов</strong> и <strong>CSS-правила</strong>, зависит от платформы.</p><p><strong>В AdGuard для Windows, Mac и Android</strong> мы используем таблицу стилей, встроенную в страницу. Приоритет у косметических правил такой же, как и у любых других таблиц стилей CSS на сайтах. Но есть ограничение: <a href="#cosmetic-elemhide-rules">правила скрытия элементов</a> и <a href="#cosmetic-css-rules">CSS-правила</a> не могут обходить встроенные стили. В таких случаях рекомендуется использовать расширенные селекторы или HTML-фильтрацию.</p><p><strong>В Браузерном расширении AdGuard</strong> используются так называемые «пользовательские таблицы стилей». Их приоритет выше, даже чем у встроенных стилей.</p><p><strong>Расширенные CSS-селекторы</strong> используют для работы JavaScript и добавляют встроенные стили сами, поэтому могут игнорировать любой стиль.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="html-filtering-rules">Правила фильтрации HTML<a class="hash-link" href="#html-filtering-rules" title="Прямая ссылка на заголовок">​</a></h2><p>В большинстве случаев для фильтрации рекламы достаточно базовых и косметических правил. Но иногда необходимо изменить HTML-код самой страницы перед её загрузкой. Для этого применяются правила фильтрации HTML-контента. Они позволяют указать, какие HTML-элементы необходимо вырезать из страницы перед тем, как страница попадёт в браузер.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила HTML-фильтрации поддерживаются в AdGuard для Windows, Mac, Android и Браузерном расширении AdGuard для Firefox. Такие правила не работают в расширениях для других браузеров, потому что они не могут модифицировать содержимое страниц на сетевом уровне.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="синтаксис-1">Синтаксис<a class="hash-link" href="#синтаксис-1" title="Прямая ссылка на заголовок">​</a></h3><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     selector = [tagName] [attributes] [pseudoClasses]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   combinator = &quot;&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         rule = [domains] &quot;$$&quot; selector *(combinator selector)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      domains = [domain0, domain1[, ...[, domainN]]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   attributes = &quot;[&quot; name0 = value0 &quot;]&quot; &quot;[&quot; name1 = value2 &quot;]&quot; ... &quot;[&quot; nameN = valueN &quot;]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pseudoClasses = pseudoClass *pseudoClass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pseudoClass = &quot;:&quot; pseudoName [ &quot;(&quot; pseudoArgs &quot;)&quot; ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>tagName</code></strong> — имя элемента в нижнем регистре, например, <code>div</code> или <code>script</code>.</li><li><strong><code>domains</code></strong> — ограничение на домены, на страницах которых будет применено правило. Те же принципы, что и в <a href="#cosmetic-elemhide-rules">синтаксисе правил скрытия элементов</a>.</li><li><strong><code>attributes</code></strong> — список атрибутов, ограничивающих выбор элементов. <code>name</code> — имя атрибута, <code>value</code> — подстрока, которая содержится в значении атрибута.</li><li><strong><code>pseudoName</code></strong> — имя псевдокласса.</li><li><strong><code>pseudoArgs</code></strong> — аргументы псевдокласса, записанного в виде функции.</li><li><strong><code>combinator</code></strong> — оператор, который работает аналогично <a href="https://developer.mozilla.org/ru/docs/Web/CSS/Child_combinator" target="_blank" rel="noopener noreferrer">CSS-комбинатору дочерних элементов</a>: селектор справа от комбинатора будет относиться только к элементу, прямой родительский элемент которого соответствует селектору слева от комбинатора.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="примеры-2">Примеры<a class="hash-link" href="#примеры-2" title="Прямая ссылка на заголовок">​</a></h3><p><strong>HTML-код:</strong></p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/banner.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Правило:</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.org$$script[data-src=&quot;banner&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это правило удалит из кода страниц все элементы <code>script</code> со значением <code>data-src</code>, содержащим подстроку <code>banner</code>. При этом правило будет работать только для домена <code>example.org</code> и всех его поддоменов.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="специальные-атрибуты">Специальные атрибуты<a class="hash-link" href="#специальные-атрибуты" title="Прямая ссылка на заголовок">​</a></h3><p>Помимо обычных атрибутов, значение которых проверяется у каждого элемента, существует набор специальных атрибутов правила, которые изменяют способ работы правила. Ниже мы перечислим все эти атрибуты:</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tag-content"><code>tag-content</code><a class="hash-link" href="#tag-content" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>В будущем этот специальный атрибут может перестать поддерживаться. Предпочтительнее использовать псевдокласс <code>:contains()</code> там, где это возможно.</p></div></div><p>Пожалуй, наиболее часто используемый специальный атрибут. Он ограничивает выбор теми элементами, внутренний HTML-код которых (innerHTML) содержит указанную подстроку.</p><p>You must use <code>&quot;&quot;</code> to escape <code>&quot;</code>, for instance: <code>$$script[tag-content=&quot;alert(&quot;&quot;this is ad&quot;&quot;)&quot;]</code></p><p>Например, рассмотрим такой HTML-код:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">write</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;&lt;div&gt;banner text&lt;/div&gt;&quot; /&gt;&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Следующее правило удалит все <code>script</code> элементы с подстрокой <code>banner</code> в их коде:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$$script[tag-content=&quot;banner&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Специальный атрибут <code>tag-content</code> не должен появляться в селекторе слева от комбинатора <code>&gt;</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wildcard"><code>wildcard</code><a class="hash-link" href="#wildcard" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>В будущем этот специальный атрибут может перестать поддерживаться. Предпочтительнее использовать псевдокласс <code>:contains()</code> там, где это возможно.</p></div></div><p>Этот специальный атрибут работает почти как <code>tag-content</code> и позволяет проверить внутренний HTML-код элемента. Правило проверит, удовлетворяет ли HTML-код элемента заданному <a href="https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B0" target="_blank" rel="noopener noreferrer">шаблону поиска</a>.</p><p>You must use <code>&quot;&quot;</code> to escape <code>&quot;</code>, for instance: <code>$$script[wildcard=&quot;&quot;banner&quot;&quot;]</code></p><p>Например: <code>$$script[wildcard=&quot;*banner*text*&quot;]</code></p><p>It checks if the element code contains the two consecutive substrings <code>banner</code> and <code>text</code>.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Специальный атрибут <code>wildcard</code> не должен появляться в селекторе слева от комбинатора <code>&gt;</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="max-length"><code>max-length</code><a class="hash-link" href="#max-length" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>В будущем этот специальный атрибут может перестать поддерживаться. Предпочтительнее использовать псевдокласс <code>:contains()</code> там, где это возможно.</p></div></div><p>Задает максимальную длину содержимого HTML-элемента. Если этот параметр задан и длина содержимого превышает заданное значение, правило не применяется к элементу.</p><p><strong>Значение по умолчанию</strong></p><p>Если этот параметр не задан, то <code>max-length</code> считается равным 8192.</p><p>Например:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$$div[tag-content=&quot;banner&quot;][max-length=&quot;400&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это правило удалит все элементы <code>div</code>, код которых содержит подстроку <code>banner</code> и длина которых не превышает <code>400</code> символов.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Специальный атрибут <code>max-length</code> не должен появляться в селекторе слева от комбинатора <code>&gt;</code>.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="min-length"><code>min-length</code><a class="hash-link" href="#min-length" title="Прямая ссылка на заголовок">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Скоро устареет</div><div class="admonitionContent_S0QG"><p>В будущем этот специальный атрибут может перестать поддерживаться. Предпочтительнее использовать псевдокласс <code>:contains()</code> там, где это возможно.</p></div></div><p>Задаёт минимальную длину содержимого HTML-элемента. Если этот параметр задан, и длина содержимого меньше заданного значения — правило не применяется к элементу.</p><p>Например:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$$div[tag-content=&quot;banner&quot;][min-length=&quot;400&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это правило удалит все элементы <code>div</code>, код которых содержит подстроку <code>banner</code> и длина которых превышает <code>400</code> символов.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Специальный атрибут <code>min-length</code> не должен появляться в селекторе слева от комбинатора <code>&gt;</code>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="псевдоклассы">Псевдоклассы<a class="hash-link" href="#псевдоклассы" title="Прямая ссылка на заголовок">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="contains"><code>:contains()</code><a class="hash-link" href="#contains" title="Прямая ссылка на заголовок">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="синтаксис-2">Синтаксис<a class="hash-link" href="#синтаксис-2" title="Прямая ссылка на заголовок">​</a></h5><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">:contains(текст без кавычек)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>или</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">:contains(/reg(ular)?ex(pression)?/)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p><code>:-abp-contains()</code> и <code>:has-text()</code> являются синонимами <code>:contains()</code>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Псевдокласс <code>:contains()</code> поддерживается в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.13 или выше</strong>.</p></div></div><p>Требует, чтобы внутренний HTML-код элемента содержал указанный текст или соответствовал указанному регулярному выражению.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Псевдокласс <code>:contains()</code> не должен появляться в селекторе слева от комбинатора <code>&gt;</code>.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="исключения">Исключения<a class="hash-link" href="#исключения" title="Прямая ссылка на заголовок">​</a></h3><p>По аналогии с правилами скрытия, существует специальный тип правил, отключающий действие выбранного правила HTML-фильтрации для определённых доменов. Синтаксис правил-исключений такой же, только маркер <code>$$</code> заменяется на <code>$@$</code>.</p><p>Например, в фильтре есть правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$$script[tag-content=&quot;banner&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если вы хотите отключить его для домена <code>example.com</code>, вы можете создать правило исключения:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com$@$script[tag-content=&quot;banner&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В некоторых случаях может потребоваться отключение всех запрещающих правил. Например, на время тестирования. Для этого воспользуйтесь правилом исключения без указания домена.</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$@$script[tag-content=&quot;banner&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Применять такие исключения рекомендуется только в случае, когда изменить само правило скрытия невозможно. Во всех остальных случаях лучше изменить исходное правило, используя ограничение на домены.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="javascript-rules">Правила JavaScript<a class="hash-link" href="#javascript-rules" title="Прямая ссылка на заголовок">​</a></h2><p>AdGuard поддерживает специальный тип правил, позволяющий вставить любой javascript-код на страницы сайтов.</p><p>Мы <strong>настоятельно рекомендуем</strong> использовать <a href="#scriptlets">скриптлеты</a> вместо JavaScript-правил везде, где это возможно. JS-правила должны помочь в процессе отладки, но в качестве долгосрочного решения следует использовать скриптлеты.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rule = [domains]  &quot;#%#&quot; script</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>domains</code></strong> — ограничение на домены, на страницах которых будет применено правило. Строится по тем же правилам, что и в случае <a href="#cosmetic-elemhide-rules">правил скрытия элементов</a>.</li><li><strong><code>script</code></strong> — произвольный javascript-код <strong>в одну строку</strong>.</li></ul><p><strong>Примеры</strong></p><ul><li><code>example.org#%#window.__gaq = undefined;</code> выполняет код <code>window.__gaq = undefined;</code> на всех страницах сайта <code>example.org</code> и всех его поддоменах.</li></ul><p><strong>Исключения</strong></p><p>По аналогии с правилами скрытия, существует специальный тип правил, отключающий действие выбранного javascript-правила фильтрации для определённых доменов. Синтаксис правил-исключений такой же, только маркер <code>#%#</code> заменяется на <code>#@%#</code>.</p><p>Например, в фильтре есть правило:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#%#window.__gaq = undefined;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если вы хотите отключить его для домена <code>example.com</code>, вы можете создать правило исключения:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.com#@%#window.__gaq = undefined;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В некоторых случаях может потребоваться отключение всех запрещающих правил. Например, на время тестирования. Для этого воспользуйтесь правилом исключения без указания домена.</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#@%#window.__gaq = undefined;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Применять такие исключения рекомендуется только в случае, когда изменить само правило скрытия невозможно. Во всех остальных случаях лучше изменить исходное правило, используя ограничение на домены.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Правила JavaScript можно использовать <a href="#trusted-filters"><strong>только в доверенных фильтрах</strong></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>JavaScript-правила не поддерживаются в AdGuard Content Blocker.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scriptlets">Правила скриптлета<a class="hash-link" href="#scriptlets" title="Прямая ссылка на заголовок">​</a></h2><p>Скриптлет — это функция JavaScript с расширенными возможностями для блокировки контента. Такие функции могут использоваться в декларативной манере в правилах фильтрации AdGuard.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>AdGuard поддерживает множество различных скриптлетов. Чтобы добиться совместимости между различными блокировщиками, мы также поддерживаем синтаксис uBO и ABP.</p></div></div><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rule = [domains]  &quot;#%#//scriptlet(&quot; scriptletName arguments &quot;)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>scriptletName</code></strong> (обязательно) — это имя скриптлета из библиотеки скриптлетов AdGuard</li><li><strong><code>arguments</code></strong> (опционально) — это список аргументов в формате <code>string</code> (другие типы аргументов не поддерживаются)</li></ul><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">example.org#%#//scriptlet(&quot;abort-on-property-read&quot;, &quot;alert&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это правило применится на страницах домена <code>example.org</code> и его поддоменов и выполнит скриптлет <code>abort-on-property-read</code> с параметром <code>alert</code>.</p><p>Подробнее <a href="#debug-scriptlets">об отладке скриптлетов</a>.</p><p>Больше информации о скриптлетах можно найти на <a href="https://github.com/AdguardTeam/Scriptlets#scriptlets" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Скриптлеты не поддерживаются в AdGuard Content Blocker.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="trusted-scriptlets">Доверенные скриптлеты<a class="hash-link" href="#trusted-scriptlets" title="Прямая ссылка на заголовок">​</a></h3><p>Доверенные скриптлеты — это <a href="#scriptlets">скриптлеты</a> с расширенной функциональностью. У них тот же синтаксис и ограничения. У имён доверенных скриптлетов есть префикс <code>trust-</code>, например, <code>trust-set-cookie</code>, чтобы их было легко отличить от обычных скриптлетов.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Доверенные скриптлеты несовместимы с другими блокировщиками рекламы, кроме AdGuard.</p></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Ограничения</div><div class="admonitionContent_S0QG"><p>Доверенные скриптлеты можно использовать <a href="#trusted-filters"><strong>только в доверенных фильтрах</strong></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Доверенные скриптлеты не поддерживаются в AdGuard Content Blocker.</p></div></div><p>Подробнее <a href="#debug-scriptlets">об отладке скриптлетов</a></p><p>Больше информации о доверенных скриптлетах можно найти на <a href="https://github.com/AdguardTeam/Scriptlets#trusted-scriptlets" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-rules-modifiers">Модификаторы для небазовых правил<a class="hash-link" href="#non-basic-rules-modifiers" title="Прямая ссылка на заголовок">​</a></h2><p>Поведение любого правила можно изменить, используя модификаторы, описанные ниже.</p><p><strong>Синтаксис</strong> {#non-basic-rules-modifiers-syntax}</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rule = &quot;[$&quot; modifiers &quot;]&quot; [rule text]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifiers = modifier0[, modifier1[, ...[, modifierN]]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong><code>modifier</code></strong> — набор модификаторов, описанных ниже.</li><li><strong><code>rule text</code></strong> — правило, которое нужно модифицировать.</li></ul><p>Например: <code>[$domain=example.com,app=test_app]##selector</code>.</p><p>In the modifiers values, the following characters must be escaped: <code>[</code>, <code>]</code>, <code>,</code>, and <code>\</code> (unless it is used for the escaping). Используйте <code>\</code>, чтобы экранировать их. Например, экранированная скобка выглядит так: <code>\]</code>.</p><table><thead><tr><th>Модификатор \ Продукты</th><th align="center"><a href="#what-product" title="AdGuard для Windows, Mac и Android">Приложения CoreLibs</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium">AdGuard для Chromium</a></th><th align="center"><a href="#what-product" title="Браузерное расширение AdGuard для Firefox">AdGuard для Firefox</a></th><th align="center"><a href="#what-product" title="AdGuard для iOS и AdGuard Pro для iOS">AdGuard для iOS</a></th><th align="center"><a href="#what-product" title="AdGuard для Safari">AdGuard для Safari</a></th><th align="center"><a href="#what-product" title="AdGuard Content Blocker для браузеров Samsung Internet and Яндекс на Android">AdGuard Content Blocker</a></th></tr></thead><tbody><tr><td><a href="#non-basic-app-modifier">$app</a></td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr><tr><td><a href="#non-basic-domain-modifier">$domain</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#non-basic-path-modifier">$path</a></td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">✅</td><td align="center">❌</td></tr><tr><td><a href="#non-basic-url-modifier">$url</a></td><td align="center">✅</td><td align="center">⏳</td><td align="center">⏳</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>⏳ — реализован или планируется к реализации, но пока недоступен ни в одном продукте</li><li>❌ — не поддерживается</li></ul></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-app-modifier"><strong><code>$app</code></strong><a class="hash-link" href="#non-basic-app-modifier" title="Прямая ссылка на заголовок">​</a></h3><p>Модификатор <code>$app</code> ограничивает действие правила до конкретного приложения или списка приложений. Поведение и синтаксис модификатора полностью совпадают с соответствующим <a href="#app-modifier">модификатором <code>$app</code> для базовых правил</a>.</p><p><strong>Примеры</strong></p><ul><li><code>[$app=org.example.app]example.com##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>example.com</code> and all subdomains in requests sent from the <code>org.example.app</code> Android app.</li><li><code>[$app=~org.example.app1|~org.example.app2]example.com##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>example.com</code> and all subdomains in requests sent from any app except <code>org.example.app1</code> and <code>org.example.app2</code>.</li><li><code>[$app=com.apple.Safari]example.org#%#//scriptlet(&#x27;prevent-setInterval&#x27;, &#x27;check&#x27;, &#x27;!300&#x27;)</code> применяет скриптлет <code>prevent-setInterval</code> только в браузере Safari на Mac.</li><li><code>[$app=org.example.app]#@#.textad</code> отключает все правила <code>##.textad</code> для всех доменов при использовании <code>org.example.app</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Такие правила с модификатором <code>$app</code> поддерживаются AdGuard для Windows, Mac и Android.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-domain-modifier"><strong><code>$domain</code></strong><a class="hash-link" href="#non-basic-domain-modifier" title="Прямая ссылка на заголовок">​</a></h3><p>Модификатор <code>$domain</code> ограничивает область действия правила списком доменов и их поддоменов. Поведение и синтаксис модификатора полностью совпадают с соответствующим <a href="#domain-modifier">модификатором <code>$domain</code> для базовых правил</a>.</p><p><strong>Примеры</strong></p><ul><li><code>[$domain=example.com]##.textad</code> — hides a <code>div</code> with the class <code>textad</code> at <code>example.com</code> and all subdomains.</li><li><code>[$domain=example.com|example.org]</code> скроет элемент с атрибутом <code>id</code> равным <code>adblock</code> на доменах <code>example.com</code>, <code>example.org</code> и всех их поддоменах.</li><li><code>[$domain=~example.com]##.textad</code> скроет элементы <code>div</code> с классом <code>textad</code> на всех доменах, кроме <code>example.com</code> и всех его поддоменов.</li></ul><p>Существует два способа указать доменные ограничения для косметических правил:</p><ol><li>«классический»: обозначить ограничение на домены перед маской и атрибутами правила: <code>example.com##.textad</code>;</li><li>с помощью модификаторов: обозначить ограничение на домены через модификатор <code>$domain</code>: <code>[$domain=example.com]##.textad</code>.</li></ol><p>Правила, нарушающие эти ограничения, считаются недействительными. So, for example, the rule <code>[$domain=example.org]example.com##.textad</code> will be ignored.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$domain</code> поддерживаются в AdGuard для Windows, Mac, Android и Браузерном расширении AdGuard для Chrome, Firefox и Edge.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-path-modifier"><strong><code>$path</code></strong><a class="hash-link" href="#non-basic-path-modifier" title="Прямая ссылка на заголовок">​</a></h3><p>Модификатор <code>$path</code> ограничивает область применения правила определёнными местами или страницами на сайтах.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$path [&quot;=&quot; pattern]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>pattern</code> (опциональный) — это маска пути, которой ограничено правило. Его синтаксис и поведение почти такие же, как в <a href="#basic-rules-syntax">шаблоне базовых правил</a>. Вы также можете использовать <a href="#basic-rules-special-characters">специальные символы</a>, кроме <code>||</code>, который в этом случае не имеет смысла (см. примеры ниже).</p><p>Если для <code>$path</code> не задан <code>pattern</code>, правило будет применяться только на главной странице сайта.</p><p>Модификатор <code>$path</code> также соответствует строке запроса.</p><p>Модификатор <code>$path</code> поддерживает регулярные выражения <a href="#regexp-support">так же, как и базовые правила</a>.</p><p><strong>Примеры</strong></p><ul><li><code>[$path=page.html]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>/page.html</code> or <code>/page.html?&lt;query&gt;</code> or <code>/sub/page.html</code> or <code>/another_page.html</code></li><li><code>[$path=/page.html]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>/page.html</code> or <code>/page.html?&lt;query&gt;</code> or <code>/sub/page.html</code> of any domain but not at <code>/another_page.html</code></li><li><code>[$path=|/page.html]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>/page.html</code> or <code>/page.html?&lt;query&gt;</code> of any domain but not at <code>/sub/page.html</code></li><li><code>[$path=/page.html|]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>/page.html</code> or <code>/sub/page.html</code> of any domain but not at <code>/page.html?&lt;query&gt;</code></li><li><code>[$path=/page*.html]example.com##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>/page1.html</code> or <code>/page2.html</code> or any other path matching <code>/page&lt;...&gt;.html</code> of <code>example.com</code></li><li><code>[$path]example.com##.textad</code> hides a <code>div</code> with the class <code>textad</code> at the main page of <code>example.com</code></li><li><code>[$domain=example.com,path=/page.html]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at <code>page.html</code> of <code>example.com</code> and all subdomains but not at <code>another_page.html</code></li><li><code>[$path=/\\/(sub1|sub2)\\/page\\.html/]##.textad</code> hides a <code>div</code> with the class <code>textad</code> at both <code>/sub1/page.html</code> and <code>/sub2/page.html</code> of any domain (please note the <a href="#non-basic-rules-modifiers-syntax">escaped special characters</a>)</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$path</code> не поддерживаются в AdGuard Content Blocker.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-basic-url-modifier"><strong><code>$url</code></strong><a class="hash-link" href="#non-basic-url-modifier" title="Прямая ссылка на заголовок">​</a></h3><p>Модификатор <code>$url</code> ограничивает действие правила запросами, URL которых соответствует указанной маске.</p><p><strong>Синтаксис</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">url = pattern</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где <code>pattern</code> — маска адреса, синтаксис которой соответствует маске адреса <a href="#basic-rules-syntax"><code>pattern</code> базовых правил</a> за исключением того, что <a href="#non-basic-rules-modifiers-syntax">некоторые символы</a> должны быть экранированы. <a href="#basic-rules-special-characters">Специальные символы</a> и <a href="#regexp-support">регулярные выражения</a> также поддерживаются.</p><p><strong>Примеры</strong></p><ul><li><code>[$url=||example.com/content/*]##div.textad</code> hides a <code>div</code> with the class <code>textad</code> at addresses like <code>https://example.com/content/article.html</code> and even <code>https://subdomain.example.com/content/article.html</code>.</li><li><code>[$url=||example.org^]###adblock</code> скрывает элемент с атрибутом <code>id</code> равным <code>adblock</code> в запросах к <code>example.org</code> и всем его поддоменам.</li><li><code>[$url=/\[a-z\]+\\.example\\.com^/]##.textad</code> скрывает <code>div</code> с классом <code>textad</code> в запросах ко всем доменам, соответствующим регулярному выражению <code>[a-z]+\.example\.com^</code>.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Правила с модификатором <code>$url</code> поддерживаются в AdGuard для Windows, Mac и Android с <strong>CoreLibs версии 1.11 или выше</strong>.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="информация-для-разработчиков-фильтров">Информация для разработчиков фильтров<a class="hash-link" href="#информация-для-разработчиков-фильтров" title="Прямая ссылка на заголовок">​</a></h2><p>Если вы разрабатываете сторонний фильтр, известный AdGuard, вам может быть интересна информация, представленная в этом разделе. Имейте в виду, что подсказки будут применяться только к зарегистрированным фильтрам. Фильтр считается зарегистрированным и известным AdGuard, если он присутствует в <a href="https://filters.adtidy.org/extension/chromium/filters.json" target="_blank" rel="noopener noreferrer">перечне известных фильтров</a>. Если вы хотите зарегистрировать свой фильтр, направьте запрос в <a href="https://github.com/AdguardTeam/AdguardFilters" target="_blank" rel="noopener noreferrer">репозиторий AdGuardFilters</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="директивы-препроцессора">Директивы препроцессора<a class="hash-link" href="#директивы-препроцессора" title="Прямая ссылка на заголовок">​</a></h3><p>Мы предоставляем несколько директив препроцессора, которые могут быть использованы разработчиками фильтров для улучшения совместимости с различными блокировщиками рекламы. Директивы могут:</p><ul><li><a href="#include-directive">включать содержимое отдельного файла в фильтр</a></li><li><a href="#conditions-directive">применять правила в зависимости от типа блокировщика</a></li><li><a href="#safari-affinity-directive">уточнять блокировщик контента для применения правил в Safari</a></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Любая ошибка в директиве препроцессора приведёт к невозможности обновить фильтр, как если бы URL фильтра был недоступен.</p><p>Препроцессорные директивы можно использовать в пользовательских правилах или фильтрах.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="include-directive">Включение файла<a class="hash-link" href="#include-directive" title="Прямая ссылка на заголовок">​</a></h4><p>Директива <code>!#include</code> позволяет включать в фильтр содержимое заданного файла. Она поддерживает только файлы из того же источника, чтобы удостовериться, что разработчик фильтров является владельцем указанного файла. Включённый файл также может содержать директивы препроцессора (даже другие<code>!#include</code>-директивы). Блокировщики должны принимать во внимание случай рекурсивного использования <code>!#include</code> и внедрять защитный механизм.</p><p><strong>Синтаксис</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!#include file_path</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где <code>file_path</code> — абсолютный или относительный путь к файлу одного и того же источника, который должен быть включён.</p><p>The files must originate from the same domain but may be located in a different folder.</p><p>Если включённый файл не найден или недоступен, не будут работать обновления всего фильтра.</p><p>Для локальных собственных фильтров ограничение на тот же источник не распространяется.</p><p><strong>Примеры</strong></p><p>URL фильтра: <code>https://example.org/path/filter.txt</code></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! Корректный (тот же источник):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#include https://example.org/path/includedfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! Корректный (относительный путь):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#include /includedfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#include ../path2/includedfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! Некорректный (другой источник):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#include https://domain.com/path/includedfile.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="conditions-directive">Условия<a class="hash-link" href="#conditions-directive" title="Прямая ссылка на заголовок">​</a></h4><p>Разработчики фильтров могут использовать условия, чтобы подставлять нужные правила, в зависимости от типа блокировщика. A conditional directive beginning with an <code>!#if</code> directive must explicitly be terminated with an <code>!#endif</code> directive. Условия поддерживают все основные логические операторы.</p><p>Есть два возможных сценария:</p><ol><li><p>Если блокировщик рекламы встречает директиву <code>!#if</code> и не встречает директиву <code>!#else</code>, то он компилирует код между директивами <code>!#if</code> и <code>!#endif</code> только в том случае, если указанное условие истинно.</p></li><li><p>Если существует директива <code>!#else</code>, код между <code>!#if</code> и <code>!#else</code> будет скомпилирован, если условие истинно; в противном случае будет скомпилирован код между <code>!#else</code> и <code>!#endif</code>.</p></li></ol><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>Пробелы имеют значение. <code>!#if</code> — это корректная директива, в то время как <code>!# if</code> — не корректная.</p></div></div><p><strong>Синтаксис</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!#if (conditions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rules_list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>или</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!#if (условия)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_conditions_rules_list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">false_conditions_rules_list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где:</p><ul><li><code>!#if (условия)</code> — начало блока при выполнении условий</li><li><code>conditions</code> — точно так же, как и в случае с некоторыми популярными языками программирования, условия препроцессинга основаны на константах, объявляемых блокировщиками. Разработчики блокировщиков самостоятельно определяют, какие именно константы объявлять. Возможные значения:<ul><li><code>adguard</code> объявляется всегда; даёт разработчикам фильтров понять, что это один из продуктов AdGuard; должно быть достаточно в 95% случаев</li><li>специфичные для конкретных продуктов константы, которые нужны в редких случаях, когда правило должно работать (или не работать — тогда перед константой используйте <code>!</code>) только для конкретного продукта:<ul><li><code>adguard_app_windows</code> — AdGuard для Windows</li><li><code>adguard_app_mac</code> — AdGuard для Mac</li><li><code>adguard_app_android</code> — AdGuard для Android</li><li><code>adguard_app_ios</code> — AdGuard для iOS</li><li><code>adguard_ext_safari</code> — AdGuard для Safari</li><li><code>adguard_ext_chromium</code> — Браузерное расширение AdGuard для Chrome (и браузеры на основе Chrome, например, новый Microsoft Edge)</li><li><code>adguard_ext_firefox</code> — Браузерное расширение AdGuard для Firefox</li><li><code>adguard_ext_edge</code> — Браузерное расширение AdGuard для Edge Legacy</li><li><code>adguard_ext_opera</code> — Браузерное расширение AdGuard для Opera</li><li><code>adguard_ext_android_cb</code> — AdGuard Content Blocker для мобильных браузеров Samsung и Яндекс</li><li><code>ext_ublock</code> — особый случай; эта константа объявляется, когда версия фильтра для uBlock компилируется при помощи <a href="https://github.com/AdguardTeam/FiltersRegistry" target="_blank" rel="noopener noreferrer">FiltersRegistry</a></li><li><code>cap_html_filtering</code> — продукты, поддерживающие правила HTML-фильтрации: AdGuard для Windows, AdGuard для Mac и AdGuard для Android</li></ul></li></ul></li><li><code>!#else</code> — начало блока, когда условия ложны</li><li><code>rules_list</code>, <code>true_conditions_rules_list</code>, <code>false_conditions_rules_list</code> — списки правил</li><li><code>!#endif</code> — конец блока</li></ul><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! для всех продуктов AdGuard, кроме AdGuard для Safari</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#if (adguard &amp;&amp; !adguard_ext_safari)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$third-party</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain.com##div.ad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! директивы также можно совмещать</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#if (adguard_app_android)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#include /androidspecific.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!#if (adguard &amp;&amp; !adguard_ext_safari)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! для всех продуктов AdGuard, кроме AdGuard для Safari</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$third-party</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain.com##div.ad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! только для AdGuard для Safari</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||subdomain.example.org^$third-party</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Совместимость</div><div class="admonitionContent_S0QG"><p>Директива <code>!#else</code> поддерживается <a href="https://github.com/AdguardTeam/FiltersDownloader" target="_blank" rel="noopener noreferrer">FiltersDownloader</a> 1.1.20 или более поздней версии.</p><p>Он уже поддерживается для списков фильтров, составленных с помощью <a href="https://github.com/AdguardTeam/FiltersRegistry" target="_blank" rel="noopener noreferrer">FiltersRegistry</a>, но всё ещё может не поддерживаться продуктами AdGuard при добавлении списка фильтров с <code>!#else</code> в качестве пользовательского. Следующие продукты будут поддерживать его в указанных версиях или более поздних версиях:</p><ul><li>AdGuard для Windows, Mac и Android под управлением CoreLibs 1.13;</li><li>Браузерное расширение AdGuard 4.2.208;</li><li>AdGuard v1.11.16 for Safari.</li></ul></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="safari-affinity-directive">Правила фильтрации в Safari<a class="hash-link" href="#safari-affinity-directive" title="Прямая ссылка на заголовок">​</a></h4><p>Лимит каждого блокировщика контента Safari — 150 000 активных правил. Но в AdGuard для Safari и AdGuard для iOS мы разделили правила на 6 блокировщиков контента, тем самым увеличив лимит правил до 900 000.</p><p>Какие фильтры содержатся в каждом блокировщике контента:</p><ul><li>AdGuard General — Блокировка рекламы, Языковые</li><li>AdGuard Privacy — Антитрекинг</li><li>AdGuard Social — Виджеты социальных сетей, Раздражители</li><li>AdGuard Security — Безопасность</li><li>AdGuard Other — Другие</li><li>AdGuard Custom — Собственные</li></ul><p>Пользовательские правила и белый список добавляются в каждый блокировщик контента.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>осторожно</div><div class="admonitionContent_S0QG"><p>Основной недостаток использования нескольких блокировщиков контента в том, что правила из разных блокировщиков применяются независимо друг от друга. На правила блокировки это не влияет, но с правилами разблокировки могут быть проблемы. Если правило блокировки есть в одном блокировщике контента, а исключение — в другом, то исключение не сработает. Разработчики фильтров используют <code>!#safari_cb_affinity</code>, чтобы указать, к какому блокировщику контента принадлежат правила.</p></div></div><p><strong>Синтаксис</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity(content_blockers)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rules_list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где:</p><ul><li><code>!#safari_cb_affinity(content_blockers)</code> — начало блока</li><li><code>content_blockers</code> — список блокировщиков контента, разделённых запятой. Возможные значения:<ul><li><code>general</code> — блокировщик контента AdGuard General</li><li><code>privacy</code> — блокировщик контента AdGuard Privacy</li><li><code>social</code> — блокировщик контента AdGuard Social</li><li><code>security</code> — блокировщик контента AdGuard Security</li><li><code>other</code> — блокировщик контента AdGuard Other</li><li><code>custom</code> — блокировщик контента AdGuard Custom</li><li><code>all</code> — специальное ключевое слово, которое означает, что правила должны быть включены во <strong>все</strong> блокировщики контента</li></ul></li><li><code>rules_list</code> — список правил</li><li><code>!#safari_cb_affinity</code> — конец блока</li></ul><p><strong>Примеры</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! чтобы не скрывать указанный элемент, который скрывается Базовым фильтром:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity(general)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.org#@#.adBanner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! to allowlist basic rule from AdGuard Tracking Protection filter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity(privacy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!#safari_cb_affinity</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="подсказки">Подсказки<a class="hash-link" href="#подсказки" title="Прямая ссылка на заголовок">​</a></h3><p>Hint (подсказка) — это специальный комментарий, инструкция к компилятору фильтров, используемому на стороне сервера (см. <a href="https://github.com/AdguardTeam/FiltersRegistry" target="_blank" rel="noopener noreferrer">FiltersRegistry</a>).</p><p><strong>Синтаксис</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!+ HINT_NAME1(PARAMS) HINT_NAME2(PARAMS)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Можно применить несколько подсказок.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="подсказка-not_optimized">Подсказка <code>NOT_OPTIMIZED</code><a class="hash-link" href="#подсказка-not_optimized" title="Прямая ссылка на заголовок">​</a></h4><p>Для каждого фильтра AdGuard существуют две версии: полная и оптимизированная. Оптимизированная версия намного легче и не содержит правил, которые не используются вообще или используются редко.</p><p>Частота использования правил определяется собранной <a href="/KnowledgeBase/ru/general/ad-filtering/tracking-filter-statistics/">статистикой по рекламным фильтрам</a>. Но оптимизация основана также на исходной конфигурации для каждого фильтра. Например, вот так это выглядит для Базового фильтра:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;filter&quot;: Базовый фильтр AdGuard,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;percent&quot;: 30,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;minPercent&quot;: 20,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;maxPercent&quot;: 40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;strict&quot;: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>где:</p><ul><li><strong>filter</strong> — идентификатор фильтра</li><li><strong>percent</strong> — ожидаемый процент оптимизации <code>~= (количество правил в оптимизированном фильтре) / (количество правил в исходном фильтре) * 100</code></li><li><strong>minPercent</strong> — нижняя граница значения <code>percent</code></li><li><strong>maxPercent</strong> — верхняя граница значения <code>percent</code></li><li><strong>Strict</strong> — если <code>percent &lt; minPercent</code> или <code>percent &gt; maxPercent</code> и включён режим Strict, то компиляция фильтра должна завершиться неудачно, в противном случае должны использоваться оригинальные правила</li></ul><p>Другими словами, <code>percent</code> — это «уровень сжатия». Например, для Базового фильтра он настроен на 40%. Это означает, что алгоритм оптимизации должен убрать 60% правил.</p><p>В итоге, вот так выглядят версии Базового фильтра для Браузерного расширения AdGuard для Chrome:</p><ul><li>полная: <a href="https://filters.adtidy.org/extension/chromium/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/chromium/filters/2.txt</a></li><li>оптимизированная: <a href="https://filters.adtidy.org/extension/chromium/filters/2_optimized.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/chromium/filters/2_optimized.txt</a></li></ul><p><strong>Если вы хотите добавить правило, которое не должно удаляться при оптимизации, используйте подсказку <code>NOT_OPTIMIZED</code>:</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!+ NOT_OPTIMIZED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>А такое правило не будет оптимизировано только для AdGuard для Android:</strong></p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!+ NOT_OPTIMIZED PLATFORM(android)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="подсказки-platform-и-not_platform">Подсказки <code>PLATFORM</code> и <code>NOT_PLATFORM</code><a class="hash-link" href="#подсказки-platform-и-not_platform" title="Прямая ссылка на заголовок">​</a></h4><p>Записи этого типа позволяют указывать платформу, для которой применяется правило. Ниже представлен список используемых платформ и ссылки на Базовый фильтр для каждой из них:</p><ul><li><p><code>windows</code> — AdGuard для Windows — <a href="https://filters.adtidy.org/windows/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/windows/filters/2.txt</a></p></li><li><p><code>mac</code> — AdGuard для Mac — <a href="https://filters.adtidy.org/mac_v2/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/mac_v2/filters/2.txt</a></p></li><li><p><code>android</code> — AdGuard для Android — <a href="https://filters.adtidy.org/android/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/android/filters/2.txt</a></p></li><li><p><code>ios</code> — AdGuard для iOS — <a href="https://filters.adtidy.org/ios/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/ios/filters/2.txt</a></p></li><li><p><code>ext_chromium</code> — Браузерное расширение AdGuard для Chrome — <a href="https://filters.adtidy.org/extension/chromium/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/chromium/filters/2.txt</a></p></li><li><p><code>ext_ff</code> — Браузерное расширение AdGuard для Firefox — <a href="https://filters.adtidy.org/extension/firefox/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/firefox/filters/2.txt</a></p></li><li><p><code>ext_edge</code> — Браузерное расширение AdGuard для Edge — <a href="https://filters.adtidy.org/extension/edge/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/edge/filters/2.txt</a></p></li><li><p><code>ext_opera</code> — Браузерное расширение AdGuard для Opera — <a href="https://filters.adtidy.org/extension/opera/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/opera/filters/2.txt</a></p></li><li><p><code>ext_safari</code> — AdGuard для Safari — <a href="https://filters.adtidy.org/extension/safari/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/safari/filters/2.txt</a></p></li><li><p><code>ext_android_cb</code> — AdGuard Content Blocker — <a href="https://filters.adtidy.org/extension/android-content-blocker/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/android-content-blocker/filters/2.txt</a></p></li><li><p><code>ext_ublock</code> — uBlock Origin — <a href="https://filters.adtidy.org/extension/ublock/filters/2.txt" target="_blank" rel="noopener noreferrer">https://filters.adtidy.org/extension/ublock/filters/2.txt</a></p></li></ul><p><strong>Примеры</strong></p><p>Это правило будет действовать только в AdGuard для Windows, Mac и Android:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!+ PLATFORM(windows,mac,android)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Except for AdGuard for Safari, AdGuard Content Blocker, and AdGuard for iOS, this rule is available on all platforms:</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!+ NOT_PLATFORM(ext_safari, ext_android_cb, ios)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="отладка-правил-фильтрации">Отладка правил фильтрации<a class="hash-link" href="#отладка-правил-фильтрации" title="Прямая ссылка на заголовок">​</a></h2><p>Хоть самые простые правила фильтрации и возможно придумать «в голове», для чего-то чуть более сложного вам потребуются дополнительная помощь в их отладке и повторении. Есть инструменты, которые помогут вам в этом. Вы можете использовать «Инструменты разработчика» в Chrome и их аналоги в других браузерах, но большинство продуктов AdGuard предоставляют и другой инструмент — Журнал фильтрации.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="журнал-фильтрации">Журнал фильтрации<a class="hash-link" href="#журнал-фильтрации" title="Прямая ссылка на заголовок">​</a></h3><p>Журнал фильтрации — продвинутый инструмент, который полезен в основном разработчикам фильтров. В нём отображаются все веб-запросы, проходящие через AdGuard, даётся исчерпывающая информация по каждому из них, предлагаются различные опции сортировки и другие полезные возможности.</p><p>В зависимости от того, какой продукт AdGuard вы используете, журнал фильтрации может находиться в разных местах.</p><ul><li>В <strong>AdGuard для Windows</strong> вы найдёте его во вкладке настроек <em>Антибаннер</em> или через меню трея</li><li>В <strong>AdGuard для Mac</strong> он располагается в разделе <em>Настройки → Дополнительно → Журнал фильтрации</em></li><li>В <strong>AdGuard для Android</strong> его можно найти в разделе <em>Статистика → Недавняя активность</em>. <em>Доступ к недавней активности</em> также можно получить из <em>Помощника</em></li><li>В <strong>Браузерном расширении AdGuard</strong> он находится во вкладке настроек <em>Дополнительно</em>, а также доступен по клику правой кнопкой мыши по иконке расширения. Only Chromium- and Firefox-based web browsers show applied <strong>element hiding rules</strong> (including CSS, ExtCSS) and <strong>JS rules and scriptlets</strong> in their Filtering logs</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><p>В <strong>AdGuard для iOS</strong> и в <strong>AdGuard для Safari</strong> Журнал фильтрации отсутствует из-за особенностей реализации блокировщиков контента в Safari. AdGuard сам не видит веб-запросы и поэтому не может отображать их.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="selectors-debug-mode">Режим отладки селекторов<a class="hash-link" href="#selectors-debug-mode" title="Прямая ссылка на заголовок">​</a></h3><p>Иногда может понадобиться проверить производительность того или иного селектора или таблицы стилей. Чтобы сделать это без непосредственного взаимодействия с JavaScript, вы можете использовать свойство стиля <code>debug</code>. Когда <code>ExtendedCss</code> встречает это свойство, он включает режим отладки для конкретного селектора или для всех селекторов, в зависимости от значения <code>debug</code>.</p><p>Откройте консоль браузера, находясь на веб-странице, чтобы посмотреть статистику по времени, затраченному на применение селектора(-ов). В режиме отладки следующая статистика отображается в виде объекта, где каждый из отлаживаемых селекторов является ключом, а значение — объектом с такими свойствами:</p><p><strong>Всегда выводится:</strong></p><ul><li><code>selectorParsed</code> — окончательный текст селектора после парсинга</li><li><code>timings</code> — список узлов DOM, соответствующих селектору<ul><li><code>appliesCount</code> — общее количество раз, когда на странице был применён селектор</li><li><code>appliesTimings</code> — время, которое ушло на применение селектора на странице, для каждого из случаев применения этого селектора (в миллисекундах)</li><li><code>meanTiming</code> — среднее время, ушедшее на применение селектора на странице</li><li><code>standardDeviation</code> — стандартное отклонение</li><li><code>timingsSum</code> — общее время, ушедшее на все применения селектора на текущей странице</li></ul></li></ul><p><strong>Выводится только для удалённых псевдоэлементов:</strong></p><ul><li><code>removed</code> — flag to signal if elements were removed</li></ul><p><strong>Выводится, если элементы не удалены:</strong></p><ul><li><code>matchedElements</code> — список узлов DOM, соответствующих селектору</li><li><code>styleApplied</code> — объявление обработанного стиля правила, связанного с селектором</li></ul><p><strong>Примеры</strong></p><p><strong>Отладка конкретного селектора:</strong></p><p>Когда значение свойства <code>debug</code> равно <code>true</code>, информация только по этому селектору будет отображена в консоли браузера.</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#$?#.banner { display: none; debug: true; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Включение глобальной отладки:</strong></p><p>Когда значение свойства <code>debug</code> равно <code>global</code>, в консоли будет отображаться информация по всем CSS-селекторам, которые были применены на данной странице, для всех правил из любого из включённых фильтров.</p><div class="language-adblock codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-adblock codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#$?#.banner { display: none; debug: global; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Тестирование расширенных селекторов без AdGuard</strong></p><p>ExtendedCss может быть выполнен на любой странице без использования какого-либо продукта AdGuard. Для этого скопируйте и запустите следующий код в консоли браузера:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">!</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">t</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token constant" style="color:#36acaa">C</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onload</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ExtendedCss loaded successfully&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">s</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementsByTagName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">s</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parentNode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">insertBefore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">h</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementsByTagName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;head&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">appendChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;script&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;https://AdguardTeam.github.io/ExtendedCss/extended-css.min.js&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В качестве альтернативы установите <a href="https://github.com/AdguardTeam/Userscripts/blob/master/extendedCssDebugger/extended-css.debugger.user.js" target="_blank" rel="noopener noreferrer">пользовательский скрипт ExtendedCssDebugger</a>.</p><p>Теперь вы можете использовать <code>ExtendedCss</code> глобально и запустить его метод <a href="https://github.com/AdguardTeam/ExtendedCss#extended-css-query" target="_blank" rel="noopener noreferrer"><code>query()</code></a> как <code>Document.querySelectorAll()</code>.</p><p><strong>Примеры</strong></p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> selector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;div.block:has=(.header:matches-css(after, content: Ads))&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// массив HTMLElements, соответствующих `selector`, должен быть возвращён</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">ExtendedCss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">selector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать код" title="Копировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="debug-scriptlets">Отладка скриптлетов<a class="hash-link" href="#debug-scriptlets" title="Прямая ссылка на заголовок">​</a></h3><p>Если вы используете браузерное расширение AdGuard и хотите отладить правило <a href="#scriptlets">скриптлета</a> или <a href="#trusted-scriptlets">доверенного скриптлета</a>, то можете получить дополнительную информацию, открыв журнал фильтрации. В этом случае скриптлеты перейдут в режим отладки и будут записывать больше информации в браузерную консоль.</p><p>Следующие скриптлеты разработаны специально для отладки:</p><ul><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#debug-current-inline-script" target="_blank" rel="noopener noreferrer"><code>debug-current-inline-script</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#debug-on-property-read" target="_blank" rel="noopener noreferrer"><code>debug-on-property-read</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#abort-on-property-write" target="_blank" rel="noopener noreferrer"><code>debug-on-property-write</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-addEventListener" target="_blank" rel="noopener noreferrer"><code>log-addEventListener</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-on-stack-trace" target="_blank" rel="noopener noreferrer"><code>log-on-stack-trace</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-eval" target="_blank" rel="noopener noreferrer"><code>log-eval</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log" target="_blank" rel="noopener noreferrer"><code>log</code></a></li></ul><p>Следующие скриптлеты тоже могут быть использованы для отладки:</p><ul><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#json-prune" target="_blank" rel="noopener noreferrer"><code>json-prune</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-fetch" target="_blank" rel="noopener noreferrer"><code>prevent-fetch</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-requestanimationframe" target="_blank" rel="noopener noreferrer"><code>prevent-requestAnimationFrame</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-setinterval" target="_blank" rel="noopener noreferrer"><code>prevent-setInterval</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-settimeout" target="_blank" rel="noopener noreferrer"><code>prevent-setTimeout</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-window-open" target="_blank" rel="noopener noreferrer"><code>prevent-window-open</code></a> со специальным параметром <code>replacement</code></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-xhr" target="_blank" rel="noopener noreferrer"><code>prevent-xhr</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-trusted-scriptlets.md#trusted-replace-fetch-response" target="_blank" rel="noopener noreferrer"><code>trusted-replace-fetch-response</code></a></li><li><a href="https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-trusted-scriptlets.md#trusted-replace-xhr-response" target="_blank" rel="noopener noreferrer"><code>trusted-replace-xhr-response</code></a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="compatibility-tables-legend">Легенда таблиц совместимости<a class="hash-link" href="#compatibility-tables-legend" title="Прямая ссылка на заголовок">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-product">Краткие обозначения продуктов<a class="hash-link" href="#what-product" title="Прямая ссылка на заголовок">​</a></h3><ol><li><code>Приложения CoreLibs</code> — AdGuard для Windows, AdGuard для Mac и AdGuard для Android</li><li><code>AdGuard для Chromium</code> — Браузерное расширение AdGuard для Chrome и других браузеров на основе Chromium, таких как Microsoft Edge и Opera</li><li><code>AdGuard для Firefox</code> — Браузерное расширение AdGuard для Firefox</li><li><code>AdGuard для iOS</code> — AdGuard для iOS и AdGuard Pro для iOS (для мобильного браузера Safari)</li><li><code>AdGuard для Safari</code> — AdGuard для веб-браузера Safari <code>AdGuard Content Blocker</code> — Content Blocker для мобильных браузеров Android: Samsung Internet и Яндекс Браузер</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-compatibility">Краткие обозначения совместимости<a class="hash-link" href="#what-compatibility" title="Прямая ссылка на заголовок">​</a></h3><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>комментарий</div><div class="admonitionContent_S0QG"><ul><li>✅ — полностью поддерживается</li><li>✅ * — поддерживается, но надёжность может быть разной или могут возникнуть ограничения; ознакомьтесь с описанием модификатора для получения подробной информации</li><li>🧩 — может быть уже реализован в nightly или бета-версиях, но пока не поддерживается в релизных версиях</li><li>⏳ — реализован или планируется к реализации, но пока недоступен ни в одном продукте</li><li>❌ — не поддерживается</li><li>👎 — устарел; всё ещё поддерживается, но в будущем будет удалён</li><li>🚫 — удалён и больше не поддерживается</li></ul></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/AdguardTeam/KnowledgeBase/edit/master/docs/general/ad-filtering/create-own-filters.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Редактировать страницу</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Навигация по страницам документов"><a class="pagination-nav__link pagination-nav__link--prev" href="/KnowledgeBase/ru/general/ad-filtering/tracking-filter-statistics/"><div class="pagination-nav__sublabel">Назад</div><div class="pagination-nav__label">Сбор статистики по рекламным фильтрам</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/KnowledgeBase/ru/general/ad-filtering/filter-policy/"><div class="pagination-nav__sublabel">Вперёд</div><div class="pagination-nav__label">Политика фильтров AdGuard</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#комментарии" class="table-of-contents__link toc-highlight">Комментарии</a></li><li><a href="#примеры" class="table-of-contents__link toc-highlight">Примеры</a><ul><li><a href="#блокировка-по-имени-домена" class="table-of-contents__link toc-highlight">Блокировка по имени домена</a></li><li><a href="#блокировка-конкретного-адреса" class="table-of-contents__link toc-highlight">Блокировка конкретного адреса</a></li><li><a href="#basic-rule-modifiers" class="table-of-contents__link toc-highlight">Модификаторы базовых правил</a></li><li><a href="#разблокировка-адреса" class="table-of-contents__link toc-highlight">Разблокировка адреса</a></li><li><a href="#разблокировка-всего-сайта" class="table-of-contents__link toc-highlight">Разблокировка всего сайта</a></li><li><a href="#косметические-правила" class="table-of-contents__link toc-highlight">Косметические правила</a></li></ul></li><li><a href="#ограничения-и-запреты" class="table-of-contents__link toc-highlight">Ограничения и запреты</a><ul><li><a href="#trusted-filters" class="table-of-contents__link toc-highlight">Доверенные фильтры</a></li><li><a href="#adguard-content-blocker" class="table-of-contents__link toc-highlight">AdGuard Content Blocker</a></li></ul></li><li><a href="#базовые-правила" class="table-of-contents__link toc-highlight">Базовые правила</a><ul><li><a href="#basic-rules-syntax" class="table-of-contents__link toc-highlight">Синтаксис базовых правил</a></li><li><a href="#basic-rules-special-characters" class="table-of-contents__link toc-highlight">Специальные символы</a></li><li><a href="#regexp-support" class="table-of-contents__link toc-highlight">Поддержка регулярных выражений</a></li><li><a href="#wildcard-for-tld" class="table-of-contents__link toc-highlight">Поддержка wildcard для доменов верхнего уровня (TLD)</a></li><li><a href="#примеры-базовых-правил" class="table-of-contents__link toc-highlight">Примеры базовых правил</a></li><li><a href="#модификаторы-базовых-правил" class="table-of-contents__link toc-highlight">Модификаторы базовых правил</a></li><li><a href="#basic-rules-basic-modifiers" class="table-of-contents__link toc-highlight">Базовые модификаторы</a><ul><li><a href="#app-modifier" class="table-of-contents__link toc-highlight"><strong><code>$app</code></strong></a></li><li><a href="#denyallow-modifier" class="table-of-contents__link toc-highlight"><strong><code>$denyallow</code></strong></a></li><li><a href="#domain-modifier" class="table-of-contents__link toc-highlight"><strong><code>$domain</code></strong></a></li><li><a href="#header-modifier" class="table-of-contents__link toc-highlight"><strong><code>$header</code></strong></a></li><li><a href="#important-modifier" class="table-of-contents__link toc-highlight"><strong><code>$important</code></strong></a></li><li><a href="#match-case-modifier" class="table-of-contents__link toc-highlight"><strong><code>$match-case</code></strong></a></li><li><a href="#method-modifier" class="table-of-contents__link toc-highlight"><strong><code>$method</code></strong></a></li><li><a href="#popup-modifier" class="table-of-contents__link toc-highlight"><strong><code>$popup</code></strong></a></li><li><a href="#third-party-modifier" class="table-of-contents__link toc-highlight"><strong><code>$third-party</code></strong></a></li><li><a href="#to-modifier" class="table-of-contents__link toc-highlight"><strong><code>$to</code></strong></a></li></ul></li><li><a href="#content-type-modifiers" class="table-of-contents__link toc-highlight">Модификаторы типа контента</a><ul><li><a href="#document-modifier" class="table-of-contents__link toc-highlight"><strong><code>$document</code></strong></a></li><li><a href="#font-modifier" class="table-of-contents__link toc-highlight"><strong><code>$font</code></strong></a></li><li><a href="#image-modifier" class="table-of-contents__link toc-highlight"><strong><code>$image</code></strong></a></li><li><a href="#media-modifier" class="table-of-contents__link toc-highlight"><strong><code>$media</code></strong></a></li><li><a href="#object-modifier" class="table-of-contents__link toc-highlight"><strong><code>$object</code></strong></a></li><li><a href="#other-modifier" class="table-of-contents__link toc-highlight"><strong><code>$other</code></strong></a></li><li><a href="#ping-modifier" class="table-of-contents__link toc-highlight"><strong><code>$ping</code></strong></a></li><li><a href="#script-modifier" class="table-of-contents__link toc-highlight"><strong><code>$script</code></strong></a></li><li><a href="#stylesheet-modifier" class="table-of-contents__link toc-highlight"><strong><code>$stylesheet</code></strong></a></li><li><a href="#subdocument-modifier" class="table-of-contents__link toc-highlight"><strong><code>$subdocument</code></strong></a></li><li><a href="#websocket-modifier" class="table-of-contents__link toc-highlight"><strong><code>$websocket</code></strong></a></li><li><a href="#xmlhttprequest-modifier" class="table-of-contents__link toc-highlight"><strong><code>$xmlhttprequest</code></strong></a></li><li><a href="#object-subrequest-modifier" class="table-of-contents__link toc-highlight"><strong><code>$object-subrequest</code> (удалён)</strong></a></li><li><a href="#webrtc-modifier" class="table-of-contents__link toc-highlight"><strong><code>$webrtc</code> (удалён)</strong></a></li></ul></li><li><a href="#exception-modifiers" class="table-of-contents__link toc-highlight">Модификаторы правил исключений</a><ul><li><a href="#content-modifier" class="table-of-contents__link toc-highlight"><strong><code>$content</code></strong></a></li><li><a href="#elemhide-modifier" class="table-of-contents__link toc-highlight"><strong><code>$elemhide</code></strong></a></li><li><a href="#extension-modifier" class="table-of-contents__link toc-highlight"><strong><code>$extension</code></strong></a></li><li><a href="#jsinject-modifier" class="table-of-contents__link toc-highlight"><strong><code>$jsinject</code></strong></a></li><li><a href="#stealth-modifier" class="table-of-contents__link toc-highlight"><strong><code>$stealth</code></strong></a></li><li><a href="#urlblock-modifier" class="table-of-contents__link toc-highlight"><strong><code>$urlblock</code></strong></a></li><li><a href="#exception-modifiers-generic-rules" class="table-of-contents__link toc-highlight">Generic-правила</a></li><li><a href="#genericblock-modifier" class="table-of-contents__link toc-highlight"><strong><code>$genericblock</code></strong></a></li><li><a href="#generichide-modifier" class="table-of-contents__link toc-highlight"><strong><code>$generichide</code></strong></a></li><li><a href="#specifichide-modifier" class="table-of-contents__link toc-highlight"><strong><code>specifichide</code></strong></a></li></ul></li><li><a href="#advanced-modifiers" class="table-of-contents__link toc-highlight">Расширенные возможности</a><ul><li><a href="#all-modifier" class="table-of-contents__link toc-highlight"><strong><code>$all</code></strong></a></li><li><a href="#badfilter-modifier" class="table-of-contents__link toc-highlight"><strong><code>$badfilter</code></strong></a></li><li><a href="#cookie-modifier" class="table-of-contents__link toc-highlight"><strong><code>$cookie</code></strong></a></li><li><a href="#csp-modifier" class="table-of-contents__link toc-highlight"><strong><code>$csp</code></strong></a></li><li><a href="#hls-modifier" class="table-of-contents__link toc-highlight"><strong><code>$hls</code></strong></a></li><li><a href="#inline-script-modifier" class="table-of-contents__link toc-highlight"><strong><code>$inline-script</code></strong></a></li><li><a href="#inline-font-modifier" class="table-of-contents__link toc-highlight"><strong><code>$inline-font</code></strong></a></li><li><a href="#jsonprune-modifier" class="table-of-contents__link toc-highlight"><strong><code>$jsonprune</code></strong></a></li><li><a href="#network-modifier" class="table-of-contents__link toc-highlight"><strong><code>$network</code></strong></a></li><li><a href="#permissions-modifier" class="table-of-contents__link toc-highlight"><strong><code>$permissions</code></strong></a></li><li><a href="#redirect-modifier" class="table-of-contents__link toc-highlight"><strong><code>$redirect</code></strong></a></li><li><a href="#redirect-rule-modifier" class="table-of-contents__link toc-highlight"><strong><code>$redirect-rule</code></strong></a></li><li><a href="#referrerpolicy-modifier" class="table-of-contents__link toc-highlight"><strong><code>$referrerpolicy</code></strong></a></li><li><a href="#removeheader-modifier" class="table-of-contents__link toc-highlight"><strong><code>$removeheader</code></strong></a></li><li><a href="#removeparam-modifier" class="table-of-contents__link toc-highlight"><strong><code>$removeparam</code></strong></a></li><li><a href="#replace-modifier" class="table-of-contents__link toc-highlight"><strong><code>$replace</code></strong></a></li><li><a href="#noop-modifier" class="table-of-contents__link toc-highlight"><strong><code>noop</code></strong></a></li><li><a href="#empty-modifier" class="table-of-contents__link toc-highlight"><strong><code>$empty</code> (устаревший)</strong></a></li><li><a href="#mp4-modifier" class="table-of-contents__link toc-highlight"><strong><code>$mp4</code> (устаревший)</strong></a></li></ul></li><li><a href="#rule-priorities" class="table-of-contents__link toc-highlight">Приоритеты правил</a><ul><li><a href="#priority-calculation" class="table-of-contents__link toc-highlight">Priority calculation</a></li><li><a href="#priority-category-1" class="table-of-contents__link toc-highlight">Базовые модификаторы, наличие каждого добавляет 1 к приоритету</a></li><li><a href="#priority-category-2" class="table-of-contents__link toc-highlight">Определённые модификаторы content-type, методы, заголовки, $popup, специальные исключения</a></li><li><a href="#priority-category-3" class="table-of-contents__link toc-highlight"><code>$domain</code> или <code>$app</code> с разрешёнными доменами или приложениями</a></li><li><a href="#priority-category-6" class="table-of-contents__link toc-highlight">Правила <code>$redirect</code></a></li><li><a href="#priority-category-4" class="table-of-contents__link toc-highlight">Особые исключения</a></li><li><a href="#priority-category-5" class="table-of-contents__link toc-highlight">Правила белого списка</a></li><li><a href="#priority-category-7" class="table-of-contents__link toc-highlight">Правила <code>$important</code></a></li><li><a href="#priority-category-extra" class="table-of-contents__link toc-highlight">Правила, для которых нет веса приоритета</a></li><li><a href="#примеры-1" class="table-of-contents__link toc-highlight">Примеры</a></li></ul></li></ul></li><li><a href="#non-basic-rules" class="table-of-contents__link toc-highlight">Другие правила</a></li><li><a href="#cosmetic-rules" class="table-of-contents__link toc-highlight">Косметические правила</a><ul><li><a href="#cosmetic-elemhide-rules" class="table-of-contents__link toc-highlight">Правила скрытия элементов</a><ul><li><a href="#синтаксис" class="table-of-contents__link toc-highlight">Синтаксис</a></li></ul></li><li><a href="#cosmetic-css-rules" class="table-of-contents__link toc-highlight">CSS-правила</a></li><li><a href="#extended-css-selectors" class="table-of-contents__link toc-highlight">Расширенные CSS-селекторы</a><ul><li><a href="#extended-css-limitations" class="table-of-contents__link toc-highlight">Ограничения ExtendedCss</a></li><li><a href="#extended-css-has" class="table-of-contents__link toc-highlight">Псевдокласс <code>:has()</code></a></li><li><a href="#extended-css-contains" class="table-of-contents__link toc-highlight">Псевдокласс <code>:contains()</code></a></li><li><a href="#extended-css-matches-css" class="table-of-contents__link toc-highlight">Псевдокласс <code>:matches-css()</code></a></li><li><a href="#extended-css-matches-attr" class="table-of-contents__link toc-highlight">Псевдокласс <code>:matches-attr()</code></a></li><li><a href="#extended-css-property" class="table-of-contents__link toc-highlight">Псевдокласс <code>:matches-property()</code></a></li><li><a href="#extended-css-xpath" class="table-of-contents__link toc-highlight">Псевдокласс <code>:xpath()</code></a></li><li><a href="#extended-css-nth-ancestor" class="table-of-contents__link toc-highlight">Псевдокласс <code>:nth-ancestor()</code></a></li><li><a href="#extended-css-upward" class="table-of-contents__link toc-highlight">Псевдокласс <code>:upward()</code></a></li><li><a href="#remove-pseudos" class="table-of-contents__link toc-highlight">Псевдокласс <code>:remove()</code> и псевдосвойство <code>remove</code></a></li><li><a href="#extended-css-is" class="table-of-contents__link toc-highlight">Псевдокласс <code>:is()</code></a></li><li><a href="#extended-css-not" class="table-of-contents__link toc-highlight">Псевдокласс <code>:not()</code></a></li><li><a href="#extended-css-if-not" class="table-of-contents__link toc-highlight">Псевдокласс <code>:if-not()</code> (удалён)</a></li></ul></li><li><a href="#cosmetic-rules-priority" class="table-of-contents__link toc-highlight">Приоритет косметических правил</a></li></ul></li><li><a href="#html-filtering-rules" class="table-of-contents__link toc-highlight">Правила фильтрации HTML</a><ul><li><a href="#синтаксис-1" class="table-of-contents__link toc-highlight">Синтаксис</a></li><li><a href="#примеры-2" class="table-of-contents__link toc-highlight">Примеры</a></li><li><a href="#специальные-атрибуты" class="table-of-contents__link toc-highlight">Специальные атрибуты</a><ul><li><a href="#tag-content" class="table-of-contents__link toc-highlight"><code>tag-content</code></a></li><li><a href="#wildcard" class="table-of-contents__link toc-highlight"><code>wildcard</code></a></li><li><a href="#max-length" class="table-of-contents__link toc-highlight"><code>max-length</code></a></li><li><a href="#min-length" class="table-of-contents__link toc-highlight"><code>min-length</code></a></li></ul></li><li><a href="#псевдоклассы" class="table-of-contents__link toc-highlight">Псевдоклассы</a><ul><li><a href="#contains" class="table-of-contents__link toc-highlight"><code>:contains()</code></a></li></ul></li><li><a href="#исключения" class="table-of-contents__link toc-highlight">Исключения</a></li></ul></li><li><a href="#javascript-rules" class="table-of-contents__link toc-highlight">Правила JavaScript</a></li><li><a href="#scriptlets" class="table-of-contents__link toc-highlight">Правила скриптлета</a><ul><li><a href="#trusted-scriptlets" class="table-of-contents__link toc-highlight">Доверенные скриптлеты</a></li></ul></li><li><a href="#non-basic-rules-modifiers" class="table-of-contents__link toc-highlight">Модификаторы для небазовых правил</a><ul><li><a href="#non-basic-app-modifier" class="table-of-contents__link toc-highlight"><strong><code>$app</code></strong></a></li><li><a href="#non-basic-domain-modifier" class="table-of-contents__link toc-highlight"><strong><code>$domain</code></strong></a></li><li><a href="#non-basic-path-modifier" class="table-of-contents__link toc-highlight"><strong><code>$path</code></strong></a></li><li><a href="#non-basic-url-modifier" class="table-of-contents__link toc-highlight"><strong><code>$url</code></strong></a></li></ul></li><li><a href="#информация-для-разработчиков-фильтров" class="table-of-contents__link toc-highlight">Информация для разработчиков фильтров</a><ul><li><a href="#директивы-препроцессора" class="table-of-contents__link toc-highlight">Директивы препроцессора</a><ul><li><a href="#include-directive" class="table-of-contents__link toc-highlight">Включение файла</a></li><li><a href="#conditions-directive" class="table-of-contents__link toc-highlight">Условия</a></li><li><a href="#safari-affinity-directive" class="table-of-contents__link toc-highlight">Правила фильтрации в Safari</a></li></ul></li><li><a href="#подсказки" class="table-of-contents__link toc-highlight">Подсказки</a><ul><li><a href="#подсказка-not_optimized" class="table-of-contents__link toc-highlight">Подсказка <code>NOT_OPTIMIZED</code></a></li><li><a href="#подсказки-platform-и-not_platform" class="table-of-contents__link toc-highlight">Подсказки <code>PLATFORM</code> и <code>NOT_PLATFORM</code></a></li></ul></li></ul></li><li><a href="#отладка-правил-фильтрации" class="table-of-contents__link toc-highlight">Отладка правил фильтрации</a><ul><li><a href="#журнал-фильтрации" class="table-of-contents__link toc-highlight">Журнал фильтрации</a></li><li><a href="#selectors-debug-mode" class="table-of-contents__link toc-highlight">Режим отладки селекторов</a></li><li><a href="#debug-scriptlets" class="table-of-contents__link toc-highlight">Отладка скриптлетов</a></li></ul></li><li><a href="#compatibility-tables-legend" class="table-of-contents__link toc-highlight">Легенда таблиц совместимости</a><ul><li><a href="#what-product" class="table-of-contents__link toc-highlight">Краткие обозначения продуктов</a></li><li><a href="#what-compatibility" class="table-of-contents__link toc-highlight">Краткие обозначения совместимости</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">AdGuard</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://adguard.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Официальный сайт<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/contacts.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">О компании<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/press-releases.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">В СМИ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/media-materials.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Медиа-материалы<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/awards.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Награды<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Продукты</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://adguard.com/adguard-windows/overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">AdGuard для Windows<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/adguard-android/overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">AdGuard для Android<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/adguard-mac/overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">AdGuard для Mac<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/adguard-ios/overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">AdGuard для iOS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/adguard-ios-pro/overview.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">AdGuard для iOS Pro<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Поддержка</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://adguard.com/support.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Техподдержка<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/KnowledgeBase/ru/general/ad-filtering/create-own-filters/">Как составлять свои фильтры</a></li><li class="footer__item"><a class="footer__link-item" href="/KnowledgeBase/ru/general/ad-filtering/adguard-filters/">Рекламные фильтры AdGuard</a></li><li class="footer__item"><a href="https://adguard.com/removal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Инструкции по удалению<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/KnowledgeBase/ru/general/userscripts/">Пользовательские скрипты</a></li></ul></div><div class="col footer__col"><div class="footer__title">Лицензия</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://adguard.com/license.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Купить лицензию<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/KnowledgeBase/ru/general/license/what-is/">Восстановить лицензию</a></li><li class="footer__item"><a href="https://adguard.com/terms-of-sale.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Условия продажи<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/get-adguard-for-free.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Бесплатная версия<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://adguard.com/contribute.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Станьте частью команды AdGuard<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/KnowledgeBase/ru/img/logo_dark.svg" alt="AdGuard" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/KnowledgeBase/ru/img/logo_dark.svg" alt="AdGuard" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">© AdGuard, 2009–2023</div></div></div></footer></div>
<script src="/KnowledgeBase/ru/assets/js/runtime~main.34dd83d1.js"></script>
<script src="/KnowledgeBase/ru/assets/js/main.8fe70d4f.js"></script>
</body>
</html>